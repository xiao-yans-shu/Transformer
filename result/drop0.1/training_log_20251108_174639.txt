
============================================================
训练开始时间: 2025-11-08 17:46:39
============================================================

==================================================
运行名称: 20251108_174639
加载数据...
加载训练数据...
训练数据量: 206112，限制为: 200000
训练集大小: 200000
构建词汇表...
源语言词汇表大小: 20000
目标语言词汇表大小: 20000
加载验证数据...
验证集大小: 888
==================================================
创建模型...
模型参数统计:
  可训练参数: 74,880,544
  总参数: 74,880,544
  模型大小: 286.43 MB
==================================================
开始训练...

==================================================
Epoch 1/50
==================================================

Step 0: Loss=9.9397, PPL=20736.99, LR=6.18e-08

Step 100: Loss=9.3168, PPL=11123.13, LR=6.24e-06

Step 200: Loss=8.7162, PPL=6100.74, LR=1.24e-05

Step 300: Loss=7.9000, PPL=2697.40, LR=1.86e-05

Step 400: Loss=7.0657, PPL=1171.10, LR=2.48e-05

Step 500: Loss=6.6409, PPL=765.75, LR=3.09e-05

Step 600: Loss=6.2359, PPL=510.77, LR=3.71e-05

Step 700: Loss=6.1739, PPL=480.06, LR=4.33e-05

Step 800: Loss=6.0783, PPL=436.27, LR=4.95e-05

Step 900: Loss=6.0278, PPL=414.82, LR=5.56e-05

Step 1000: Loss=5.9021, PPL=365.79, LR=6.18e-05

Step 1100: Loss=5.7978, PPL=329.57, LR=6.80e-05

Step 1200: Loss=5.7352, PPL=309.57, LR=7.42e-05

Step 1300: Loss=5.6022, PPL=271.03, LR=8.04e-05

Step 1400: Loss=5.5196, PPL=249.54, LR=8.65e-05

Step 1500: Loss=5.3830, PPL=217.68, LR=9.27e-05

Step 1600: Loss=5.3518, PPL=210.98, LR=9.89e-05

Step 1700: Loss=5.2005, PPL=181.36, LR=1.05e-04

Step 1800: Loss=5.3788, PPL=216.77, LR=1.11e-04

Step 1900: Loss=5.1873, PPL=178.98, LR=1.17e-04

Step 2000: Loss=4.9877, PPL=146.60, LR=1.24e-04

Step 2100: Loss=5.0960, PPL=163.36, LR=1.30e-04

Step 2200: Loss=4.9777, PPL=145.14, LR=1.36e-04

Step 2300: Loss=4.8377, PPL=126.17, LR=1.42e-04

Step 2400: Loss=4.8872, PPL=132.59, LR=1.48e-04

Step 2500: Loss=4.7148, PPL=111.59, LR=1.54e-04

Step 2600: Loss=4.5416, PPL=93.84, LR=1.61e-04

Step 2700: Loss=4.5596, PPL=95.54, LR=1.67e-04

Step 2800: Loss=4.5334, PPL=93.07, LR=1.73e-04

Step 2900: Loss=4.4763, PPL=87.91, LR=1.79e-04

Step 3000: Loss=4.4817, PPL=88.39, LR=1.85e-04

Step 3100: Loss=4.2280, PPL=68.58, LR=1.92e-04

Epoch 1 结果:
  训练损失: 5.7385, 困惑度: 310.58
  验证损失: 4.2571, 困惑度: 70.61
检查点已保存: runs/20251108_174639/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 4.2571)

==================================================
Epoch 2/50
==================================================

Step 0: Loss=4.3757, PPL=79.50, LR=1.93e-04

Step 100: Loss=4.1660, PPL=64.45, LR=1.99e-04

Step 200: Loss=4.3490, PPL=77.40, LR=2.05e-04

Step 300: Loss=4.0043, PPL=54.83, LR=2.12e-04

Step 400: Loss=4.1894, PPL=65.98, LR=2.18e-04

Step 500: Loss=4.2901, PPL=72.97, LR=2.24e-04

Step 600: Loss=4.1052, PPL=60.65, LR=2.30e-04

Step 700: Loss=4.0343, PPL=56.51, LR=2.36e-04

Step 800: Loss=4.0409, PPL=56.88, LR=2.42e-04

Step 900: Loss=3.9496, PPL=51.91, LR=2.49e-04

Step 1000: Loss=4.1296, PPL=62.15, LR=2.55e-04

Step 1100: Loss=4.0276, PPL=56.13, LR=2.61e-04

Step 1200: Loss=3.9375, PPL=51.29, LR=2.67e-04

Step 1300: Loss=3.6965, PPL=40.31, LR=2.73e-04

Step 1400: Loss=3.9291, PPL=50.86, LR=2.80e-04

Step 1500: Loss=3.6902, PPL=40.05, LR=2.86e-04

Step 1600: Loss=3.6494, PPL=38.45, LR=2.92e-04

Step 1700: Loss=3.6491, PPL=38.44, LR=2.98e-04

Step 1800: Loss=3.5748, PPL=35.69, LR=3.04e-04

Step 1900: Loss=3.9141, PPL=50.11, LR=3.10e-04

Step 2000: Loss=3.6530, PPL=38.59, LR=3.17e-04

Step 2100: Loss=3.6580, PPL=38.78, LR=3.23e-04

Step 2200: Loss=3.5625, PPL=35.25, LR=3.29e-04

Step 2300: Loss=3.4667, PPL=32.03, LR=3.35e-04

Step 2400: Loss=3.7416, PPL=42.17, LR=3.41e-04

Step 2500: Loss=3.6329, PPL=37.82, LR=3.47e-04

Step 2600: Loss=3.4255, PPL=30.74, LR=3.54e-04

Step 2700: Loss=3.4002, PPL=29.97, LR=3.60e-04

Step 2800: Loss=3.4999, PPL=33.11, LR=3.66e-04

Step 2900: Loss=3.6265, PPL=37.58, LR=3.72e-04

Step 3000: Loss=3.5803, PPL=35.88, LR=3.78e-04

Step 3100: Loss=3.3486, PPL=28.46, LR=3.85e-04

Epoch 2 结果:
  训练损失: 3.7846, 困惑度: 44.02
  验证损失: 3.1875, 困惑度: 24.23
检查点已保存: runs/20251108_174639/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 3.1875)

==================================================
Epoch 3/50
==================================================

Step 0: Loss=3.1658, PPL=23.71, LR=3.86e-04

Step 100: Loss=3.4673, PPL=32.05, LR=3.92e-04

Step 200: Loss=3.0640, PPL=21.41, LR=3.98e-04

Step 300: Loss=3.3505, PPL=28.52, LR=4.05e-04

Step 400: Loss=3.3847, PPL=29.51, LR=4.11e-04

Step 500: Loss=3.0054, PPL=20.19, LR=4.17e-04

Step 600: Loss=3.1283, PPL=22.83, LR=4.23e-04

Step 700: Loss=3.3860, PPL=29.55, LR=4.29e-04

Step 800: Loss=3.3425, PPL=28.29, LR=4.35e-04

Step 900: Loss=3.1598, PPL=23.57, LR=4.42e-04

Step 1000: Loss=3.1953, PPL=24.42, LR=4.48e-04

Step 1100: Loss=3.0459, PPL=21.03, LR=4.54e-04

Step 1200: Loss=3.0966, PPL=22.12, LR=4.60e-04

Step 1300: Loss=3.0937, PPL=22.06, LR=4.66e-04

Step 1400: Loss=3.1163, PPL=22.56, LR=4.73e-04

Step 1500: Loss=2.9291, PPL=18.71, LR=4.79e-04

Step 1600: Loss=3.1156, PPL=22.55, LR=4.85e-04

Step 1700: Loss=3.2041, PPL=24.63, LR=4.91e-04

Step 1800: Loss=2.7151, PPL=15.11, LR=4.93e-04

Step 1900: Loss=3.0809, PPL=21.78, LR=4.90e-04

Step 2000: Loss=3.0419, PPL=20.95, LR=4.87e-04

Step 2100: Loss=3.1680, PPL=23.76, LR=4.84e-04

Step 2200: Loss=3.1528, PPL=23.40, LR=4.81e-04

Step 2300: Loss=2.9802, PPL=19.69, LR=4.78e-04

Step 2400: Loss=3.2053, PPL=24.66, LR=4.75e-04

Step 2500: Loss=2.8463, PPL=17.22, LR=4.72e-04

Step 2600: Loss=2.8214, PPL=16.80, LR=4.70e-04

Step 2700: Loss=3.1413, PPL=23.13, LR=4.67e-04

Step 2800: Loss=2.9827, PPL=19.74, LR=4.65e-04

Step 2900: Loss=2.9882, PPL=19.85, LR=4.62e-04

Step 3000: Loss=2.9401, PPL=18.92, LR=4.59e-04

Step 3100: Loss=2.9448, PPL=19.01, LR=4.57e-04

Epoch 3 结果:
  训练损失: 3.1268, 困惑度: 22.80
  验证损失: 2.7671, 困惑度: 15.91
  验证BLEU: 0.0193 (1.93%)
检查点已保存: runs/20251108_174639/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.7671)

==================================================
Epoch 4/50
==================================================

Step 0: Loss=2.7756, PPL=16.05, LR=4.56e-04

Step 100: Loss=2.5813, PPL=13.21, LR=4.54e-04

Step 200: Loss=2.8929, PPL=18.05, LR=4.52e-04

Step 300: Loss=3.0240, PPL=20.57, LR=4.49e-04

Step 400: Loss=2.8242, PPL=16.85, LR=4.47e-04

Step 500: Loss=2.7555, PPL=15.73, LR=4.45e-04

Step 600: Loss=2.9046, PPL=18.26, LR=4.42e-04

Step 700: Loss=2.6574, PPL=14.26, LR=4.40e-04

Step 800: Loss=2.9528, PPL=19.16, LR=4.38e-04

Step 900: Loss=3.0190, PPL=20.47, LR=4.36e-04

Step 1000: Loss=2.7703, PPL=15.96, LR=4.34e-04

Step 1100: Loss=2.6626, PPL=14.33, LR=4.32e-04

Step 1200: Loss=2.7069, PPL=14.98, LR=4.30e-04

Step 1300: Loss=2.7499, PPL=15.64, LR=4.28e-04

Step 1400: Loss=2.7033, PPL=14.93, LR=4.26e-04

Step 1500: Loss=2.7280, PPL=15.30, LR=4.24e-04

Step 1600: Loss=2.7938, PPL=16.34, LR=4.22e-04

Step 1700: Loss=2.6632, PPL=14.34, LR=4.20e-04

Step 1800: Loss=2.7931, PPL=16.33, LR=4.18e-04

Step 1900: Loss=2.7511, PPL=15.66, LR=4.16e-04

Step 2000: Loss=2.5059, PPL=12.25, LR=4.14e-04

Step 2100: Loss=2.9735, PPL=19.56, LR=4.13e-04

Step 2200: Loss=2.7618, PPL=15.83, LR=4.11e-04

Step 2300: Loss=2.6756, PPL=14.52, LR=4.09e-04

Step 2400: Loss=2.7679, PPL=15.92, LR=4.07e-04

Step 2500: Loss=2.9176, PPL=18.50, LR=4.06e-04

Step 2600: Loss=2.9085, PPL=18.33, LR=4.04e-04

Step 2700: Loss=2.6237, PPL=13.79, LR=4.02e-04

Step 2800: Loss=2.7587, PPL=15.78, LR=4.01e-04

Step 2900: Loss=2.7069, PPL=14.98, LR=3.99e-04

Step 3000: Loss=2.6816, PPL=14.61, LR=3.97e-04

Step 3100: Loss=2.5905, PPL=13.34, LR=3.96e-04

Epoch 4 结果:
  训练损失: 2.7340, 困惑度: 15.39
  验证损失: 2.5392, 困惑度: 12.67
检查点已保存: runs/20251108_174639/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.5392)

==================================================
Epoch 5/50
==================================================

Step 0: Loss=2.6108, PPL=13.61, LR=3.95e-04

Step 100: Loss=2.4372, PPL=11.44, LR=3.94e-04

Step 200: Loss=2.5364, PPL=12.63, LR=3.92e-04

Step 300: Loss=2.3101, PPL=10.08, LR=3.91e-04

Step 400: Loss=2.6268, PPL=13.83, LR=3.89e-04

Step 500: Loss=2.4578, PPL=11.68, LR=3.88e-04

Step 600: Loss=2.2726, PPL=9.70, LR=3.86e-04

Step 700: Loss=2.2243, PPL=9.25, LR=3.85e-04

Step 800: Loss=2.3812, PPL=10.82, LR=3.83e-04

Step 900: Loss=2.4811, PPL=11.95, LR=3.82e-04

Step 1000: Loss=2.5934, PPL=13.37, LR=3.80e-04

Step 1100: Loss=2.7388, PPL=15.47, LR=3.79e-04

Step 1200: Loss=2.2372, PPL=9.37, LR=3.78e-04

Step 1300: Loss=2.4871, PPL=12.03, LR=3.76e-04

Step 1400: Loss=2.6353, PPL=13.95, LR=3.75e-04

Step 1500: Loss=2.4288, PPL=11.35, LR=3.73e-04

Step 1600: Loss=2.7129, PPL=15.07, LR=3.72e-04

Step 1700: Loss=2.4006, PPL=11.03, LR=3.71e-04

Step 1800: Loss=2.4027, PPL=11.05, LR=3.70e-04

Step 1900: Loss=2.3104, PPL=10.08, LR=3.68e-04

Step 2000: Loss=2.6900, PPL=14.73, LR=3.67e-04

Step 2100: Loss=2.3034, PPL=10.01, LR=3.66e-04

Step 2200: Loss=2.5177, PPL=12.40, LR=3.64e-04

Step 2300: Loss=2.4576, PPL=11.68, LR=3.63e-04

Step 2400: Loss=2.4192, PPL=11.24, LR=3.62e-04

Step 2500: Loss=2.5771, PPL=13.16, LR=3.61e-04

Step 2600: Loss=2.6115, PPL=13.62, LR=3.60e-04

Step 2700: Loss=2.4160, PPL=11.20, LR=3.58e-04

Step 2800: Loss=2.5426, PPL=12.71, LR=3.57e-04

Step 2900: Loss=2.4658, PPL=11.77, LR=3.56e-04

Step 3000: Loss=2.4639, PPL=11.75, LR=3.55e-04

Step 3100: Loss=2.5935, PPL=13.38, LR=3.54e-04

Epoch 5 结果:
  训练损失: 2.4716, 困惑度: 11.84
  验证损失: 2.4069, 困惑度: 11.10
检查点已保存: runs/20251108_174639/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.4069)
检查点已保存: runs/20251108_174639/checkpoints/checkpoint_epoch_5.pt
训练曲线已保存: runs/20251108_174639/figures/training_curves.png

==================================================
Epoch 6/50
==================================================

Step 0: Loss=2.4114, PPL=11.15, LR=3.54e-04

Step 100: Loss=1.9233, PPL=6.84, LR=3.52e-04

Step 200: Loss=2.2469, PPL=9.46, LR=3.51e-04

Step 300: Loss=2.2168, PPL=9.18, LR=3.50e-04

Step 400: Loss=2.3928, PPL=10.94, LR=3.49e-04

Step 500: Loss=2.1976, PPL=9.00, LR=3.48e-04

Step 600: Loss=2.1375, PPL=8.48, LR=3.47e-04

Step 700: Loss=2.2258, PPL=9.26, LR=3.46e-04

Step 800: Loss=2.1695, PPL=8.75, LR=3.45e-04

Step 900: Loss=2.4229, PPL=11.28, LR=3.44e-04

Step 1000: Loss=2.3613, PPL=10.61, LR=3.43e-04

Step 1100: Loss=2.2866, PPL=9.84, LR=3.42e-04

Step 1200: Loss=2.1209, PPL=8.34, LR=3.41e-04

Step 1300: Loss=2.2157, PPL=9.17, LR=3.40e-04

Step 1400: Loss=2.4174, PPL=11.22, LR=3.39e-04

Step 1500: Loss=2.2520, PPL=9.51, LR=3.38e-04

Step 1600: Loss=2.1952, PPL=8.98, LR=3.37e-04

Step 1700: Loss=2.2317, PPL=9.32, LR=3.36e-04

Step 1800: Loss=2.4248, PPL=11.30, LR=3.35e-04

Step 1900: Loss=2.4085, PPL=11.12, LR=3.34e-04

Step 2000: Loss=2.2863, PPL=9.84, LR=3.33e-04

Step 2100: Loss=2.4336, PPL=11.40, LR=3.32e-04

Step 2200: Loss=2.1714, PPL=8.77, LR=3.31e-04

Step 2300: Loss=2.2859, PPL=9.83, LR=3.30e-04

Step 2400: Loss=2.2416, PPL=9.41, LR=3.29e-04

Step 2500: Loss=2.4110, PPL=11.14, LR=3.28e-04

Step 2600: Loss=2.2509, PPL=9.50, LR=3.27e-04

Step 2700: Loss=2.2606, PPL=9.59, LR=3.26e-04

Step 2800: Loss=2.2716, PPL=9.69, LR=3.26e-04

Step 2900: Loss=2.3252, PPL=10.23, LR=3.25e-04

Step 3000: Loss=2.3763, PPL=10.76, LR=3.24e-04

Step 3100: Loss=2.4103, PPL=11.14, LR=3.23e-04

Epoch 6 结果:
  训练损失: 2.2891, 困惑度: 9.87
  验证损失: 2.3164, 困惑度: 10.14
  验证BLEU: 0.0302 (3.02%)
检查点已保存: runs/20251108_174639/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.3164)

==================================================
Epoch 7/50
==================================================

Step 0: Loss=1.9660, PPL=7.14, LR=3.23e-04

Step 100: Loss=2.0951, PPL=8.13, LR=3.22e-04

Step 200: Loss=1.9398, PPL=6.96, LR=3.21e-04

Step 300: Loss=1.9515, PPL=7.04, LR=3.20e-04

Step 400: Loss=1.9349, PPL=6.92, LR=3.19e-04

Step 500: Loss=2.0303, PPL=7.62, LR=3.19e-04

Step 600: Loss=1.9786, PPL=7.23, LR=3.18e-04

Step 700: Loss=2.2010, PPL=9.03, LR=3.17e-04

Step 800: Loss=2.2193, PPL=9.20, LR=3.16e-04

Step 900: Loss=1.9773, PPL=7.22, LR=3.15e-04

Step 1000: Loss=2.2036, PPL=9.06, LR=3.14e-04

Step 1100: Loss=2.0871, PPL=8.06, LR=3.14e-04

Step 1200: Loss=2.0104, PPL=7.47, LR=3.13e-04

Step 1300: Loss=2.3026, PPL=10.00, LR=3.12e-04

Step 1400: Loss=2.0081, PPL=7.45, LR=3.11e-04

Step 1500: Loss=2.2515, PPL=9.50, LR=3.11e-04

Step 1600: Loss=2.1432, PPL=8.53, LR=3.10e-04

Step 1700: Loss=2.1921, PPL=8.95, LR=3.09e-04

Step 1800: Loss=2.0794, PPL=8.00, LR=3.08e-04

Step 1900: Loss=2.2825, PPL=9.80, LR=3.08e-04

Step 2000: Loss=2.3635, PPL=10.63, LR=3.07e-04

Step 2100: Loss=2.1135, PPL=8.28, LR=3.06e-04

Step 2200: Loss=2.2424, PPL=9.42, LR=3.05e-04

Step 2300: Loss=2.0468, PPL=7.74, LR=3.05e-04

Step 2400: Loss=2.0548, PPL=7.80, LR=3.04e-04

Step 2500: Loss=1.9258, PPL=6.86, LR=3.03e-04

Step 2600: Loss=2.2649, PPL=9.63, LR=3.02e-04

Step 2700: Loss=2.1993, PPL=9.02, LR=3.02e-04

Step 2800: Loss=2.0910, PPL=8.09, LR=3.01e-04

Step 2900: Loss=2.0555, PPL=7.81, LR=3.00e-04

Step 3000: Loss=2.2956, PPL=9.93, LR=3.00e-04

Step 3100: Loss=2.1252, PPL=8.37, LR=2.99e-04

Epoch 7 结果:
  训练损失: 2.1480, 困惑度: 8.57
  验证损失: 2.2993, 困惑度: 9.97
检查点已保存: runs/20251108_174639/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.2993)

==================================================
Epoch 8/50
==================================================

Step 0: Loss=1.9427, PPL=6.98, LR=2.99e-04

Step 100: Loss=2.1558, PPL=8.63, LR=2.98e-04

Step 200: Loss=1.8762, PPL=6.53, LR=2.97e-04

Step 300: Loss=1.7960, PPL=6.03, LR=2.97e-04

Step 400: Loss=2.0080, PPL=7.45, LR=2.96e-04

Step 500: Loss=1.9725, PPL=7.19, LR=2.95e-04

Step 600: Loss=1.9578, PPL=7.08, LR=2.95e-04

Step 700: Loss=2.0437, PPL=7.72, LR=2.94e-04

Step 800: Loss=1.9083, PPL=6.74, LR=2.93e-04

Step 900: Loss=1.9559, PPL=7.07, LR=2.93e-04

Step 1000: Loss=2.0602, PPL=7.85, LR=2.92e-04

Step 1100: Loss=2.0877, PPL=8.07, LR=2.92e-04

Step 1200: Loss=1.8822, PPL=6.57, LR=2.91e-04

Step 1300: Loss=1.9589, PPL=7.09, LR=2.90e-04

Step 1400: Loss=2.0133, PPL=7.49, LR=2.90e-04

Step 1500: Loss=2.2064, PPL=9.08, LR=2.89e-04

Step 1600: Loss=1.7504, PPL=5.76, LR=2.88e-04

Step 1700: Loss=2.1960, PPL=8.99, LR=2.88e-04

Step 1800: Loss=1.8985, PPL=6.68, LR=2.87e-04

Step 1900: Loss=2.0337, PPL=7.64, LR=2.87e-04

Step 2000: Loss=2.0946, PPL=8.12, LR=2.86e-04

Step 2100: Loss=2.1301, PPL=8.42, LR=2.85e-04

Step 2200: Loss=2.0544, PPL=7.80, LR=2.85e-04

Step 2300: Loss=2.0996, PPL=8.16, LR=2.84e-04

Step 2400: Loss=2.3081, PPL=10.05, LR=2.84e-04

Step 2500: Loss=2.2202, PPL=9.21, LR=2.83e-04

Step 2600: Loss=2.1642, PPL=8.71, LR=2.82e-04

Step 2700: Loss=2.1200, PPL=8.33, LR=2.82e-04

Step 2800: Loss=2.0141, PPL=7.49, LR=2.81e-04

Step 2900: Loss=2.1110, PPL=8.26, LR=2.81e-04

Step 3000: Loss=2.1141, PPL=8.28, LR=2.80e-04

Step 3100: Loss=2.2632, PPL=9.61, LR=2.80e-04

Epoch 8 结果:
  训练损失: 2.0301, 困惑度: 7.62
  验证损失: 2.2924, 困惑度: 9.90
检查点已保存: runs/20251108_174639/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.2924)

==================================================
Epoch 9/50
==================================================

Step 0: Loss=1.7325, PPL=5.65, LR=2.80e-04

Step 100: Loss=1.6900, PPL=5.42, LR=2.79e-04

Step 200: Loss=1.7697, PPL=5.87, LR=2.78e-04

Step 300: Loss=1.9717, PPL=7.18, LR=2.78e-04

Step 400: Loss=1.8091, PPL=6.10, LR=2.77e-04

Step 500: Loss=1.9324, PPL=6.91, LR=2.77e-04

Step 600: Loss=1.8967, PPL=6.66, LR=2.76e-04

Step 700: Loss=1.9142, PPL=6.78, LR=2.76e-04

Step 800: Loss=1.7970, PPL=6.03, LR=2.75e-04

Step 900: Loss=1.7785, PPL=5.92, LR=2.75e-04

Step 1000: Loss=1.8774, PPL=6.54, LR=2.74e-04

Step 1100: Loss=1.8484, PPL=6.35, LR=2.74e-04

Step 1200: Loss=1.8738, PPL=6.51, LR=2.73e-04

Step 1300: Loss=1.8532, PPL=6.38, LR=2.73e-04

Step 1400: Loss=1.8790, PPL=6.55, LR=2.72e-04

Step 1500: Loss=1.7999, PPL=6.05, LR=2.71e-04

Step 1600: Loss=1.9517, PPL=7.04, LR=2.71e-04

Step 1700: Loss=1.9107, PPL=6.76, LR=2.70e-04

Step 1800: Loss=1.8389, PPL=6.29, LR=2.70e-04

Step 1900: Loss=2.0371, PPL=7.67, LR=2.69e-04

Step 2000: Loss=1.8420, PPL=6.31, LR=2.69e-04

Step 2100: Loss=1.8457, PPL=6.33, LR=2.68e-04

Step 2200: Loss=1.8879, PPL=6.61, LR=2.68e-04

Step 2300: Loss=2.0462, PPL=7.74, LR=2.67e-04

Step 2400: Loss=2.1471, PPL=8.56, LR=2.67e-04

Step 2500: Loss=1.8941, PPL=6.65, LR=2.66e-04

Step 2600: Loss=2.0139, PPL=7.49, LR=2.66e-04

Step 2700: Loss=2.0503, PPL=7.77, LR=2.66e-04

Step 2800: Loss=1.9961, PPL=7.36, LR=2.65e-04

Step 2900: Loss=1.9249, PPL=6.85, LR=2.65e-04

Step 3000: Loss=1.8500, PPL=6.36, LR=2.64e-04

Step 3100: Loss=2.0223, PPL=7.56, LR=2.64e-04

Epoch 9 结果:
  训练损失: 1.9283, 困惑度: 6.88
  验证损失: 2.2927, 困惑度: 9.90
  验证BLEU: 0.0342 (3.42%)
  验证损失未改善 (patience: 1/5)
  当前: 2.2927, 最佳: 2.2924, 差距: 0.0003
检查点已保存: runs/20251108_174639/checkpoints/best_model_bleu.pt
  ✓ 保存最佳BLEU模型 (BLEU: 0.0342)

==================================================
Epoch 10/50
==================================================

Step 0: Loss=1.7570, PPL=5.79, LR=2.64e-04

Step 100: Loss=1.6462, PPL=5.19, LR=2.63e-04

Step 200: Loss=1.7175, PPL=5.57, LR=2.63e-04

Step 300: Loss=1.5378, PPL=4.65, LR=2.62e-04

Step 400: Loss=1.8354, PPL=6.27, LR=2.62e-04

Step 500: Loss=1.7273, PPL=5.63, LR=2.61e-04

Step 600: Loss=1.7145, PPL=5.55, LR=2.61e-04

Step 700: Loss=1.7658, PPL=5.85, LR=2.60e-04

Step 800: Loss=1.8310, PPL=6.24, LR=2.60e-04

Step 900: Loss=1.8066, PPL=6.09, LR=2.59e-04

Step 1000: Loss=1.7852, PPL=5.96, LR=2.59e-04

Step 1100: Loss=1.9457, PPL=7.00, LR=2.59e-04

Step 1200: Loss=1.7679, PPL=5.86, LR=2.58e-04

Step 1300: Loss=1.8600, PPL=6.42, LR=2.58e-04

Step 1400: Loss=1.8246, PPL=6.20, LR=2.57e-04

Step 1500: Loss=1.8819, PPL=6.57, LR=2.57e-04

Step 1600: Loss=1.8803, PPL=6.56, LR=2.56e-04

Step 1700: Loss=1.8876, PPL=6.60, LR=2.56e-04

Step 1800: Loss=1.6970, PPL=5.46, LR=2.55e-04

Step 1900: Loss=1.7785, PPL=5.92, LR=2.55e-04

Step 2000: Loss=2.1906, PPL=8.94, LR=2.55e-04

Step 2100: Loss=2.0602, PPL=7.85, LR=2.54e-04

Step 2200: Loss=1.9823, PPL=7.26, LR=2.54e-04

Step 2300: Loss=1.8689, PPL=6.48, LR=2.53e-04

Step 2400: Loss=1.9343, PPL=6.92, LR=2.53e-04

Step 2500: Loss=1.8669, PPL=6.47, LR=2.53e-04

Step 2600: Loss=1.7678, PPL=5.86, LR=2.52e-04

Step 2700: Loss=2.0995, PPL=8.16, LR=2.52e-04

Step 2800: Loss=1.7195, PPL=5.58, LR=2.51e-04

Step 2900: Loss=1.8716, PPL=6.50, LR=2.51e-04

Step 3000: Loss=1.8858, PPL=6.59, LR=2.50e-04

Step 3100: Loss=2.1597, PPL=8.67, LR=2.50e-04

Epoch 10 结果:
  训练损失: 1.8382, 困惑度: 6.28
  验证损失: 2.3126, 困惑度: 10.10
  验证损失未改善 (patience: 2/5)
  当前: 2.3126, 最佳: 2.2924, 差距: 0.0202
检查点已保存: runs/20251108_174639/checkpoints/checkpoint_epoch_10.pt
训练曲线已保存: runs/20251108_174639/figures/training_curves.png

==================================================
Epoch 11/50
==================================================

Step 0: Loss=1.6154, PPL=5.03, LR=2.50e-04

Step 100: Loss=1.4963, PPL=4.47, LR=2.50e-04

Step 200: Loss=1.7166, PPL=5.57, LR=2.49e-04

Step 300: Loss=1.5732, PPL=4.82, LR=2.49e-04

Step 400: Loss=1.7120, PPL=5.54, LR=2.48e-04

Step 500: Loss=1.7333, PPL=5.66, LR=2.48e-04

Step 600: Loss=1.6369, PPL=5.14, LR=2.48e-04

Step 700: Loss=1.6918, PPL=5.43, LR=2.47e-04

Step 800: Loss=1.6539, PPL=5.23, LR=2.47e-04

Step 900: Loss=1.7362, PPL=5.68, LR=2.46e-04

Step 1000: Loss=1.7672, PPL=5.85, LR=2.46e-04

Step 1100: Loss=1.7329, PPL=5.66, LR=2.46e-04

Step 1200: Loss=1.9428, PPL=6.98, LR=2.45e-04

Step 1300: Loss=1.8745, PPL=6.52, LR=2.45e-04

Step 1400: Loss=1.6185, PPL=5.05, LR=2.45e-04

Step 1500: Loss=1.6368, PPL=5.14, LR=2.44e-04

Step 1600: Loss=1.7826, PPL=5.95, LR=2.44e-04

Step 1700: Loss=1.7592, PPL=5.81, LR=2.43e-04

Step 1800: Loss=1.8906, PPL=6.62, LR=2.43e-04

Step 1900: Loss=1.7878, PPL=5.98, LR=2.43e-04

Step 2000: Loss=1.8292, PPL=6.23, LR=2.42e-04

Step 2100: Loss=1.8917, PPL=6.63, LR=2.42e-04

Step 2200: Loss=1.8550, PPL=6.39, LR=2.42e-04

Step 2300: Loss=1.7925, PPL=6.00, LR=2.41e-04

Step 2400: Loss=1.7811, PPL=5.94, LR=2.41e-04

Step 2500: Loss=1.9789, PPL=7.23, LR=2.41e-04

Step 2600: Loss=1.7326, PPL=5.66, LR=2.40e-04

Step 2700: Loss=1.6951, PPL=5.45, LR=2.40e-04

Step 2800: Loss=1.7917, PPL=6.00, LR=2.39e-04

Step 2900: Loss=1.9526, PPL=7.05, LR=2.39e-04

Step 3000: Loss=1.7553, PPL=5.79, LR=2.39e-04

Step 3100: Loss=1.7328, PPL=5.66, LR=2.38e-04

Epoch 11 结果:
  训练损失: 1.7568, 困惑度: 5.79
  验证损失: 2.3317, 困惑度: 10.29
  验证损失未改善 (patience: 3/5)
  当前: 2.3317, 最佳: 2.2924, 差距: 0.0393

==================================================
Epoch 12/50
==================================================

Step 0: Loss=1.5556, PPL=4.74, LR=2.38e-04

Step 100: Loss=1.3966, PPL=4.04, LR=2.38e-04

Step 200: Loss=1.6913, PPL=5.43, LR=2.38e-04

Step 300: Loss=1.5348, PPL=4.64, LR=2.37e-04

Step 400: Loss=1.4848, PPL=4.41, LR=2.37e-04

Step 500: Loss=1.4239, PPL=4.15, LR=2.37e-04

Step 600: Loss=1.5791, PPL=4.85, LR=2.36e-04

Step 700: Loss=1.6093, PPL=5.00, LR=2.36e-04

Step 800: Loss=1.6536, PPL=5.23, LR=2.36e-04

Step 900: Loss=1.5763, PPL=4.84, LR=2.35e-04

Step 1000: Loss=1.6952, PPL=5.45, LR=2.35e-04

Step 1100: Loss=1.7620, PPL=5.82, LR=2.35e-04

Step 1200: Loss=1.7398, PPL=5.70, LR=2.34e-04

Step 1300: Loss=1.6105, PPL=5.01, LR=2.34e-04

Step 1400: Loss=1.6933, PPL=5.44, LR=2.34e-04

Step 1500: Loss=1.7780, PPL=5.92, LR=2.33e-04

Step 1600: Loss=1.6984, PPL=5.47, LR=2.33e-04

Step 1700: Loss=1.6208, PPL=5.06, LR=2.33e-04

Step 1800: Loss=1.7153, PPL=5.56, LR=2.32e-04

Step 1900: Loss=1.7284, PPL=5.63, LR=2.32e-04

Step 2000: Loss=1.6990, PPL=5.47, LR=2.32e-04

Step 2100: Loss=1.7715, PPL=5.88, LR=2.31e-04

Step 2200: Loss=1.7135, PPL=5.55, LR=2.31e-04

Step 2300: Loss=1.6819, PPL=5.38, LR=2.31e-04

Step 2400: Loss=1.6467, PPL=5.19, LR=2.30e-04

Step 2500: Loss=1.7407, PPL=5.70, LR=2.30e-04

Step 2600: Loss=1.8344, PPL=6.26, LR=2.30e-04

Step 2700: Loss=1.9133, PPL=6.78, LR=2.30e-04

Step 2800: Loss=1.9090, PPL=6.75, LR=2.29e-04

Step 2900: Loss=1.7452, PPL=5.73, LR=2.29e-04

Step 3000: Loss=1.7792, PPL=5.93, LR=2.29e-04

Step 3100: Loss=1.7915, PPL=6.00, LR=2.28e-04

Epoch 12 结果:
  训练损失: 1.6820, 困惑度: 5.38
  验证损失: 2.3514, 困惑度: 10.50
  验证BLEU: 0.0332 (3.32%)
  验证损失未改善 (patience: 4/5)
  当前: 2.3514, 最佳: 2.2924, 差距: 0.0591

==================================================
Epoch 13/50
==================================================

Step 0: Loss=1.4835, PPL=4.41, LR=2.28e-04

Step 100: Loss=1.5151, PPL=4.55, LR=2.28e-04

Step 200: Loss=1.4246, PPL=4.16, LR=2.28e-04

Step 300: Loss=1.4551, PPL=4.28, LR=2.27e-04

Step 400: Loss=1.5537, PPL=4.73, LR=2.27e-04

Step 500: Loss=1.4029, PPL=4.07, LR=2.27e-04

Step 600: Loss=1.5000, PPL=4.48, LR=2.26e-04

Step 700: Loss=1.5269, PPL=4.60, LR=2.26e-04

Step 800: Loss=1.4467, PPL=4.25, LR=2.26e-04

Step 900: Loss=1.5979, PPL=4.94, LR=2.26e-04

Step 1000: Loss=1.6601, PPL=5.26, LR=2.25e-04

Step 1100: Loss=1.6289, PPL=5.10, LR=2.25e-04

Step 1200: Loss=1.6047, PPL=4.98, LR=2.25e-04

Step 1300: Loss=1.5712, PPL=4.81, LR=2.24e-04

Step 1400: Loss=1.5716, PPL=4.81, LR=2.24e-04

Step 1500: Loss=1.6241, PPL=5.07, LR=2.24e-04

Step 1600: Loss=1.6293, PPL=5.10, LR=2.23e-04

Step 1700: Loss=1.6750, PPL=5.34, LR=2.23e-04

Step 1800: Loss=1.5818, PPL=4.86, LR=2.23e-04

Step 1900: Loss=1.6057, PPL=4.98, LR=2.23e-04

Step 2000: Loss=1.7585, PPL=5.80, LR=2.22e-04

Step 2100: Loss=1.6121, PPL=5.01, LR=2.22e-04

Step 2200: Loss=1.7426, PPL=5.71, LR=2.22e-04

Step 2300: Loss=1.5338, PPL=4.64, LR=2.22e-04

Step 2400: Loss=1.7491, PPL=5.75, LR=2.21e-04

Step 2500: Loss=1.7782, PPL=5.92, LR=2.21e-04

Step 2600: Loss=1.6757, PPL=5.34, LR=2.21e-04

Step 2700: Loss=1.6667, PPL=5.29, LR=2.20e-04

Step 2800: Loss=1.7079, PPL=5.52, LR=2.20e-04

Step 2900: Loss=1.6503, PPL=5.21, LR=2.20e-04

Step 3000: Loss=1.7522, PPL=5.77, LR=2.20e-04

Step 3100: Loss=1.8309, PPL=6.24, LR=2.19e-04

Epoch 13 结果:
  训练损失: 1.6140, 困惑度: 5.02
  验证损失: 2.4036, 困惑度: 11.06
  验证损失未改善 (patience: 5/5)
  当前: 2.4036, 最佳: 2.2924, 差距: 0.1112

==================================================
早停触发！验证损失在 5 个epoch内未改善
当前验证损失: 2.4036
最佳验证损失: 2.2924 (epoch 8)
最佳验证BLEU: 0.0342
==================================================
训练曲线已保存: runs/20251108_174639/figures/training_curves_final.png

============================================================
训练结束时间: 2025-11-08 19:56:11
============================================================
