
============================================================
训练开始时间: 2025-11-08 17:42:39
============================================================

==================================================
运行名称: 20251108_174239
加载数据...
加载训练数据...
训练数据量: 206112，限制为: 200000
训练集大小: 200000
构建词汇表...
源语言词汇表大小: 20000
目标语言词汇表大小: 20000
加载验证数据...
验证集大小: 888
==================================================
创建模型...
模型参数统计:
  可训练参数: 60,167,712
  总参数: 60,167,712
  模型大小: 230.30 MB
==================================================
开始训练...

==================================================
Epoch 1/50
==================================================

Step 0: Loss=9.9364, PPL=20669.74, LR=6.18e-08

Step 100: Loss=9.3562, PPL=11570.00, LR=6.24e-06

Step 200: Loss=8.7818, PPL=6514.34, LR=1.24e-05

Step 300: Loss=7.9014, PPL=2701.03, LR=1.86e-05

Step 400: Loss=7.1148, PPL=1229.98, LR=2.48e-05

Step 500: Loss=6.5026, PPL=666.90, LR=3.09e-05

Step 600: Loss=6.2353, PPL=510.48, LR=3.71e-05

Step 700: Loss=6.2106, PPL=497.99, LR=4.33e-05

Step 800: Loss=6.3336, PPL=563.17, LR=4.95e-05

Step 900: Loss=5.9795, PPL=395.26, LR=5.56e-05

Step 1000: Loss=5.9308, PPL=376.46, LR=6.18e-05

Step 1100: Loss=6.0831, PPL=438.39, LR=6.80e-05

Step 1200: Loss=5.7897, PPL=326.90, LR=7.42e-05

Step 1300: Loss=5.6284, PPL=278.23, LR=8.04e-05

Step 1400: Loss=5.5736, PPL=263.38, LR=8.65e-05

Step 1500: Loss=5.5908, PPL=267.94, LR=9.27e-05

Step 1600: Loss=5.4855, PPL=241.17, LR=9.89e-05

Step 1700: Loss=5.3304, PPL=206.53, LR=1.05e-04

Step 1800: Loss=5.4052, PPL=222.57, LR=1.11e-04

Step 1900: Loss=5.4290, PPL=227.92, LR=1.17e-04

Step 2000: Loss=5.2428, PPL=189.21, LR=1.24e-04

Step 2100: Loss=5.1073, PPL=165.22, LR=1.30e-04

Step 2200: Loss=5.0974, PPL=163.59, LR=1.36e-04

Step 2300: Loss=4.9163, PPL=136.49, LR=1.42e-04

Step 2400: Loss=5.0931, PPL=162.90, LR=1.48e-04

Step 2500: Loss=4.9881, PPL=146.66, LR=1.54e-04

Step 2600: Loss=4.7717, PPL=118.12, LR=1.61e-04

Step 2700: Loss=4.7486, PPL=115.43, LR=1.67e-04

Step 2800: Loss=4.6843, PPL=108.24, LR=1.73e-04

Step 2900: Loss=4.7684, PPL=117.73, LR=1.79e-04

Step 3000: Loss=4.5302, PPL=92.78, LR=1.85e-04

Step 3100: Loss=4.6280, PPL=102.31, LR=1.92e-04

Epoch 1 结果:
  训练损失: 5.8898, 困惑度: 361.34
  验证损失: 4.4809, 困惑度: 88.31
检查点已保存: runs/20251108_174239/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 4.4809)

==================================================
Epoch 2/50
==================================================

Step 0: Loss=4.5900, PPL=98.49, LR=1.93e-04

Step 100: Loss=4.6345, PPL=102.98, LR=1.99e-04

Step 200: Loss=4.3065, PPL=74.18, LR=2.05e-04

Step 300: Loss=4.4701, PPL=87.36, LR=2.12e-04

Step 400: Loss=4.4664, PPL=87.04, LR=2.18e-04

Step 500: Loss=4.5671, PPL=96.27, LR=2.24e-04

Step 600: Loss=4.3103, PPL=74.47, LR=2.30e-04

Step 700: Loss=4.3389, PPL=76.63, LR=2.36e-04

Step 800: Loss=4.2725, PPL=71.70, LR=2.42e-04

Step 900: Loss=4.2400, PPL=69.41, LR=2.49e-04

Step 1000: Loss=4.3738, PPL=79.34, LR=2.55e-04

Step 1100: Loss=4.1743, PPL=64.99, LR=2.61e-04

Step 1200: Loss=4.0950, PPL=60.04, LR=2.67e-04

Step 1300: Loss=4.2273, PPL=68.53, LR=2.73e-04

Step 1400: Loss=4.1718, PPL=64.83, LR=2.80e-04

Step 1500: Loss=4.1028, PPL=60.51, LR=2.86e-04

Step 1600: Loss=4.1655, PPL=64.43, LR=2.92e-04

Step 1700: Loss=3.8252, PPL=45.84, LR=2.98e-04

Step 1800: Loss=3.9479, PPL=51.83, LR=3.04e-04

Step 1900: Loss=3.8336, PPL=46.23, LR=3.10e-04

Step 2000: Loss=3.9924, PPL=54.18, LR=3.17e-04

Step 2100: Loss=3.9939, PPL=54.27, LR=3.23e-04

Step 2200: Loss=3.8670, PPL=47.80, LR=3.29e-04

Step 2300: Loss=3.9092, PPL=49.86, LR=3.35e-04

Step 2400: Loss=3.9629, PPL=52.61, LR=3.41e-04

Step 2500: Loss=3.8117, PPL=45.23, LR=3.47e-04

Step 2600: Loss=3.8966, PPL=49.23, LR=3.54e-04

Step 2700: Loss=3.6484, PPL=38.41, LR=3.60e-04

Step 2800: Loss=3.7764, PPL=43.66, LR=3.66e-04

Step 2900: Loss=3.7830, PPL=43.95, LR=3.72e-04

Step 3000: Loss=3.6712, PPL=39.30, LR=3.78e-04

Step 3100: Loss=3.3781, PPL=29.31, LR=3.85e-04

Epoch 2 结果:
  训练损失: 4.0650, 困惑度: 58.27
  验证损失: 3.3686, 困惑度: 29.04
检查点已保存: runs/20251108_174239/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 3.3686)

==================================================
Epoch 3/50
==================================================

Step 0: Loss=3.2684, PPL=26.27, LR=3.86e-04

Step 100: Loss=3.7396, PPL=42.08, LR=3.92e-04

Step 200: Loss=3.5748, PPL=35.69, LR=3.98e-04

Step 300: Loss=3.3245, PPL=27.78, LR=4.05e-04

Step 400: Loss=3.6374, PPL=37.99, LR=4.11e-04

Step 500: Loss=3.3113, PPL=27.42, LR=4.17e-04

Step 600: Loss=3.5666, PPL=35.40, LR=4.23e-04

Step 700: Loss=3.3667, PPL=28.98, LR=4.29e-04

Step 800: Loss=3.4433, PPL=31.29, LR=4.35e-04

Step 900: Loss=3.1115, PPL=22.45, LR=4.42e-04

Step 1000: Loss=3.5825, PPL=35.97, LR=4.48e-04

Step 1100: Loss=3.3244, PPL=27.78, LR=4.54e-04

Step 1200: Loss=3.4099, PPL=30.26, LR=4.60e-04

Step 1300: Loss=3.3941, PPL=29.79, LR=4.66e-04

Step 1400: Loss=3.3731, PPL=29.17, LR=4.73e-04

Step 1500: Loss=3.4438, PPL=31.31, LR=4.79e-04

Step 1600: Loss=3.2147, PPL=24.90, LR=4.85e-04

Step 1700: Loss=3.1989, PPL=24.50, LR=4.91e-04

Step 1800: Loss=3.4581, PPL=31.76, LR=4.93e-04

Step 1900: Loss=3.2721, PPL=26.37, LR=4.90e-04

Step 2000: Loss=3.4442, PPL=31.32, LR=4.87e-04

Step 2100: Loss=3.3221, PPL=27.72, LR=4.84e-04

Step 2200: Loss=3.4444, PPL=31.33, LR=4.81e-04

Step 2300: Loss=3.4018, PPL=30.02, LR=4.78e-04

Step 2400: Loss=3.2043, PPL=24.64, LR=4.75e-04

Step 2500: Loss=3.3770, PPL=29.28, LR=4.72e-04

Step 2600: Loss=3.1847, PPL=24.16, LR=4.70e-04

Step 2700: Loss=3.2993, PPL=27.09, LR=4.67e-04

Step 2800: Loss=3.3283, PPL=27.89, LR=4.65e-04

Step 2900: Loss=3.2617, PPL=26.09, LR=4.62e-04

Step 3000: Loss=3.1636, PPL=23.66, LR=4.59e-04

Step 3100: Loss=3.3820, PPL=29.43, LR=4.57e-04

Epoch 3 结果:
  训练损失: 3.3943, 困惑度: 29.79
  验证损失: 2.9173, 困惑度: 18.49
  验证BLEU: 0.0181 (1.81%)
检查点已保存: runs/20251108_174239/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.9173)

==================================================
Epoch 4/50
==================================================

Step 0: Loss=2.8579, PPL=17.42, LR=4.56e-04

Step 100: Loss=3.1458, PPL=23.24, LR=4.54e-04

Step 200: Loss=3.0781, PPL=21.72, LR=4.52e-04

Step 300: Loss=2.8427, PPL=17.16, LR=4.49e-04

Step 400: Loss=3.0161, PPL=20.41, LR=4.47e-04

Step 500: Loss=2.9474, PPL=19.06, LR=4.45e-04

Step 600: Loss=3.1738, PPL=23.90, LR=4.42e-04

Step 700: Loss=3.0120, PPL=20.33, LR=4.40e-04

Step 800: Loss=2.9927, PPL=19.94, LR=4.38e-04

Step 900: Loss=2.9654, PPL=19.40, LR=4.36e-04

Step 1000: Loss=2.9702, PPL=19.50, LR=4.34e-04

Step 1100: Loss=2.9183, PPL=18.51, LR=4.32e-04

Step 1200: Loss=3.1208, PPL=22.66, LR=4.30e-04

Step 1300: Loss=3.0304, PPL=20.71, LR=4.28e-04

Step 1400: Loss=3.1487, PPL=23.30, LR=4.26e-04

Step 1500: Loss=2.9417, PPL=18.95, LR=4.24e-04

Step 1600: Loss=3.1097, PPL=22.41, LR=4.22e-04

Step 1700: Loss=2.8007, PPL=16.46, LR=4.20e-04

Step 1800: Loss=2.9849, PPL=19.78, LR=4.18e-04

Step 1900: Loss=3.0953, PPL=22.09, LR=4.16e-04

Step 2000: Loss=2.9453, PPL=19.02, LR=4.14e-04

Step 2100: Loss=2.8533, PPL=17.34, LR=4.13e-04

Step 2200: Loss=3.0648, PPL=21.43, LR=4.11e-04

Step 2300: Loss=2.9334, PPL=18.79, LR=4.09e-04

Step 2400: Loss=2.9090, PPL=18.34, LR=4.07e-04

Step 2500: Loss=3.0000, PPL=20.09, LR=4.06e-04

Step 2600: Loss=3.0443, PPL=21.00, LR=4.04e-04

Step 2700: Loss=3.0510, PPL=21.14, LR=4.02e-04

Step 2800: Loss=3.0358, PPL=20.82, LR=4.01e-04

Step 2900: Loss=3.2776, PPL=26.51, LR=3.99e-04

Step 3000: Loss=3.1255, PPL=22.77, LR=3.97e-04

Step 3100: Loss=2.9872, PPL=19.83, LR=3.96e-04

Epoch 4 结果:
  训练损失: 3.0057, 困惑度: 20.20
  验证损失: 2.6481, 困惑度: 14.13
检查点已保存: runs/20251108_174239/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.6481)

==================================================
Epoch 5/50
==================================================

Step 0: Loss=2.6766, PPL=14.54, LR=3.95e-04

Step 100: Loss=2.7068, PPL=14.98, LR=3.94e-04

Step 200: Loss=2.7368, PPL=15.44, LR=3.92e-04

Step 300: Loss=2.6587, PPL=14.28, LR=3.91e-04

Step 400: Loss=2.8495, PPL=17.28, LR=3.89e-04

Step 500: Loss=2.8986, PPL=18.15, LR=3.88e-04

Step 600: Loss=2.7481, PPL=15.61, LR=3.86e-04

Step 700: Loss=2.8788, PPL=17.79, LR=3.85e-04

Step 800: Loss=2.9912, PPL=19.91, LR=3.83e-04

Step 900: Loss=2.7600, PPL=15.80, LR=3.82e-04

Step 1000: Loss=3.0555, PPL=21.23, LR=3.80e-04

Step 1100: Loss=2.6115, PPL=13.62, LR=3.79e-04

Step 1200: Loss=2.7295, PPL=15.33, LR=3.78e-04

Step 1300: Loss=2.7905, PPL=16.29, LR=3.76e-04

Step 1400: Loss=2.7524, PPL=15.68, LR=3.75e-04

Step 1500: Loss=2.7577, PPL=15.76, LR=3.73e-04

Step 1600: Loss=2.8745, PPL=17.72, LR=3.72e-04

Step 1700: Loss=2.7487, PPL=15.62, LR=3.71e-04

Step 1800: Loss=2.8060, PPL=16.54, LR=3.70e-04

Step 1900: Loss=2.6225, PPL=13.77, LR=3.68e-04

Step 2000: Loss=2.4883, PPL=12.04, LR=3.67e-04

Step 2100: Loss=2.6948, PPL=14.80, LR=3.66e-04

Step 2200: Loss=2.7109, PPL=15.04, LR=3.64e-04

Step 2300: Loss=2.5185, PPL=12.41, LR=3.63e-04

Step 2400: Loss=2.8033, PPL=16.50, LR=3.62e-04

Step 2500: Loss=2.4975, PPL=12.15, LR=3.61e-04

Step 2600: Loss=2.7589, PPL=15.78, LR=3.60e-04

Step 2700: Loss=2.9554, PPL=19.21, LR=3.58e-04

Step 2800: Loss=2.7760, PPL=16.05, LR=3.57e-04

Step 2900: Loss=2.5765, PPL=13.15, LR=3.56e-04

Step 3000: Loss=2.6343, PPL=13.93, LR=3.55e-04

Step 3100: Loss=2.6951, PPL=14.81, LR=3.54e-04

Epoch 5 结果:
  训练损失: 2.7633, 困惑度: 15.85
  验证损失: 2.5329, 困惑度: 12.59
检查点已保存: runs/20251108_174239/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.5329)
检查点已保存: runs/20251108_174239/checkpoints/checkpoint_epoch_5.pt
训练曲线已保存: runs/20251108_174239/figures/training_curves.png

==================================================
Epoch 6/50
==================================================

Step 0: Loss=2.4715, PPL=11.84, LR=3.54e-04

Step 100: Loss=2.4576, PPL=11.68, LR=3.52e-04

Step 200: Loss=2.7454, PPL=15.57, LR=3.51e-04

Step 300: Loss=2.5548, PPL=12.87, LR=3.50e-04

Step 400: Loss=2.4358, PPL=11.43, LR=3.49e-04

Step 500: Loss=2.5130, PPL=12.34, LR=3.48e-04

Step 600: Loss=2.5312, PPL=12.57, LR=3.47e-04

Step 700: Loss=2.4682, PPL=11.80, LR=3.46e-04

Step 800: Loss=2.6553, PPL=14.23, LR=3.45e-04

Step 900: Loss=2.7043, PPL=14.94, LR=3.44e-04

Step 1000: Loss=2.4088, PPL=11.12, LR=3.43e-04

Step 1100: Loss=2.5074, PPL=12.27, LR=3.42e-04

Step 1200: Loss=2.4350, PPL=11.42, LR=3.41e-04

Step 1300: Loss=2.4429, PPL=11.51, LR=3.40e-04

Step 1400: Loss=2.7225, PPL=15.22, LR=3.39e-04

Step 1500: Loss=2.5577, PPL=12.91, LR=3.38e-04

Step 1600: Loss=2.5300, PPL=12.55, LR=3.37e-04

Step 1700: Loss=2.5603, PPL=12.94, LR=3.36e-04

Step 1800: Loss=2.6365, PPL=13.96, LR=3.35e-04

Step 1900: Loss=2.6002, PPL=13.47, LR=3.34e-04

Step 2000: Loss=2.7506, PPL=15.65, LR=3.33e-04

Step 2100: Loss=2.7299, PPL=15.33, LR=3.32e-04

Step 2200: Loss=2.4564, PPL=11.66, LR=3.31e-04

Step 2300: Loss=2.8717, PPL=17.67, LR=3.30e-04

Step 2400: Loss=2.3930, PPL=10.95, LR=3.29e-04

Step 2500: Loss=2.8185, PPL=16.75, LR=3.28e-04

Step 2600: Loss=2.6377, PPL=13.98, LR=3.27e-04

Step 2700: Loss=2.5064, PPL=12.26, LR=3.26e-04

Step 2800: Loss=2.5829, PPL=13.24, LR=3.26e-04

Step 2900: Loss=2.5764, PPL=13.15, LR=3.25e-04

Step 3000: Loss=2.7097, PPL=15.02, LR=3.24e-04

Step 3100: Loss=2.7633, PPL=15.85, LR=3.23e-04

Epoch 6 结果:
  训练损失: 2.6048, 困惑度: 13.53
  验证损失: 2.4675, 困惑度: 11.79
  验证BLEU: 0.0294 (2.94%)
检查点已保存: runs/20251108_174239/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.4675)

==================================================
Epoch 7/50
==================================================

Step 0: Loss=2.3235, PPL=10.21, LR=3.23e-04

Step 100: Loss=2.3645, PPL=10.64, LR=3.22e-04

Step 200: Loss=2.4840, PPL=11.99, LR=3.21e-04

Step 300: Loss=2.4170, PPL=11.21, LR=3.20e-04

Step 400: Loss=2.4524, PPL=11.62, LR=3.19e-04

Step 500: Loss=2.4161, PPL=11.20, LR=3.19e-04

Step 600: Loss=2.3729, PPL=10.73, LR=3.18e-04

Step 700: Loss=2.1072, PPL=8.23, LR=3.17e-04

Step 800: Loss=2.3670, PPL=10.67, LR=3.16e-04

Step 900: Loss=2.4204, PPL=11.25, LR=3.15e-04

Step 1000: Loss=2.6490, PPL=14.14, LR=3.14e-04

Step 1100: Loss=2.3917, PPL=10.93, LR=3.14e-04

Step 1200: Loss=2.3818, PPL=10.82, LR=3.13e-04

Step 1300: Loss=2.4029, PPL=11.06, LR=3.12e-04

Step 1400: Loss=2.3564, PPL=10.55, LR=3.11e-04

Step 1500: Loss=2.6027, PPL=13.50, LR=3.11e-04

Step 1600: Loss=2.5643, PPL=12.99, LR=3.10e-04

Step 1700: Loss=2.1990, PPL=9.02, LR=3.09e-04

Step 1800: Loss=2.5393, PPL=12.67, LR=3.08e-04

Step 1900: Loss=2.5159, PPL=12.38, LR=3.08e-04

Step 2000: Loss=2.5548, PPL=12.87, LR=3.07e-04

Step 2100: Loss=2.4490, PPL=11.58, LR=3.06e-04

Step 2200: Loss=2.4802, PPL=11.94, LR=3.05e-04

Step 2300: Loss=2.4840, PPL=11.99, LR=3.05e-04

Step 2400: Loss=2.4510, PPL=11.60, LR=3.04e-04

Step 2500: Loss=2.5641, PPL=12.99, LR=3.03e-04

Step 2600: Loss=2.5144, PPL=12.36, LR=3.02e-04

Step 2700: Loss=2.4165, PPL=11.21, LR=3.02e-04

Step 2800: Loss=2.6481, PPL=14.13, LR=3.01e-04

Step 2900: Loss=2.3193, PPL=10.17, LR=3.00e-04

Step 3000: Loss=2.3961, PPL=10.98, LR=3.00e-04

Step 3100: Loss=2.4263, PPL=11.32, LR=2.99e-04

Epoch 7 结果:
  训练损失: 2.4863, 困惑度: 12.02
  验证损失: 2.3989, 困惑度: 11.01
检查点已保存: runs/20251108_174239/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.3989)

==================================================
Epoch 8/50
==================================================

Step 0: Loss=2.3253, PPL=10.23, LR=2.99e-04

Step 100: Loss=2.4203, PPL=11.25, LR=2.98e-04

Step 200: Loss=2.2991, PPL=9.97, LR=2.97e-04

Step 300: Loss=2.3647, PPL=10.64, LR=2.97e-04

Step 400: Loss=2.4736, PPL=11.86, LR=2.96e-04

Step 500: Loss=2.2711, PPL=9.69, LR=2.95e-04

Step 600: Loss=2.5914, PPL=13.35, LR=2.95e-04

Step 700: Loss=2.4774, PPL=11.91, LR=2.94e-04

Step 800: Loss=2.3413, PPL=10.39, LR=2.93e-04

Step 900: Loss=2.4585, PPL=11.69, LR=2.93e-04

Step 1000: Loss=2.5047, PPL=12.24, LR=2.92e-04

Step 1100: Loss=2.4157, PPL=11.20, LR=2.92e-04

Step 1200: Loss=2.5778, PPL=13.17, LR=2.91e-04

Step 1300: Loss=2.3431, PPL=10.41, LR=2.90e-04

Step 1400: Loss=2.3601, PPL=10.59, LR=2.90e-04

Step 1500: Loss=2.5127, PPL=12.34, LR=2.89e-04

Step 1600: Loss=2.3015, PPL=9.99, LR=2.88e-04

Step 1700: Loss=2.4002, PPL=11.03, LR=2.88e-04

Step 1800: Loss=2.3068, PPL=10.04, LR=2.87e-04

Step 1900: Loss=2.5415, PPL=12.70, LR=2.87e-04

Step 2000: Loss=2.6119, PPL=13.62, LR=2.86e-04

Step 2100: Loss=2.4404, PPL=11.48, LR=2.85e-04

Step 2200: Loss=2.5041, PPL=12.23, LR=2.85e-04

Step 2300: Loss=2.3146, PPL=10.12, LR=2.84e-04

Step 2400: Loss=2.4034, PPL=11.06, LR=2.84e-04

Step 2500: Loss=2.5409, PPL=12.69, LR=2.83e-04

Step 2600: Loss=2.4377, PPL=11.45, LR=2.82e-04

Step 2700: Loss=2.4139, PPL=11.18, LR=2.82e-04

Step 2800: Loss=2.5062, PPL=12.26, LR=2.81e-04

Step 2900: Loss=2.3838, PPL=10.85, LR=2.81e-04

Step 3000: Loss=2.2449, PPL=9.44, LR=2.80e-04

Step 3100: Loss=2.5106, PPL=12.31, LR=2.80e-04

Epoch 8 结果:
  训练损失: 2.3940, 困惑度: 10.96
  验证损失: 2.3644, 困惑度: 10.64
检查点已保存: runs/20251108_174239/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.3644)

==================================================
Epoch 9/50
==================================================

Step 0: Loss=2.2555, PPL=9.54, LR=2.80e-04

Step 100: Loss=2.3892, PPL=10.91, LR=2.79e-04

Step 200: Loss=2.3370, PPL=10.35, LR=2.78e-04

Step 300: Loss=2.1866, PPL=8.90, LR=2.78e-04

Step 400: Loss=2.1349, PPL=8.46, LR=2.77e-04

Step 500: Loss=2.3394, PPL=10.38, LR=2.77e-04

Step 600: Loss=2.6044, PPL=13.52, LR=2.76e-04

Step 700: Loss=2.2594, PPL=9.58, LR=2.76e-04

Step 800: Loss=2.3367, PPL=10.35, LR=2.75e-04

Step 900: Loss=2.3393, PPL=10.37, LR=2.75e-04

Step 1000: Loss=2.2215, PPL=9.22, LR=2.74e-04

Step 1100: Loss=2.3978, PPL=11.00, LR=2.74e-04

Step 1200: Loss=2.2144, PPL=9.16, LR=2.73e-04

Step 1300: Loss=2.2239, PPL=9.24, LR=2.73e-04

Step 1400: Loss=2.1241, PPL=8.37, LR=2.72e-04

Step 1500: Loss=2.2116, PPL=9.13, LR=2.71e-04

Step 1600: Loss=2.4171, PPL=11.21, LR=2.71e-04

Step 1700: Loss=2.2332, PPL=9.33, LR=2.70e-04

Step 1800: Loss=2.2687, PPL=9.67, LR=2.70e-04

Step 1900: Loss=2.5509, PPL=12.82, LR=2.69e-04

Step 2000: Loss=2.2711, PPL=9.69, LR=2.69e-04

Step 2100: Loss=2.5590, PPL=12.92, LR=2.68e-04

Step 2200: Loss=2.4350, PPL=11.42, LR=2.68e-04

Step 2300: Loss=2.3663, PPL=10.66, LR=2.67e-04

Step 2400: Loss=2.3789, PPL=10.79, LR=2.67e-04

Step 2500: Loss=2.3752, PPL=10.75, LR=2.66e-04

Step 2600: Loss=2.1883, PPL=8.92, LR=2.66e-04

Step 2700: Loss=2.3023, PPL=10.00, LR=2.66e-04

Step 2800: Loss=2.2179, PPL=9.19, LR=2.65e-04

Step 2900: Loss=2.3510, PPL=10.50, LR=2.65e-04

Step 3000: Loss=2.2813, PPL=9.79, LR=2.64e-04

Step 3100: Loss=2.5048, PPL=12.24, LR=2.64e-04

Epoch 9 结果:
  训练损失: 2.3165, 困惑度: 10.14
  验证损失: 2.3346, 困惑度: 10.33
  验证BLEU: 0.0350 (3.50%)
检查点已保存: runs/20251108_174239/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.3346)

==================================================
Epoch 10/50
==================================================

Step 0: Loss=2.2046, PPL=9.07, LR=2.64e-04

Step 100: Loss=2.2051, PPL=9.07, LR=2.63e-04

Step 200: Loss=2.3833, PPL=10.84, LR=2.63e-04

Step 300: Loss=2.0199, PPL=7.54, LR=2.62e-04

Step 400: Loss=2.1552, PPL=8.63, LR=2.62e-04

Step 500: Loss=2.4290, PPL=11.35, LR=2.61e-04

Step 600: Loss=2.1586, PPL=8.66, LR=2.61e-04

Step 700: Loss=2.0992, PPL=8.16, LR=2.60e-04

Step 800: Loss=2.1938, PPL=8.97, LR=2.60e-04

Step 900: Loss=2.1266, PPL=8.39, LR=2.59e-04

Step 1000: Loss=2.3572, PPL=10.56, LR=2.59e-04

Step 1100: Loss=2.1435, PPL=8.53, LR=2.59e-04

Step 1200: Loss=2.0432, PPL=7.72, LR=2.58e-04

Step 1300: Loss=2.2719, PPL=9.70, LR=2.58e-04

Step 1400: Loss=2.3769, PPL=10.77, LR=2.57e-04

Step 1500: Loss=2.2962, PPL=9.94, LR=2.57e-04

Step 1600: Loss=2.2675, PPL=9.65, LR=2.56e-04

Step 1700: Loss=2.0946, PPL=8.12, LR=2.56e-04

Step 1800: Loss=2.2510, PPL=9.50, LR=2.55e-04

Step 1900: Loss=2.2650, PPL=9.63, LR=2.55e-04

Step 2000: Loss=2.5102, PPL=12.31, LR=2.55e-04

Step 2100: Loss=2.2896, PPL=9.87, LR=2.54e-04

Step 2200: Loss=2.3234, PPL=10.21, LR=2.54e-04

Step 2300: Loss=2.5034, PPL=12.22, LR=2.53e-04

Step 2400: Loss=2.3748, PPL=10.75, LR=2.53e-04

Step 2500: Loss=2.4579, PPL=11.68, LR=2.53e-04

Step 2600: Loss=2.2614, PPL=9.60, LR=2.52e-04

Step 2700: Loss=2.3740, PPL=10.74, LR=2.52e-04

Step 2800: Loss=2.3369, PPL=10.35, LR=2.51e-04

Step 2900: Loss=2.3076, PPL=10.05, LR=2.51e-04

Step 3000: Loss=2.3427, PPL=10.41, LR=2.50e-04

Step 3100: Loss=2.4102, PPL=11.14, LR=2.50e-04

Epoch 10 结果:
  训练损失: 2.2503, 困惑度: 9.49
  验证损失: 2.3222, 困惑度: 10.20
检查点已保存: runs/20251108_174239/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.3222)
检查点已保存: runs/20251108_174239/checkpoints/checkpoint_epoch_10.pt
训练曲线已保存: runs/20251108_174239/figures/training_curves.png

==================================================
Epoch 11/50
==================================================

Step 0: Loss=2.0419, PPL=7.70, LR=2.50e-04

Step 100: Loss=2.1499, PPL=8.58, LR=2.50e-04

Step 200: Loss=2.1280, PPL=8.40, LR=2.49e-04

Step 300: Loss=2.0888, PPL=8.07, LR=2.49e-04

Step 400: Loss=2.2643, PPL=9.62, LR=2.48e-04

Step 500: Loss=1.8973, PPL=6.67, LR=2.48e-04

Step 600: Loss=2.2013, PPL=9.04, LR=2.48e-04

Step 700: Loss=2.0914, PPL=8.10, LR=2.47e-04

Step 800: Loss=2.1009, PPL=8.17, LR=2.47e-04

Step 900: Loss=2.2675, PPL=9.66, LR=2.46e-04

Step 1000: Loss=2.2857, PPL=9.83, LR=2.46e-04

Step 1100: Loss=2.0290, PPL=7.61, LR=2.46e-04

Step 1200: Loss=2.0980, PPL=8.15, LR=2.45e-04

Step 1300: Loss=2.0143, PPL=7.50, LR=2.45e-04

Step 1400: Loss=2.3707, PPL=10.71, LR=2.45e-04

Step 1500: Loss=2.0209, PPL=7.55, LR=2.44e-04

Step 1600: Loss=2.2544, PPL=9.53, LR=2.44e-04

Step 1700: Loss=2.2857, PPL=9.83, LR=2.43e-04

Step 1800: Loss=2.3862, PPL=10.87, LR=2.43e-04

Step 1900: Loss=2.0883, PPL=8.07, LR=2.43e-04

Step 2000: Loss=2.0874, PPL=8.06, LR=2.42e-04

Step 2100: Loss=1.9756, PPL=7.21, LR=2.42e-04

Step 2200: Loss=2.3494, PPL=10.48, LR=2.42e-04

Step 2300: Loss=2.2082, PPL=9.10, LR=2.41e-04

Step 2400: Loss=2.3296, PPL=10.27, LR=2.41e-04

Step 2500: Loss=2.1655, PPL=8.72, LR=2.41e-04

Step 2600: Loss=2.3105, PPL=10.08, LR=2.40e-04

Step 2700: Loss=2.0413, PPL=7.70, LR=2.40e-04

Step 2800: Loss=2.4513, PPL=11.60, LR=2.39e-04

Step 2900: Loss=2.4792, PPL=11.93, LR=2.39e-04

Step 3000: Loss=2.2967, PPL=9.94, LR=2.39e-04

Step 3100: Loss=2.1492, PPL=8.58, LR=2.38e-04

Epoch 11 结果:
  训练损失: 2.1935, 困惑度: 8.97
  验证损失: 2.3250, 困惑度: 10.23
  验证损失未改善 (patience: 1/5)
  当前: 2.3250, 最佳: 2.3222, 差距: 0.0028

==================================================
Epoch 12/50
==================================================

Step 0: Loss=1.7797, PPL=5.93, LR=2.38e-04

Step 100: Loss=2.0712, PPL=7.93, LR=2.38e-04

Step 200: Loss=2.0683, PPL=7.91, LR=2.38e-04

Step 300: Loss=2.0119, PPL=7.48, LR=2.37e-04

Step 400: Loss=2.1470, PPL=8.56, LR=2.37e-04

Step 500: Loss=2.0240, PPL=7.57, LR=2.37e-04

Step 600: Loss=2.1504, PPL=8.59, LR=2.36e-04

Step 700: Loss=2.1135, PPL=8.28, LR=2.36e-04

Step 800: Loss=2.1482, PPL=8.57, LR=2.36e-04

Step 900: Loss=2.0843, PPL=8.04, LR=2.35e-04

Step 1000: Loss=2.2533, PPL=9.52, LR=2.35e-04

Step 1100: Loss=2.3165, PPL=10.14, LR=2.35e-04

Step 1200: Loss=2.2044, PPL=9.07, LR=2.34e-04

Step 1300: Loss=2.2582, PPL=9.57, LR=2.34e-04

Step 1400: Loss=1.9479, PPL=7.01, LR=2.34e-04

Step 1500: Loss=2.1264, PPL=8.38, LR=2.33e-04

Step 1600: Loss=2.0197, PPL=7.54, LR=2.33e-04

Step 1700: Loss=2.0527, PPL=7.79, LR=2.33e-04

Step 1800: Loss=2.3126, PPL=10.10, LR=2.32e-04

Step 1900: Loss=2.1705, PPL=8.76, LR=2.32e-04

Step 2000: Loss=2.1432, PPL=8.53, LR=2.32e-04

Step 2100: Loss=2.1891, PPL=8.93, LR=2.31e-04

Step 2200: Loss=2.2040, PPL=9.06, LR=2.31e-04

Step 2300: Loss=2.1831, PPL=8.87, LR=2.31e-04

Step 2400: Loss=2.1579, PPL=8.65, LR=2.30e-04

Step 2500: Loss=2.0519, PPL=7.78, LR=2.30e-04

Step 2600: Loss=2.1631, PPL=8.70, LR=2.30e-04

Step 2700: Loss=2.2689, PPL=9.67, LR=2.30e-04

Step 2800: Loss=2.0692, PPL=7.92, LR=2.29e-04

Step 2900: Loss=2.1470, PPL=8.56, LR=2.29e-04

Step 3000: Loss=2.2994, PPL=9.97, LR=2.29e-04

Step 3100: Loss=2.0868, PPL=8.06, LR=2.28e-04

Epoch 12 结果:
  训练损失: 2.1427, 困惑度: 8.52
  验证损失: 2.3318, 困惑度: 10.30
  验证BLEU: 0.0327 (3.27%)
  验证损失未改善 (patience: 2/5)
  当前: 2.3318, 最佳: 2.3222, 差距: 0.0096

==================================================
Epoch 13/50
==================================================

Step 0: Loss=2.2245, PPL=9.25, LR=2.28e-04

Step 100: Loss=2.1611, PPL=8.68, LR=2.28e-04

Step 200: Loss=1.9120, PPL=6.77, LR=2.28e-04

Step 300: Loss=2.1325, PPL=8.44, LR=2.27e-04

Step 400: Loss=2.0810, PPL=8.01, LR=2.27e-04

Step 500: Loss=2.0966, PPL=8.14, LR=2.27e-04

Step 600: Loss=2.0231, PPL=7.56, LR=2.26e-04

Step 700: Loss=2.0874, PPL=8.06, LR=2.26e-04

Step 800: Loss=1.8692, PPL=6.48, LR=2.26e-04

Step 900: Loss=2.2193, PPL=9.20, LR=2.26e-04

Step 1000: Loss=2.0123, PPL=7.48, LR=2.25e-04

Step 1100: Loss=1.9862, PPL=7.29, LR=2.25e-04

Step 1200: Loss=1.8929, PPL=6.64, LR=2.25e-04

Step 1300: Loss=2.1509, PPL=8.59, LR=2.24e-04

Step 1400: Loss=2.0201, PPL=7.54, LR=2.24e-04

Step 1500: Loss=2.1544, PPL=8.62, LR=2.24e-04

Step 1600: Loss=2.0782, PPL=7.99, LR=2.23e-04

Step 1700: Loss=2.0373, PPL=7.67, LR=2.23e-04

Step 1800: Loss=2.2364, PPL=9.36, LR=2.23e-04

Step 1900: Loss=2.0389, PPL=7.68, LR=2.23e-04

Step 2000: Loss=2.2390, PPL=9.38, LR=2.22e-04

Step 2100: Loss=2.1201, PPL=8.33, LR=2.22e-04

Step 2200: Loss=1.9917, PPL=7.33, LR=2.22e-04

Step 2300: Loss=2.3276, PPL=10.25, LR=2.22e-04

Step 2400: Loss=2.2026, PPL=9.05, LR=2.21e-04

Step 2500: Loss=2.2302, PPL=9.30, LR=2.21e-04

Step 2600: Loss=2.5402, PPL=12.68, LR=2.21e-04

Step 2700: Loss=2.1621, PPL=8.69, LR=2.20e-04

Step 2800: Loss=2.2161, PPL=9.17, LR=2.20e-04

Step 2900: Loss=2.1118, PPL=8.26, LR=2.20e-04

Step 3000: Loss=2.2664, PPL=9.64, LR=2.20e-04

Step 3100: Loss=2.2188, PPL=9.20, LR=2.19e-04

Epoch 13 结果:
  训练损失: 2.0978, 困惑度: 8.15
  验证损失: 2.3253, 困惑度: 10.23
  验证损失未改善 (patience: 3/5)
  当前: 2.3253, 最佳: 2.3222, 差距: 0.0031

==================================================
Epoch 14/50
==================================================

Step 0: Loss=1.7635, PPL=5.83, LR=2.19e-04

Step 100: Loss=1.8662, PPL=6.46, LR=2.19e-04

Step 200: Loss=2.0234, PPL=7.56, LR=2.19e-04

Step 300: Loss=2.0478, PPL=7.75, LR=2.18e-04

Step 400: Loss=1.7901, PPL=5.99, LR=2.18e-04

Step 500: Loss=1.9045, PPL=6.72, LR=2.18e-04

Step 600: Loss=2.1088, PPL=8.24, LR=2.18e-04

Step 700: Loss=1.9473, PPL=7.01, LR=2.17e-04

Step 800: Loss=1.8540, PPL=6.39, LR=2.17e-04

Step 900: Loss=2.0860, PPL=8.05, LR=2.17e-04

Step 1000: Loss=2.0590, PPL=7.84, LR=2.17e-04

Step 1100: Loss=2.0533, PPL=7.79, LR=2.16e-04

Step 1200: Loss=2.0171, PPL=7.52, LR=2.16e-04

Step 1300: Loss=2.1763, PPL=8.81, LR=2.16e-04

Step 1400: Loss=2.1465, PPL=8.55, LR=2.16e-04

Step 1500: Loss=2.0025, PPL=7.41, LR=2.15e-04

Step 1600: Loss=1.8807, PPL=6.56, LR=2.15e-04

Step 1700: Loss=1.9930, PPL=7.34, LR=2.15e-04

Step 1800: Loss=2.3705, PPL=10.70, LR=2.15e-04

Step 1900: Loss=2.3599, PPL=10.59, LR=2.14e-04

Step 2000: Loss=2.1219, PPL=8.35, LR=2.14e-04

Step 2100: Loss=2.2665, PPL=9.65, LR=2.14e-04

Step 2200: Loss=2.1313, PPL=8.43, LR=2.14e-04

Step 2300: Loss=2.1978, PPL=9.01, LR=2.13e-04

Step 2400: Loss=2.2078, PPL=9.10, LR=2.13e-04

Step 2500: Loss=2.0437, PPL=7.72, LR=2.13e-04

Step 2600: Loss=2.0514, PPL=7.78, LR=2.13e-04

Step 2700: Loss=2.2503, PPL=9.49, LR=2.12e-04

Step 2800: Loss=2.0640, PPL=7.88, LR=2.12e-04

Step 2900: Loss=2.0381, PPL=7.68, LR=2.12e-04

Step 3000: Loss=2.0360, PPL=7.66, LR=2.12e-04

Step 3100: Loss=2.0644, PPL=7.88, LR=2.11e-04

Epoch 14 结果:
  训练损失: 2.0569, 困惑度: 7.82
  验证损失: 2.3283, 困惑度: 10.26
  验证损失未改善 (patience: 4/5)
  当前: 2.3283, 最佳: 2.3222, 差距: 0.0061

==================================================
Epoch 15/50
==================================================

Step 0: Loss=1.8698, PPL=6.49, LR=2.11e-04

Step 100: Loss=1.9356, PPL=6.93, LR=2.11e-04

Step 200: Loss=1.9500, PPL=7.03, LR=2.11e-04

Step 300: Loss=1.9990, PPL=7.38, LR=2.11e-04

Step 400: Loss=1.8766, PPL=6.53, LR=2.10e-04

Step 500: Loss=1.8937, PPL=6.64, LR=2.10e-04

Step 600: Loss=1.8155, PPL=6.14, LR=2.10e-04

Step 700: Loss=2.0081, PPL=7.45, LR=2.10e-04

Step 800: Loss=1.9620, PPL=7.11, LR=2.09e-04

Step 900: Loss=2.1624, PPL=8.69, LR=2.09e-04

Step 1000: Loss=2.0522, PPL=7.79, LR=2.09e-04

Step 1100: Loss=2.1040, PPL=8.20, LR=2.09e-04

Step 1200: Loss=2.0367, PPL=7.67, LR=2.08e-04

Step 1300: Loss=1.8181, PPL=6.16, LR=2.08e-04

Step 1400: Loss=2.0023, PPL=7.41, LR=2.08e-04

Step 1500: Loss=1.9598, PPL=7.10, LR=2.08e-04

Step 1600: Loss=1.9876, PPL=7.30, LR=2.08e-04

Step 1700: Loss=1.9430, PPL=6.98, LR=2.07e-04

Step 1800: Loss=2.0324, PPL=7.63, LR=2.07e-04

Step 1900: Loss=2.0334, PPL=7.64, LR=2.07e-04

Step 2000: Loss=1.9463, PPL=7.00, LR=2.07e-04

Step 2100: Loss=1.9435, PPL=6.98, LR=2.06e-04

Step 2200: Loss=2.0561, PPL=7.82, LR=2.06e-04

Step 2300: Loss=1.8769, PPL=6.53, LR=2.06e-04

Step 2400: Loss=2.0258, PPL=7.58, LR=2.06e-04

Step 2500: Loss=2.0659, PPL=7.89, LR=2.05e-04

Step 2600: Loss=1.7890, PPL=5.98, LR=2.05e-04

Step 2700: Loss=2.0745, PPL=7.96, LR=2.05e-04

Step 2800: Loss=2.0739, PPL=7.96, LR=2.05e-04

Step 2900: Loss=2.0776, PPL=7.99, LR=2.05e-04

Step 3000: Loss=1.9322, PPL=6.90, LR=2.04e-04

Step 3100: Loss=2.1376, PPL=8.48, LR=2.04e-04

Epoch 15 结果:
  训练损失: 2.0165, 困惑度: 7.51
  验证损失: 2.3306, 困惑度: 10.28
  验证BLEU: 0.0365 (3.65%)
  验证损失未改善 (patience: 5/5)
  当前: 2.3306, 最佳: 2.3222, 差距: 0.0084
检查点已保存: runs/20251108_174239/checkpoints/best_model_bleu.pt
  ✓ 保存最佳BLEU模型 (BLEU: 0.0365)

==================================================
早停触发！验证损失在 5 个epoch内未改善
当前验证损失: 2.3306
最佳验证损失: 2.3222 (epoch 10)
最佳验证BLEU: 0.0365
==================================================
训练曲线已保存: runs/20251108_174239/figures/training_curves_final.png

============================================================
训练结束时间: 2025-11-08 19:31:00
============================================================
