
============================================================
训练开始时间: 2025-11-08 17:49:43
============================================================

==================================================
运行名称: 20251108_174942
加载数据...
加载训练数据...
训练数据量: 206112，限制为: 200000
训练集大小: 200000
构建词汇表...
源语言词汇表大小: 20000
目标语言词汇表大小: 20000
加载验证数据...
验证集大小: 888
==================================================
创建模型...
模型参数统计:
  可训练参数: 74,880,544
  总参数: 74,880,544
  模型大小: 286.43 MB
==================================================
开始训练...

==================================================
Epoch 1/50
==================================================

Step 0: Loss=9.9282, PPL=20500.27, LR=6.18e-08

Step 100: Loss=9.4200, PPL=12332.78, LR=6.24e-06

Step 200: Loss=8.7931, PPL=6588.56, LR=1.24e-05

Step 300: Loss=7.9966, PPL=2970.97, LR=1.86e-05

Step 400: Loss=7.1577, PPL=1283.94, LR=2.48e-05

Step 500: Loss=6.6927, PPL=806.51, LR=3.09e-05

Step 600: Loss=6.2959, PPL=542.32, LR=3.71e-05

Step 700: Loss=6.2693, PPL=528.13, LR=4.33e-05

Step 800: Loss=6.2403, PPL=513.00, LR=4.95e-05

Step 900: Loss=6.2451, PPL=515.48, LR=5.56e-05

Step 1000: Loss=6.1311, PPL=459.92, LR=6.18e-05

Step 1100: Loss=6.0523, PPL=425.09, LR=6.80e-05

Step 1200: Loss=6.0376, PPL=418.89, LR=7.42e-05

Step 1300: Loss=5.9075, PPL=367.79, LR=8.04e-05

Step 1400: Loss=5.9032, PPL=366.22, LR=8.65e-05

Step 1500: Loss=5.7629, PPL=318.27, LR=9.27e-05

Step 1600: Loss=5.7077, PPL=301.18, LR=9.89e-05

Step 1700: Loss=5.6141, PPL=274.26, LR=1.05e-04

Step 1800: Loss=5.7045, PPL=300.23, LR=1.11e-04

Step 1900: Loss=5.6058, PPL=271.99, LR=1.17e-04

Step 2000: Loss=5.3918, PPL=219.59, LR=1.24e-04

Step 2100: Loss=5.5293, PPL=251.98, LR=1.30e-04

Step 2200: Loss=5.4402, PPL=230.48, LR=1.36e-04

Step 2300: Loss=5.2511, PPL=190.78, LR=1.42e-04

Step 2400: Loss=5.3650, PPL=213.79, LR=1.48e-04

Step 2500: Loss=5.2217, PPL=185.26, LR=1.54e-04

Step 2600: Loss=4.9866, PPL=146.44, LR=1.61e-04

Step 2700: Loss=5.1180, PPL=167.00, LR=1.67e-04

Step 2800: Loss=5.0428, PPL=154.90, LR=1.73e-04

Step 2900: Loss=4.9586, PPL=142.39, LR=1.79e-04

Step 3000: Loss=5.0081, PPL=149.63, LR=1.85e-04

Step 3100: Loss=4.7698, PPL=117.89, LR=1.92e-04

Epoch 1 结果:
  训练损失: 6.0560, 困惑度: 426.65
  验证损失: 4.7523, 困惑度: 115.85
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 4.7523)

==================================================
Epoch 2/50
==================================================

Step 0: Loss=4.9235, PPL=137.48, LR=1.93e-04

Step 100: Loss=4.7313, PPL=113.44, LR=1.99e-04

Step 200: Loss=4.8706, PPL=130.40, LR=2.05e-04

Step 300: Loss=4.5202, PPL=91.85, LR=2.12e-04

Step 400: Loss=4.7625, PPL=117.04, LR=2.18e-04

Step 500: Loss=4.8487, PPL=127.58, LR=2.24e-04

Step 600: Loss=4.6915, PPL=109.01, LR=2.30e-04

Step 700: Loss=4.5947, PPL=98.96, LR=2.36e-04

Step 800: Loss=4.5950, PPL=98.99, LR=2.42e-04

Step 900: Loss=4.5571, PPL=95.30, LR=2.49e-04

Step 1000: Loss=4.6572, PPL=105.34, LR=2.55e-04

Step 1100: Loss=4.6297, PPL=102.49, LR=2.61e-04

Step 1200: Loss=4.4968, PPL=89.73, LR=2.67e-04

Step 1300: Loss=4.2994, PPL=73.66, LR=2.73e-04

Step 1400: Loss=4.5181, PPL=91.66, LR=2.80e-04

Step 1500: Loss=4.3474, PPL=77.28, LR=2.86e-04

Step 1600: Loss=4.2745, PPL=71.84, LR=2.92e-04

Step 1700: Loss=4.2610, PPL=70.88, LR=2.98e-04

Step 1800: Loss=4.1934, PPL=66.25, LR=3.04e-04

Step 1900: Loss=4.4684, PPL=87.22, LR=3.10e-04

Step 2000: Loss=4.2935, PPL=73.22, LR=3.17e-04

Step 2100: Loss=4.3339, PPL=76.24, LR=3.23e-04

Step 2200: Loss=4.1416, PPL=62.90, LR=3.29e-04

Step 2300: Loss=4.0424, PPL=56.96, LR=3.35e-04

Step 2400: Loss=4.2996, PPL=73.67, LR=3.41e-04

Step 2500: Loss=4.1785, PPL=65.27, LR=3.47e-04

Step 2600: Loss=4.0417, PPL=56.92, LR=3.54e-04

Step 2700: Loss=3.9911, PPL=54.11, LR=3.60e-04

Step 2800: Loss=4.0955, PPL=60.07, LR=3.66e-04

Step 2900: Loss=4.1841, PPL=65.63, LR=3.72e-04

Step 3000: Loss=4.1741, PPL=64.98, LR=3.78e-04

Step 3100: Loss=3.9163, PPL=50.21, LR=3.85e-04

Epoch 2 结果:
  训练损失: 4.3824, 困惑度: 80.03
  验证损失: 3.7390, 困惑度: 42.06
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 3.7390)

==================================================
Epoch 3/50
==================================================

Step 0: Loss=3.7515, PPL=42.59, LR=3.86e-04

Step 100: Loss=4.0438, PPL=57.05, LR=3.92e-04

Step 200: Loss=3.6596, PPL=38.85, LR=3.98e-04

Step 300: Loss=3.9653, PPL=52.74, LR=4.05e-04

Step 400: Loss=4.0920, PPL=59.86, LR=4.11e-04

Step 500: Loss=3.7303, PPL=41.69, LR=4.17e-04

Step 600: Loss=3.7791, PPL=43.78, LR=4.23e-04

Step 700: Loss=3.9765, PPL=53.33, LR=4.29e-04

Step 800: Loss=3.9276, PPL=50.79, LR=4.35e-04

Step 900: Loss=3.9067, PPL=49.74, LR=4.42e-04

Step 1000: Loss=3.7455, PPL=42.33, LR=4.48e-04

Step 1100: Loss=3.6027, PPL=36.70, LR=4.54e-04

Step 1200: Loss=3.7007, PPL=40.48, LR=4.60e-04

Step 1300: Loss=3.6375, PPL=38.00, LR=4.66e-04

Step 1400: Loss=3.7498, PPL=42.51, LR=4.73e-04

Step 1500: Loss=3.5123, PPL=33.53, LR=4.79e-04

Step 1600: Loss=3.7158, PPL=41.09, LR=4.85e-04

Step 1700: Loss=3.8004, PPL=44.72, LR=4.91e-04

Step 1800: Loss=3.3798, PPL=29.36, LR=4.93e-04

Step 1900: Loss=3.6443, PPL=38.26, LR=4.90e-04

Step 2000: Loss=3.6194, PPL=37.32, LR=4.87e-04

Step 2100: Loss=3.6514, PPL=38.53, LR=4.84e-04

Step 2200: Loss=3.7176, PPL=41.17, LR=4.81e-04

Step 2300: Loss=3.5016, PPL=33.17, LR=4.78e-04

Step 2400: Loss=3.7221, PPL=41.35, LR=4.75e-04

Step 2500: Loss=3.3299, PPL=27.94, LR=4.72e-04

Step 2600: Loss=3.4310, PPL=30.91, LR=4.70e-04

Step 2700: Loss=3.7240, PPL=41.43, LR=4.67e-04

Step 2800: Loss=3.5276, PPL=34.04, LR=4.65e-04

Step 2900: Loss=3.4447, PPL=31.33, LR=4.62e-04

Step 3000: Loss=3.4917, PPL=32.84, LR=4.59e-04

Step 3100: Loss=3.4376, PPL=31.11, LR=4.57e-04

Epoch 3 结果:
  训练损失: 3.7121, 困惑度: 40.94
  验证损失: 3.1806, 困惑度: 24.06
  验证BLEU: 0.0150 (1.50%)
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 3.1806)

==================================================
Epoch 4/50
==================================================

Step 0: Loss=3.3493, PPL=28.48, LR=4.56e-04

Step 100: Loss=3.2559, PPL=25.94, LR=4.54e-04

Step 200: Loss=3.4589, PPL=31.78, LR=4.52e-04

Step 300: Loss=3.6633, PPL=38.99, LR=4.49e-04

Step 400: Loss=3.4126, PPL=30.35, LR=4.47e-04

Step 500: Loss=3.2698, PPL=26.31, LR=4.45e-04

Step 600: Loss=3.4522, PPL=31.57, LR=4.42e-04

Step 700: Loss=3.1961, PPL=24.44, LR=4.40e-04

Step 800: Loss=3.5772, PPL=35.77, LR=4.38e-04

Step 900: Loss=3.5582, PPL=35.10, LR=4.36e-04

Step 1000: Loss=3.3297, PPL=27.93, LR=4.34e-04

Step 1100: Loss=3.1334, PPL=22.95, LR=4.32e-04

Step 1200: Loss=3.2410, PPL=25.56, LR=4.30e-04

Step 1300: Loss=3.2755, PPL=26.46, LR=4.28e-04

Step 1400: Loss=3.2770, PPL=26.50, LR=4.26e-04

Step 1500: Loss=3.2973, PPL=27.04, LR=4.24e-04

Step 1600: Loss=3.2988, PPL=27.08, LR=4.22e-04

Step 1700: Loss=3.2625, PPL=26.12, LR=4.20e-04

Step 1800: Loss=3.2755, PPL=26.46, LR=4.18e-04

Step 1900: Loss=3.2715, PPL=26.35, LR=4.16e-04

Step 2000: Loss=3.0563, PPL=21.25, LR=4.14e-04

Step 2100: Loss=3.4372, PPL=31.10, LR=4.13e-04

Step 2200: Loss=3.2934, PPL=26.93, LR=4.11e-04

Step 2300: Loss=3.1720, PPL=23.85, LR=4.09e-04

Step 2400: Loss=3.3633, PPL=28.88, LR=4.07e-04

Step 2500: Loss=3.3966, PPL=29.86, LR=4.06e-04

Step 2600: Loss=3.4380, PPL=31.12, LR=4.04e-04

Step 2700: Loss=3.1716, PPL=23.84, LR=4.02e-04

Step 2800: Loss=3.2279, PPL=25.23, LR=4.01e-04

Step 2900: Loss=3.2032, PPL=24.61, LR=3.99e-04

Step 3000: Loss=3.1280, PPL=22.83, LR=3.97e-04

Step 3100: Loss=3.0828, PPL=21.82, LR=3.96e-04

Epoch 4 结果:
  训练损失: 3.2872, 困惑度: 26.77
  验证损失: 2.8595, 困惑度: 17.45
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.8595)

==================================================
Epoch 5/50
==================================================

Step 0: Loss=3.2136, PPL=24.87, LR=3.95e-04

Step 100: Loss=3.0391, PPL=20.89, LR=3.94e-04

Step 200: Loss=3.0993, PPL=22.18, LR=3.92e-04

Step 300: Loss=2.9860, PPL=19.81, LR=3.91e-04

Step 400: Loss=3.2109, PPL=24.80, LR=3.89e-04

Step 500: Loss=3.0258, PPL=20.61, LR=3.88e-04

Step 600: Loss=2.8296, PPL=16.94, LR=3.86e-04

Step 700: Loss=2.8422, PPL=17.15, LR=3.85e-04

Step 800: Loss=3.0061, PPL=20.21, LR=3.83e-04

Step 900: Loss=3.0349, PPL=20.80, LR=3.82e-04

Step 1000: Loss=3.1486, PPL=23.30, LR=3.80e-04

Step 1100: Loss=3.3908, PPL=29.69, LR=3.79e-04

Step 1200: Loss=2.8065, PPL=16.55, LR=3.78e-04

Step 1300: Loss=3.1170, PPL=22.58, LR=3.76e-04

Step 1400: Loss=3.1997, PPL=24.53, LR=3.75e-04

Step 1500: Loss=2.9942, PPL=19.97, LR=3.73e-04

Step 1600: Loss=3.2562, PPL=25.95, LR=3.72e-04

Step 1700: Loss=2.9535, PPL=19.17, LR=3.71e-04

Step 1800: Loss=2.8979, PPL=18.14, LR=3.70e-04

Step 1900: Loss=2.8821, PPL=17.85, LR=3.68e-04

Step 2000: Loss=3.2504, PPL=25.80, LR=3.67e-04

Step 2100: Loss=2.8764, PPL=17.75, LR=3.66e-04

Step 2200: Loss=3.1064, PPL=22.34, LR=3.64e-04

Step 2300: Loss=2.9642, PPL=19.38, LR=3.63e-04

Step 2400: Loss=2.9724, PPL=19.54, LR=3.62e-04

Step 2500: Loss=3.0456, PPL=21.02, LR=3.61e-04

Step 2600: Loss=3.1235, PPL=22.73, LR=3.60e-04

Step 2700: Loss=2.8973, PPL=18.13, LR=3.58e-04

Step 2800: Loss=3.0174, PPL=20.44, LR=3.57e-04

Step 2900: Loss=2.9736, PPL=19.56, LR=3.56e-04

Step 3000: Loss=2.9672, PPL=19.44, LR=3.55e-04

Step 3100: Loss=3.1368, PPL=23.03, LR=3.54e-04

Epoch 5 结果:
  训练损失: 3.0243, 困惑度: 20.58
  验证损失: 2.6705, 困惑度: 14.45
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.6705)
检查点已保存: runs/20251108_174942/checkpoints/checkpoint_epoch_5.pt
训练曲线已保存: runs/20251108_174942/figures/training_curves.png

==================================================
Epoch 6/50
==================================================

Step 0: Loss=3.0303, PPL=20.70, LR=3.54e-04

Step 100: Loss=2.5682, PPL=13.04, LR=3.52e-04

Step 200: Loss=2.8837, PPL=17.88, LR=3.51e-04

Step 300: Loss=2.8060, PPL=16.54, LR=3.50e-04

Step 400: Loss=2.9739, PPL=19.57, LR=3.49e-04

Step 500: Loss=2.8103, PPL=16.62, LR=3.48e-04

Step 600: Loss=2.6994, PPL=14.87, LR=3.47e-04

Step 700: Loss=2.7366, PPL=15.43, LR=3.46e-04

Step 800: Loss=2.8377, PPL=17.08, LR=3.45e-04

Step 900: Loss=3.0108, PPL=20.30, LR=3.44e-04

Step 1000: Loss=2.8856, PPL=17.91, LR=3.43e-04

Step 1100: Loss=2.9197, PPL=18.53, LR=3.42e-04

Step 1200: Loss=2.7425, PPL=15.53, LR=3.41e-04

Step 1300: Loss=2.7658, PPL=15.89, LR=3.40e-04

Step 1400: Loss=2.9176, PPL=18.50, LR=3.39e-04

Step 1500: Loss=2.8166, PPL=16.72, LR=3.38e-04

Step 1600: Loss=2.8764, PPL=17.75, LR=3.37e-04

Step 1700: Loss=2.8761, PPL=17.74, LR=3.36e-04

Step 1800: Loss=2.9123, PPL=18.40, LR=3.35e-04

Step 1900: Loss=2.9327, PPL=18.78, LR=3.34e-04

Step 2000: Loss=2.8566, PPL=17.40, LR=3.33e-04

Step 2100: Loss=3.0221, PPL=20.53, LR=3.32e-04

Step 2200: Loss=2.6679, PPL=14.41, LR=3.31e-04

Step 2300: Loss=2.9046, PPL=18.26, LR=3.30e-04

Step 2400: Loss=2.8457, PPL=17.21, LR=3.29e-04

Step 2500: Loss=2.9116, PPL=18.39, LR=3.28e-04

Step 2600: Loss=2.7738, PPL=16.02, LR=3.27e-04

Step 2700: Loss=2.8632, PPL=17.52, LR=3.26e-04

Step 2800: Loss=2.8315, PPL=16.97, LR=3.26e-04

Step 2900: Loss=2.9146, PPL=18.44, LR=3.25e-04

Step 3000: Loss=2.9649, PPL=19.39, LR=3.24e-04

Step 3100: Loss=2.9863, PPL=19.81, LR=3.23e-04

Epoch 6 结果:
  训练损失: 2.8549, 困惑度: 17.37
  验证损失: 2.5604, 困惑度: 12.94
  验证BLEU: 0.0280 (2.80%)
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.5604)

==================================================
Epoch 7/50
==================================================

Step 0: Loss=2.5622, PPL=12.96, LR=3.23e-04

Step 100: Loss=2.6524, PPL=14.19, LR=3.22e-04

Step 200: Loss=2.5733, PPL=13.11, LR=3.21e-04

Step 300: Loss=2.6494, PPL=14.15, LR=3.20e-04

Step 400: Loss=2.6251, PPL=13.81, LR=3.19e-04

Step 500: Loss=2.6300, PPL=13.87, LR=3.19e-04

Step 600: Loss=2.5610, PPL=12.95, LR=3.18e-04

Step 700: Loss=2.7682, PPL=15.93, LR=3.17e-04

Step 800: Loss=2.8158, PPL=16.71, LR=3.16e-04

Step 900: Loss=2.4954, PPL=12.13, LR=3.15e-04

Step 1000: Loss=2.7801, PPL=16.12, LR=3.14e-04

Step 1100: Loss=2.6435, PPL=14.06, LR=3.14e-04

Step 1200: Loss=2.6058, PPL=13.54, LR=3.13e-04

Step 1300: Loss=2.8529, PPL=17.34, LR=3.12e-04

Step 1400: Loss=2.5390, PPL=12.67, LR=3.11e-04

Step 1500: Loss=2.7556, PPL=15.73, LR=3.11e-04

Step 1600: Loss=2.6662, PPL=14.39, LR=3.10e-04

Step 1700: Loss=2.8149, PPL=16.69, LR=3.09e-04

Step 1800: Loss=2.6382, PPL=13.99, LR=3.08e-04

Step 1900: Loss=2.8667, PPL=17.58, LR=3.08e-04

Step 2000: Loss=2.9335, PPL=18.79, LR=3.07e-04

Step 2100: Loss=2.6843, PPL=14.65, LR=3.06e-04

Step 2200: Loss=2.8095, PPL=16.60, LR=3.05e-04

Step 2300: Loss=2.6482, PPL=14.13, LR=3.05e-04

Step 2400: Loss=2.6326, PPL=13.91, LR=3.04e-04

Step 2500: Loss=2.4626, PPL=11.73, LR=3.03e-04

Step 2600: Loss=2.8154, PPL=16.70, LR=3.02e-04

Step 2700: Loss=2.7259, PPL=15.27, LR=3.02e-04

Step 2800: Loss=2.6252, PPL=13.81, LR=3.01e-04

Step 2900: Loss=2.6193, PPL=13.73, LR=3.00e-04

Step 3000: Loss=2.8383, PPL=17.09, LR=3.00e-04

Step 3100: Loss=2.6269, PPL=13.83, LR=2.99e-04

Epoch 7 结果:
  训练损失: 2.7306, 困惑度: 15.34
  验证损失: 2.5010, 困惑度: 12.19
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.5010)

==================================================
Epoch 8/50
==================================================

Step 0: Loss=2.5612, PPL=12.95, LR=2.99e-04

Step 100: Loss=2.7740, PPL=16.02, LR=2.98e-04

Step 200: Loss=2.4995, PPL=12.18, LR=2.97e-04

Step 300: Loss=2.4049, PPL=11.08, LR=2.97e-04

Step 400: Loss=2.6264, PPL=13.82, LR=2.96e-04

Step 500: Loss=2.6266, PPL=13.83, LR=2.95e-04

Step 600: Loss=2.5705, PPL=13.07, LR=2.95e-04

Step 700: Loss=2.7796, PPL=16.11, LR=2.94e-04

Step 800: Loss=2.5799, PPL=13.20, LR=2.93e-04

Step 900: Loss=2.5794, PPL=13.19, LR=2.93e-04

Step 1000: Loss=2.7608, PPL=15.81, LR=2.92e-04

Step 1100: Loss=2.7651, PPL=15.88, LR=2.92e-04

Step 1200: Loss=2.4550, PPL=11.65, LR=2.91e-04

Step 1300: Loss=2.5109, PPL=12.32, LR=2.90e-04

Step 1400: Loss=2.6971, PPL=14.84, LR=2.90e-04

Step 1500: Loss=2.9157, PPL=18.46, LR=2.89e-04

Step 1600: Loss=2.3855, PPL=10.86, LR=2.88e-04

Step 1700: Loss=2.8210, PPL=16.79, LR=2.88e-04

Step 1800: Loss=2.4740, PPL=11.87, LR=2.87e-04

Step 1900: Loss=2.5928, PPL=13.37, LR=2.87e-04

Step 2000: Loss=2.6798, PPL=14.58, LR=2.86e-04

Step 2100: Loss=2.6612, PPL=14.31, LR=2.85e-04

Step 2200: Loss=2.7298, PPL=15.33, LR=2.85e-04

Step 2300: Loss=2.6868, PPL=14.68, LR=2.84e-04

Step 2400: Loss=2.8486, PPL=17.26, LR=2.84e-04

Step 2500: Loss=2.8304, PPL=16.95, LR=2.83e-04

Step 2600: Loss=2.7763, PPL=16.06, LR=2.82e-04

Step 2700: Loss=2.6588, PPL=14.28, LR=2.82e-04

Step 2800: Loss=2.5189, PPL=12.42, LR=2.81e-04

Step 2900: Loss=2.6300, PPL=13.87, LR=2.81e-04

Step 3000: Loss=2.6790, PPL=14.57, LR=2.80e-04

Step 3100: Loss=2.7371, PPL=15.44, LR=2.80e-04

Epoch 8 结果:
  训练损失: 2.6354, 困惑度: 13.95
  验证损失: 2.4498, 困惑度: 11.59
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.4498)

==================================================
Epoch 9/50
==================================================

Step 0: Loss=2.3731, PPL=10.73, LR=2.80e-04

Step 100: Loss=2.3128, PPL=10.10, LR=2.79e-04

Step 200: Loss=2.4215, PPL=11.26, LR=2.78e-04

Step 300: Loss=2.6638, PPL=14.35, LR=2.78e-04

Step 400: Loss=2.4463, PPL=11.55, LR=2.77e-04

Step 500: Loss=2.5721, PPL=13.09, LR=2.77e-04

Step 600: Loss=2.5168, PPL=12.39, LR=2.76e-04

Step 700: Loss=2.5171, PPL=12.39, LR=2.76e-04

Step 800: Loss=2.4826, PPL=11.97, LR=2.75e-04

Step 900: Loss=2.4665, PPL=11.78, LR=2.75e-04

Step 1000: Loss=2.5369, PPL=12.64, LR=2.74e-04

Step 1100: Loss=2.5034, PPL=12.22, LR=2.74e-04

Step 1200: Loss=2.4652, PPL=11.77, LR=2.73e-04

Step 1300: Loss=2.4782, PPL=11.92, LR=2.73e-04

Step 1400: Loss=2.6164, PPL=13.69, LR=2.72e-04

Step 1500: Loss=2.4053, PPL=11.08, LR=2.71e-04

Step 1600: Loss=2.6233, PPL=13.78, LR=2.71e-04

Step 1700: Loss=2.4817, PPL=11.96, LR=2.70e-04

Step 1800: Loss=2.4590, PPL=11.69, LR=2.70e-04

Step 1900: Loss=2.5988, PPL=13.45, LR=2.69e-04

Step 2000: Loss=2.4769, PPL=11.90, LR=2.69e-04

Step 2100: Loss=2.4471, PPL=11.55, LR=2.68e-04

Step 2200: Loss=2.4688, PPL=11.81, LR=2.68e-04

Step 2300: Loss=2.6707, PPL=14.45, LR=2.67e-04

Step 2400: Loss=2.7425, PPL=15.53, LR=2.67e-04

Step 2500: Loss=2.4654, PPL=11.77, LR=2.66e-04

Step 2600: Loss=2.6412, PPL=14.03, LR=2.66e-04

Step 2700: Loss=2.6004, PPL=13.47, LR=2.66e-04

Step 2800: Loss=2.5049, PPL=12.24, LR=2.65e-04

Step 2900: Loss=2.5616, PPL=12.96, LR=2.65e-04

Step 3000: Loss=2.4576, PPL=11.68, LR=2.64e-04

Step 3100: Loss=2.5894, PPL=13.32, LR=2.64e-04

Epoch 9 结果:
  训练损失: 2.5576, 困惑度: 12.91
  验证损失: 2.4097, 困惑度: 11.13
  验证BLEU: 0.0291 (2.91%)
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.4097)

==================================================
Epoch 10/50
==================================================

Step 0: Loss=2.4985, PPL=12.16, LR=2.64e-04

Step 100: Loss=2.2977, PPL=9.95, LR=2.63e-04

Step 200: Loss=2.4634, PPL=11.74, LR=2.63e-04

Step 300: Loss=2.2168, PPL=9.18, LR=2.62e-04

Step 400: Loss=2.5371, PPL=12.64, LR=2.62e-04

Step 500: Loss=2.3681, PPL=10.68, LR=2.61e-04

Step 600: Loss=2.4128, PPL=11.17, LR=2.61e-04

Step 700: Loss=2.4443, PPL=11.52, LR=2.60e-04

Step 800: Loss=2.4750, PPL=11.88, LR=2.60e-04

Step 900: Loss=2.4051, PPL=11.08, LR=2.59e-04

Step 1000: Loss=2.5374, PPL=12.65, LR=2.59e-04

Step 1100: Loss=2.6233, PPL=13.78, LR=2.59e-04

Step 1200: Loss=2.4039, PPL=11.07, LR=2.58e-04

Step 1300: Loss=2.4766, PPL=11.90, LR=2.58e-04

Step 1400: Loss=2.5209, PPL=12.44, LR=2.57e-04

Step 1500: Loss=2.5464, PPL=12.76, LR=2.57e-04

Step 1600: Loss=2.5533, PPL=12.85, LR=2.56e-04

Step 1700: Loss=2.6093, PPL=13.59, LR=2.56e-04

Step 1800: Loss=2.3165, PPL=10.14, LR=2.55e-04

Step 1900: Loss=2.3875, PPL=10.89, LR=2.55e-04

Step 2000: Loss=2.8486, PPL=17.26, LR=2.55e-04

Step 2100: Loss=2.7380, PPL=15.46, LR=2.54e-04

Step 2200: Loss=2.5930, PPL=13.37, LR=2.54e-04

Step 2300: Loss=2.3863, PPL=10.87, LR=2.53e-04

Step 2400: Loss=2.5370, PPL=12.64, LR=2.53e-04

Step 2500: Loss=2.4547, PPL=11.64, LR=2.53e-04

Step 2600: Loss=2.3418, PPL=10.40, LR=2.52e-04

Step 2700: Loss=2.7744, PPL=16.03, LR=2.52e-04

Step 2800: Loss=2.2368, PPL=9.36, LR=2.51e-04

Step 2900: Loss=2.4615, PPL=11.72, LR=2.51e-04

Step 3000: Loss=2.4804, PPL=11.95, LR=2.50e-04

Step 3100: Loss=2.8459, PPL=17.22, LR=2.50e-04

Epoch 10 结果:
  训练损失: 2.4915, 困惑度: 12.08
  验证损失: 2.3955, 困惑度: 10.97
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.3955)
检查点已保存: runs/20251108_174942/checkpoints/checkpoint_epoch_10.pt
训练曲线已保存: runs/20251108_174942/figures/training_curves.png

==================================================
Epoch 11/50
==================================================

Step 0: Loss=2.3679, PPL=10.67, LR=2.50e-04

Step 100: Loss=2.1861, PPL=8.90, LR=2.50e-04

Step 200: Loss=2.5237, PPL=12.47, LR=2.49e-04

Step 300: Loss=2.2550, PPL=9.54, LR=2.49e-04

Step 400: Loss=2.4855, PPL=12.01, LR=2.48e-04

Step 500: Loss=2.4135, PPL=11.17, LR=2.48e-04

Step 600: Loss=2.3436, PPL=10.42, LR=2.48e-04

Step 700: Loss=2.3536, PPL=10.52, LR=2.47e-04

Step 800: Loss=2.3783, PPL=10.79, LR=2.47e-04

Step 900: Loss=2.5016, PPL=12.20, LR=2.46e-04

Step 1000: Loss=2.4658, PPL=11.77, LR=2.46e-04

Step 1100: Loss=2.4044, PPL=11.07, LR=2.46e-04

Step 1200: Loss=2.6264, PPL=13.82, LR=2.45e-04

Step 1300: Loss=2.6549, PPL=14.22, LR=2.45e-04

Step 1400: Loss=2.3022, PPL=10.00, LR=2.45e-04

Step 1500: Loss=2.3541, PPL=10.53, LR=2.44e-04

Step 1600: Loss=2.4511, PPL=11.60, LR=2.44e-04

Step 1700: Loss=2.4191, PPL=11.24, LR=2.43e-04

Step 1800: Loss=2.5535, PPL=12.85, LR=2.43e-04

Step 1900: Loss=2.4857, PPL=12.01, LR=2.43e-04

Step 2000: Loss=2.5197, PPL=12.42, LR=2.42e-04

Step 2100: Loss=2.5330, PPL=12.59, LR=2.42e-04

Step 2200: Loss=2.5427, PPL=12.71, LR=2.42e-04

Step 2300: Loss=2.4922, PPL=12.09, LR=2.41e-04

Step 2400: Loss=2.3798, PPL=10.80, LR=2.41e-04

Step 2500: Loss=2.7014, PPL=14.90, LR=2.41e-04

Step 2600: Loss=2.3562, PPL=10.55, LR=2.40e-04

Step 2700: Loss=2.2486, PPL=9.47, LR=2.40e-04

Step 2800: Loss=2.4245, PPL=11.30, LR=2.39e-04

Step 2900: Loss=2.5914, PPL=13.35, LR=2.39e-04

Step 3000: Loss=2.4173, PPL=11.22, LR=2.39e-04

Step 3100: Loss=2.2695, PPL=9.67, LR=2.38e-04

Epoch 11 结果:
  训练损失: 2.4358, 困惑度: 11.42
  验证损失: 2.3591, 困惑度: 10.58
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.3591)

==================================================
Epoch 12/50
==================================================

Step 0: Loss=2.3086, PPL=10.06, LR=2.38e-04

Step 100: Loss=2.0652, PPL=7.89, LR=2.38e-04

Step 200: Loss=2.4023, PPL=11.05, LR=2.38e-04

Step 300: Loss=2.2710, PPL=9.69, LR=2.37e-04

Step 400: Loss=2.2212, PPL=9.22, LR=2.37e-04

Step 500: Loss=2.2107, PPL=9.12, LR=2.37e-04

Step 600: Loss=2.3285, PPL=10.26, LR=2.36e-04

Step 700: Loss=2.3699, PPL=10.70, LR=2.36e-04

Step 800: Loss=2.3994, PPL=11.02, LR=2.36e-04

Step 900: Loss=2.2625, PPL=9.61, LR=2.35e-04

Step 1000: Loss=2.4139, PPL=11.18, LR=2.35e-04

Step 1100: Loss=2.4440, PPL=11.52, LR=2.35e-04

Step 1200: Loss=2.4647, PPL=11.76, LR=2.34e-04

Step 1300: Loss=2.3271, PPL=10.25, LR=2.34e-04

Step 1400: Loss=2.4309, PPL=11.37, LR=2.34e-04

Step 1500: Loss=2.5427, PPL=12.71, LR=2.33e-04

Step 1600: Loss=2.4594, PPL=11.70, LR=2.33e-04

Step 1700: Loss=2.3962, PPL=10.98, LR=2.33e-04

Step 1800: Loss=2.4458, PPL=11.54, LR=2.32e-04

Step 1900: Loss=2.4474, PPL=11.56, LR=2.32e-04

Step 2000: Loss=2.4148, PPL=11.19, LR=2.32e-04

Step 2100: Loss=2.4459, PPL=11.54, LR=2.31e-04

Step 2200: Loss=2.3929, PPL=10.95, LR=2.31e-04

Step 2300: Loss=2.2605, PPL=9.59, LR=2.31e-04

Step 2400: Loss=2.2855, PPL=9.83, LR=2.30e-04

Step 2500: Loss=2.4719, PPL=11.85, LR=2.30e-04

Step 2600: Loss=2.4443, PPL=11.52, LR=2.30e-04

Step 2700: Loss=2.5343, PPL=12.61, LR=2.30e-04

Step 2800: Loss=2.6138, PPL=13.65, LR=2.29e-04

Step 2900: Loss=2.2765, PPL=9.74, LR=2.29e-04

Step 3000: Loss=2.4900, PPL=12.06, LR=2.29e-04

Step 3100: Loss=2.4891, PPL=12.05, LR=2.28e-04

Epoch 12 结果:
  训练损失: 2.3866, 困惑度: 10.88
  验证损失: 2.3385, 困惑度: 10.37
  验证BLEU: 0.0341 (3.41%)
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.3385)

==================================================
Epoch 13/50
==================================================

Step 0: Loss=2.2939, PPL=9.91, LR=2.28e-04

Step 100: Loss=2.3809, PPL=10.82, LR=2.28e-04

Step 200: Loss=2.2353, PPL=9.35, LR=2.28e-04

Step 300: Loss=2.1175, PPL=8.31, LR=2.27e-04

Step 400: Loss=2.2779, PPL=9.76, LR=2.27e-04

Step 500: Loss=2.0744, PPL=7.96, LR=2.27e-04

Step 600: Loss=2.2498, PPL=9.49, LR=2.26e-04

Step 700: Loss=2.3100, PPL=10.07, LR=2.26e-04

Step 800: Loss=2.2223, PPL=9.23, LR=2.26e-04

Step 900: Loss=2.3712, PPL=10.71, LR=2.26e-04

Step 1000: Loss=2.3479, PPL=10.46, LR=2.25e-04

Step 1100: Loss=2.3768, PPL=10.77, LR=2.25e-04

Step 1200: Loss=2.2579, PPL=9.56, LR=2.25e-04

Step 1300: Loss=2.2863, PPL=9.84, LR=2.24e-04

Step 1400: Loss=2.3315, PPL=10.29, LR=2.24e-04

Step 1500: Loss=2.4029, PPL=11.05, LR=2.24e-04

Step 1600: Loss=2.3132, PPL=10.11, LR=2.23e-04

Step 1700: Loss=2.3078, PPL=10.05, LR=2.23e-04

Step 1800: Loss=2.2441, PPL=9.43, LR=2.23e-04

Step 1900: Loss=2.2445, PPL=9.44, LR=2.23e-04

Step 2000: Loss=2.4581, PPL=11.68, LR=2.22e-04

Step 2100: Loss=2.3635, PPL=10.63, LR=2.22e-04

Step 2200: Loss=2.5225, PPL=12.46, LR=2.22e-04

Step 2300: Loss=2.2192, PPL=9.20, LR=2.22e-04

Step 2400: Loss=2.4249, PPL=11.30, LR=2.21e-04

Step 2500: Loss=2.4726, PPL=11.85, LR=2.21e-04

Step 2600: Loss=2.3270, PPL=10.25, LR=2.21e-04

Step 2700: Loss=2.4180, PPL=11.22, LR=2.20e-04

Step 2800: Loss=2.4347, PPL=11.41, LR=2.20e-04

Step 2900: Loss=2.3347, PPL=10.33, LR=2.20e-04

Step 3000: Loss=2.3842, PPL=10.85, LR=2.20e-04

Step 3100: Loss=2.5842, PPL=13.25, LR=2.19e-04

Epoch 13 结果:
  训练损失: 2.3432, 困惑度: 10.41
  验证损失: 2.3361, 困惑度: 10.34
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.3361)

==================================================
Epoch 14/50
==================================================

Step 0: Loss=2.2953, PPL=9.93, LR=2.19e-04

Step 100: Loss=2.1403, PPL=8.50, LR=2.19e-04

Step 200: Loss=2.0377, PPL=7.67, LR=2.19e-04

Step 300: Loss=2.1824, PPL=8.87, LR=2.18e-04

Step 400: Loss=2.3250, PPL=10.23, LR=2.18e-04

Step 500: Loss=2.1773, PPL=8.82, LR=2.18e-04

Step 600: Loss=2.2244, PPL=9.25, LR=2.18e-04

Step 700: Loss=2.2232, PPL=9.24, LR=2.17e-04

Step 800: Loss=2.2757, PPL=9.73, LR=2.17e-04

Step 900: Loss=2.3182, PPL=10.16, LR=2.17e-04

Step 1000: Loss=2.3742, PPL=10.74, LR=2.17e-04

Step 1100: Loss=2.3542, PPL=10.53, LR=2.16e-04

Step 1200: Loss=2.2037, PPL=9.06, LR=2.16e-04

Step 1300: Loss=2.3858, PPL=10.87, LR=2.16e-04

Step 1400: Loss=2.3229, PPL=10.21, LR=2.16e-04

Step 1500: Loss=2.2516, PPL=9.50, LR=2.15e-04

Step 1600: Loss=2.3481, PPL=10.47, LR=2.15e-04

Step 1700: Loss=2.4024, PPL=11.05, LR=2.15e-04

Step 1800: Loss=2.1600, PPL=8.67, LR=2.15e-04

Step 1900: Loss=2.1747, PPL=8.80, LR=2.14e-04

Step 2000: Loss=2.2293, PPL=9.29, LR=2.14e-04

Step 2100: Loss=2.1357, PPL=8.46, LR=2.14e-04

Step 2200: Loss=2.1874, PPL=8.91, LR=2.14e-04

Step 2300: Loss=2.3136, PPL=10.11, LR=2.13e-04

Step 2400: Loss=2.3421, PPL=10.40, LR=2.13e-04

Step 2500: Loss=2.1834, PPL=8.88, LR=2.13e-04

Step 2600: Loss=2.4528, PPL=11.62, LR=2.13e-04

Step 2700: Loss=2.4191, PPL=11.24, LR=2.12e-04

Step 2800: Loss=2.1611, PPL=8.68, LR=2.12e-04

Step 2900: Loss=2.0878, PPL=8.07, LR=2.12e-04

Step 3000: Loss=2.3558, PPL=10.55, LR=2.12e-04

Step 3100: Loss=2.3283, PPL=10.26, LR=2.11e-04

Epoch 14 结果:
  训练损失: 2.3042, 困惑度: 10.02
  验证损失: 2.3334, 困惑度: 10.31
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.3334)

==================================================
Epoch 15/50
==================================================

Step 0: Loss=2.1927, PPL=8.96, LR=2.11e-04

Step 100: Loss=2.3365, PPL=10.34, LR=2.11e-04

Step 200: Loss=2.3103, PPL=10.08, LR=2.11e-04

Step 300: Loss=2.2732, PPL=9.71, LR=2.11e-04

Step 400: Loss=2.1705, PPL=8.76, LR=2.10e-04

Step 500: Loss=2.0798, PPL=8.00, LR=2.10e-04

Step 600: Loss=2.1513, PPL=8.60, LR=2.10e-04

Step 700: Loss=2.2900, PPL=9.87, LR=2.10e-04

Step 800: Loss=2.3307, PPL=10.28, LR=2.09e-04

Step 900: Loss=2.1186, PPL=8.32, LR=2.09e-04

Step 1000: Loss=2.4304, PPL=11.36, LR=2.09e-04

Step 1100: Loss=2.0355, PPL=7.66, LR=2.09e-04

Step 1200: Loss=2.3432, PPL=10.41, LR=2.08e-04

Step 1300: Loss=2.2674, PPL=9.65, LR=2.08e-04

Step 1400: Loss=2.3599, PPL=10.59, LR=2.08e-04

Step 1500: Loss=2.3127, PPL=10.10, LR=2.08e-04

Step 1600: Loss=2.4160, PPL=11.20, LR=2.08e-04

Step 1700: Loss=2.3273, PPL=10.25, LR=2.07e-04

Step 1800: Loss=2.1529, PPL=8.61, LR=2.07e-04

Step 1900: Loss=2.3280, PPL=10.26, LR=2.07e-04

Step 2000: Loss=2.4907, PPL=12.07, LR=2.07e-04

Step 2100: Loss=2.2066, PPL=9.08, LR=2.06e-04

Step 2200: Loss=2.3318, PPL=10.30, LR=2.06e-04

Step 2300: Loss=2.2254, PPL=9.26, LR=2.06e-04

Step 2400: Loss=2.2337, PPL=9.33, LR=2.06e-04

Step 2500: Loss=2.4697, PPL=11.82, LR=2.05e-04

Step 2600: Loss=2.3683, PPL=10.68, LR=2.05e-04

Step 2700: Loss=2.0379, PPL=7.67, LR=2.05e-04

Step 2800: Loss=2.3083, PPL=10.06, LR=2.05e-04

Step 2900: Loss=2.3598, PPL=10.59, LR=2.05e-04

Step 3000: Loss=2.2712, PPL=9.69, LR=2.04e-04

Step 3100: Loss=2.2741, PPL=9.72, LR=2.04e-04

Epoch 15 结果:
  训练损失: 2.2708, 困惑度: 9.69
  验证损失: 2.3050, 困惑度: 10.02
  验证BLEU: 0.0375 (3.75%)
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.3050)
检查点已保存: runs/20251108_174942/checkpoints/checkpoint_epoch_15.pt
训练曲线已保存: runs/20251108_174942/figures/training_curves.png

==================================================
Epoch 16/50
==================================================

Step 0: Loss=2.0863, PPL=8.06, LR=2.04e-04

Step 100: Loss=1.9597, PPL=7.10, LR=2.04e-04

Step 200: Loss=2.0799, PPL=8.00, LR=2.04e-04

Step 300: Loss=2.2362, PPL=9.36, LR=2.03e-04

Step 400: Loss=2.1021, PPL=8.18, LR=2.03e-04

Step 500: Loss=2.0935, PPL=8.11, LR=2.03e-04

Step 600: Loss=2.2404, PPL=9.40, LR=2.03e-04

Step 700: Loss=2.3016, PPL=9.99, LR=2.03e-04

Step 800: Loss=2.1120, PPL=8.26, LR=2.02e-04

Step 900: Loss=2.1175, PPL=8.31, LR=2.02e-04

Step 1000: Loss=2.3522, PPL=10.51, LR=2.02e-04

Step 1100: Loss=2.4282, PPL=11.34, LR=2.02e-04

Step 1200: Loss=2.0826, PPL=8.03, LR=2.02e-04

Step 1300: Loss=2.2494, PPL=9.48, LR=2.01e-04

Step 1400: Loss=2.1764, PPL=8.81, LR=2.01e-04

Step 1500: Loss=2.5127, PPL=12.34, LR=2.01e-04

Step 1600: Loss=2.2784, PPL=9.76, LR=2.01e-04

Step 1700: Loss=2.3845, PPL=10.85, LR=2.01e-04

Step 1800: Loss=2.4012, PPL=11.04, LR=2.00e-04

Step 1900: Loss=2.1315, PPL=8.43, LR=2.00e-04

Step 2000: Loss=2.2387, PPL=9.38, LR=2.00e-04

Step 2100: Loss=2.2626, PPL=9.61, LR=2.00e-04

Step 2200: Loss=2.1181, PPL=8.32, LR=1.99e-04

Step 2300: Loss=2.4732, PPL=11.86, LR=1.99e-04

Step 2400: Loss=2.1283, PPL=8.40, LR=1.99e-04

Step 2500: Loss=2.0974, PPL=8.14, LR=1.99e-04

Step 2600: Loss=2.3992, PPL=11.01, LR=1.99e-04

Step 2700: Loss=2.2651, PPL=9.63, LR=1.98e-04

Step 2800: Loss=2.2413, PPL=9.41, LR=1.98e-04

Step 2900: Loss=2.4813, PPL=11.96, LR=1.98e-04

Step 3000: Loss=2.3724, PPL=10.72, LR=1.98e-04

Step 3100: Loss=2.3149, PPL=10.12, LR=1.98e-04

Epoch 16 结果:
  训练损失: 2.2379, 困惑度: 9.37
  验证损失: 2.2938, 困惑度: 9.91
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.2938)

==================================================
Epoch 17/50
==================================================

Step 0: Loss=2.3519, PPL=10.51, LR=1.98e-04

Step 100: Loss=2.1061, PPL=8.22, LR=1.97e-04

Step 200: Loss=2.1408, PPL=8.51, LR=1.97e-04

Step 300: Loss=2.0635, PPL=7.87, LR=1.97e-04

Step 400: Loss=2.2863, PPL=9.84, LR=1.97e-04

Step 500: Loss=2.2746, PPL=9.72, LR=1.97e-04

Step 600: Loss=1.9946, PPL=7.35, LR=1.96e-04

Step 700: Loss=2.1578, PPL=8.65, LR=1.96e-04

Step 800: Loss=2.2515, PPL=9.50, LR=1.96e-04

Step 900: Loss=2.4291, PPL=11.35, LR=1.96e-04

Step 1000: Loss=2.1612, PPL=8.68, LR=1.96e-04

Step 1100: Loss=2.3891, PPL=10.90, LR=1.96e-04

Step 1200: Loss=2.0523, PPL=7.79, LR=1.95e-04

Step 1300: Loss=2.0821, PPL=8.02, LR=1.95e-04

Step 1400: Loss=2.4283, PPL=11.34, LR=1.95e-04

Step 1500: Loss=2.2493, PPL=9.48, LR=1.95e-04

Step 1600: Loss=2.1215, PPL=8.34, LR=1.95e-04

Step 1700: Loss=2.3303, PPL=10.28, LR=1.94e-04

Step 1800: Loss=2.3095, PPL=10.07, LR=1.94e-04

Step 1900: Loss=2.2371, PPL=9.37, LR=1.94e-04

Step 2000: Loss=2.2315, PPL=9.31, LR=1.94e-04

Step 2100: Loss=2.2016, PPL=9.04, LR=1.94e-04

Step 2200: Loss=2.4489, PPL=11.58, LR=1.93e-04

Step 2300: Loss=2.4532, PPL=11.63, LR=1.93e-04

Step 2400: Loss=2.2231, PPL=9.24, LR=1.93e-04

Step 2500: Loss=2.1980, PPL=9.01, LR=1.93e-04

Step 2600: Loss=2.3064, PPL=10.04, LR=1.93e-04

Step 2700: Loss=2.2128, PPL=9.14, LR=1.93e-04

Step 2800: Loss=2.1636, PPL=8.70, LR=1.92e-04

Step 2900: Loss=2.1970, PPL=9.00, LR=1.92e-04

Step 3000: Loss=2.3325, PPL=10.30, LR=1.92e-04

Step 3100: Loss=2.3445, PPL=10.43, LR=1.92e-04

Epoch 17 结果:
  训练损失: 2.2077, 困惑度: 9.09
  验证损失: 2.2965, 困惑度: 9.94
  验证损失未改善 (patience: 1/5)
  当前: 2.2965, 最佳: 2.2938, 差距: 0.0027

==================================================
Epoch 18/50
==================================================

Step 0: Loss=1.9806, PPL=7.25, LR=1.92e-04

Step 100: Loss=2.0788, PPL=8.00, LR=1.92e-04

Step 200: Loss=2.1457, PPL=8.55, LR=1.91e-04

Step 300: Loss=2.2188, PPL=9.20, LR=1.91e-04

Step 400: Loss=2.1047, PPL=8.20, LR=1.91e-04

Step 500: Loss=2.4124, PPL=11.16, LR=1.91e-04

Step 600: Loss=1.9090, PPL=6.75, LR=1.91e-04

Step 700: Loss=2.3171, PPL=10.15, LR=1.90e-04

Step 800: Loss=2.2642, PPL=9.62, LR=1.90e-04

Step 900: Loss=2.1767, PPL=8.82, LR=1.90e-04

Step 1000: Loss=2.0766, PPL=7.98, LR=1.90e-04

Step 1100: Loss=1.8820, PPL=6.57, LR=1.90e-04

Step 1200: Loss=2.2546, PPL=9.53, LR=1.90e-04

Step 1300: Loss=2.4797, PPL=11.94, LR=1.89e-04

Step 1400: Loss=2.1531, PPL=8.61, LR=1.89e-04

Step 1500: Loss=2.2039, PPL=9.06, LR=1.89e-04

Step 1600: Loss=2.3826, PPL=10.83, LR=1.89e-04

Step 1700: Loss=2.1441, PPL=8.53, LR=1.89e-04

Step 1800: Loss=2.2159, PPL=9.17, LR=1.89e-04

Step 1900: Loss=1.9346, PPL=6.92, LR=1.88e-04

Step 2000: Loss=2.2663, PPL=9.64, LR=1.88e-04

Step 2100: Loss=2.2633, PPL=9.61, LR=1.88e-04

Step 2200: Loss=2.0370, PPL=7.67, LR=1.88e-04

Step 2300: Loss=2.3033, PPL=10.01, LR=1.88e-04

Step 2400: Loss=2.3922, PPL=10.94, LR=1.88e-04

Step 2500: Loss=2.1820, PPL=8.86, LR=1.87e-04

Step 2600: Loss=2.0819, PPL=8.02, LR=1.87e-04

Step 2700: Loss=2.2199, PPL=9.21, LR=1.87e-04

Step 2800: Loss=2.1631, PPL=8.70, LR=1.87e-04

Step 2900: Loss=2.0091, PPL=7.46, LR=1.87e-04

Step 3000: Loss=2.3830, PPL=10.84, LR=1.87e-04

Step 3100: Loss=2.1133, PPL=8.28, LR=1.86e-04

Epoch 18 结果:
  训练损失: 2.1801, 困惑度: 8.85
  验证损失: 2.2898, 困惑度: 9.87
  验证BLEU: 0.0372 (3.72%)
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.2898)

==================================================
Epoch 19/50
==================================================

Step 0: Loss=2.0929, PPL=8.11, LR=1.86e-04

Step 100: Loss=2.1798, PPL=8.84, LR=1.86e-04

Step 200: Loss=2.1532, PPL=8.61, LR=1.86e-04

Step 300: Loss=2.1567, PPL=8.64, LR=1.86e-04

Step 400: Loss=2.1083, PPL=8.23, LR=1.86e-04

Step 500: Loss=2.1731, PPL=8.79, LR=1.86e-04

Step 600: Loss=2.1490, PPL=8.58, LR=1.85e-04

Step 700: Loss=2.0707, PPL=7.93, LR=1.85e-04

Step 800: Loss=1.9772, PPL=7.22, LR=1.85e-04

Step 900: Loss=2.2511, PPL=9.50, LR=1.85e-04

Step 1000: Loss=2.2105, PPL=9.12, LR=1.85e-04

Step 1100: Loss=2.1671, PPL=8.73, LR=1.85e-04

Step 1200: Loss=2.0262, PPL=7.59, LR=1.84e-04

Step 1300: Loss=1.9560, PPL=7.07, LR=1.84e-04

Step 1400: Loss=2.1065, PPL=8.22, LR=1.84e-04

Step 1500: Loss=2.2226, PPL=9.23, LR=1.84e-04

Step 1600: Loss=2.0017, PPL=7.40, LR=1.84e-04

Step 1700: Loss=2.1447, PPL=8.54, LR=1.84e-04

Step 1800: Loss=2.3330, PPL=10.31, LR=1.83e-04

Step 1900: Loss=2.1882, PPL=8.92, LR=1.83e-04

Step 2000: Loss=2.3233, PPL=10.21, LR=1.83e-04

Step 2100: Loss=2.2611, PPL=9.59, LR=1.83e-04

Step 2200: Loss=2.3563, PPL=10.55, LR=1.83e-04

Step 2300: Loss=2.2352, PPL=9.35, LR=1.83e-04

Step 2400: Loss=2.0941, PPL=8.12, LR=1.82e-04

Step 2500: Loss=2.3477, PPL=10.46, LR=1.82e-04

Step 2600: Loss=2.1392, PPL=8.49, LR=1.82e-04

Step 2700: Loss=2.4058, PPL=11.09, LR=1.82e-04

Step 2800: Loss=2.2099, PPL=9.12, LR=1.82e-04

Step 2900: Loss=2.1635, PPL=8.70, LR=1.82e-04

Step 3000: Loss=2.2216, PPL=9.22, LR=1.82e-04

Step 3100: Loss=2.2631, PPL=9.61, LR=1.81e-04

Epoch 19 结果:
  训练损失: 2.1523, 困惑度: 8.60
  验证损失: 2.2992, 困惑度: 9.97
  验证损失未改善 (patience: 1/5)
  当前: 2.2992, 最佳: 2.2898, 差距: 0.0094

==================================================
Epoch 20/50
==================================================

Step 0: Loss=1.9851, PPL=7.28, LR=1.81e-04

Step 100: Loss=2.1141, PPL=8.28, LR=1.81e-04

Step 200: Loss=2.1085, PPL=8.24, LR=1.81e-04

Step 300: Loss=2.0813, PPL=8.01, LR=1.81e-04

Step 400: Loss=1.8931, PPL=6.64, LR=1.81e-04

Step 500: Loss=2.1412, PPL=8.51, LR=1.81e-04

Step 600: Loss=2.1965, PPL=8.99, LR=1.80e-04

Step 700: Loss=2.0751, PPL=7.97, LR=1.80e-04

Step 800: Loss=2.0804, PPL=8.01, LR=1.80e-04

Step 900: Loss=2.2711, PPL=9.69, LR=1.80e-04

Step 1000: Loss=2.0975, PPL=8.15, LR=1.80e-04

Step 1100: Loss=2.0294, PPL=7.61, LR=1.80e-04

Step 1200: Loss=1.8879, PPL=6.61, LR=1.80e-04

Step 1300: Loss=2.0700, PPL=7.93, LR=1.79e-04

Step 1400: Loss=2.1422, PPL=8.52, LR=1.79e-04

Step 1500: Loss=2.0980, PPL=8.15, LR=1.79e-04

Step 1600: Loss=1.9746, PPL=7.20, LR=1.79e-04

Step 1700: Loss=2.1374, PPL=8.48, LR=1.79e-04

Step 1800: Loss=2.2860, PPL=9.84, LR=1.79e-04

Step 1900: Loss=2.0861, PPL=8.05, LR=1.79e-04

Step 2000: Loss=2.1872, PPL=8.91, LR=1.78e-04

Step 2100: Loss=2.1758, PPL=8.81, LR=1.78e-04

Step 2200: Loss=2.0589, PPL=7.84, LR=1.78e-04

Step 2300: Loss=2.1973, PPL=9.00, LR=1.78e-04

Step 2400: Loss=2.2951, PPL=9.93, LR=1.78e-04

Step 2500: Loss=2.4492, PPL=11.58, LR=1.78e-04

Step 2600: Loss=2.2175, PPL=9.18, LR=1.78e-04

Step 2700: Loss=2.2347, PPL=9.34, LR=1.77e-04

Step 2800: Loss=2.0651, PPL=7.89, LR=1.77e-04

Step 2900: Loss=2.2249, PPL=9.25, LR=1.77e-04

Step 3000: Loss=2.3621, PPL=10.61, LR=1.77e-04

Step 3100: Loss=1.8906, PPL=6.62, LR=1.77e-04

Epoch 20 结果:
  训练损失: 2.1281, 困惑度: 8.40
  验证损失: 2.2916, 困惑度: 9.89
  验证损失未改善 (patience: 2/5)
  当前: 2.2916, 最佳: 2.2898, 差距: 0.0017
检查点已保存: runs/20251108_174942/checkpoints/checkpoint_epoch_20.pt
训练曲线已保存: runs/20251108_174942/figures/training_curves.png

==================================================
Epoch 21/50
==================================================

Step 0: Loss=2.1825, PPL=8.87, LR=1.77e-04

Step 100: Loss=2.0540, PPL=7.80, LR=1.77e-04

Step 200: Loss=2.0115, PPL=7.47, LR=1.76e-04

Step 300: Loss=2.1573, PPL=8.65, LR=1.76e-04

Step 400: Loss=2.1335, PPL=8.44, LR=1.76e-04

Step 500: Loss=2.1855, PPL=8.90, LR=1.76e-04

Step 600: Loss=2.0342, PPL=7.65, LR=1.76e-04

Step 700: Loss=1.9170, PPL=6.80, LR=1.76e-04

Step 800: Loss=2.1201, PPL=8.33, LR=1.76e-04

Step 900: Loss=2.0281, PPL=7.60, LR=1.76e-04

Step 1000: Loss=2.0129, PPL=7.49, LR=1.75e-04

Step 1100: Loss=2.3814, PPL=10.82, LR=1.75e-04

Step 1200: Loss=1.9256, PPL=6.86, LR=1.75e-04

Step 1300: Loss=2.0716, PPL=7.94, LR=1.75e-04

Step 1400: Loss=1.9510, PPL=7.04, LR=1.75e-04

Step 1500: Loss=1.8419, PPL=6.31, LR=1.75e-04

Step 1600: Loss=2.0705, PPL=7.93, LR=1.75e-04

Step 1700: Loss=2.0107, PPL=7.47, LR=1.74e-04

Step 1800: Loss=2.0885, PPL=8.07, LR=1.74e-04

Step 1900: Loss=2.3804, PPL=10.81, LR=1.74e-04

Step 2000: Loss=2.0800, PPL=8.00, LR=1.74e-04

Step 2100: Loss=2.2531, PPL=9.52, LR=1.74e-04

Step 2200: Loss=2.1383, PPL=8.49, LR=1.74e-04

Step 2300: Loss=2.0880, PPL=8.07, LR=1.74e-04

Step 2400: Loss=2.1595, PPL=8.67, LR=1.73e-04

Step 2500: Loss=2.0927, PPL=8.11, LR=1.73e-04

Step 2600: Loss=2.1336, PPL=8.45, LR=1.73e-04

Step 2700: Loss=2.3815, PPL=10.82, LR=1.73e-04

Step 2800: Loss=2.0945, PPL=8.12, LR=1.73e-04

Step 2900: Loss=2.0214, PPL=7.55, LR=1.73e-04

Step 3000: Loss=2.2166, PPL=9.18, LR=1.73e-04

Step 3100: Loss=2.0011, PPL=7.40, LR=1.73e-04

Epoch 21 结果:
  训练损失: 2.1030, 困惑度: 8.19
  验证损失: 2.2837, 困惑度: 9.81
  验证BLEU: 0.0379 (3.79%)
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.2837)

==================================================
Epoch 22/50
==================================================

Step 0: Loss=1.9409, PPL=6.97, LR=1.73e-04

Step 100: Loss=1.9826, PPL=7.26, LR=1.72e-04

Step 200: Loss=2.1141, PPL=8.28, LR=1.72e-04

Step 300: Loss=2.0534, PPL=7.79, LR=1.72e-04

Step 400: Loss=2.1857, PPL=8.90, LR=1.72e-04

Step 500: Loss=2.0770, PPL=7.98, LR=1.72e-04

Step 600: Loss=1.8172, PPL=6.15, LR=1.72e-04

Step 700: Loss=1.9399, PPL=6.96, LR=1.72e-04

Step 800: Loss=2.1599, PPL=8.67, LR=1.71e-04

Step 900: Loss=2.0586, PPL=7.84, LR=1.71e-04

Step 1000: Loss=1.9923, PPL=7.33, LR=1.71e-04

Step 1100: Loss=2.2407, PPL=9.40, LR=1.71e-04

Step 1200: Loss=2.1102, PPL=8.25, LR=1.71e-04

Step 1300: Loss=2.0354, PPL=7.66, LR=1.71e-04

Step 1400: Loss=2.0402, PPL=7.69, LR=1.71e-04

Step 1500: Loss=2.2234, PPL=9.24, LR=1.71e-04

Step 1600: Loss=2.0170, PPL=7.52, LR=1.70e-04

Step 1700: Loss=2.0865, PPL=8.06, LR=1.70e-04

Step 1800: Loss=2.1467, PPL=8.56, LR=1.70e-04

Step 1900: Loss=1.8878, PPL=6.60, LR=1.70e-04

Step 2000: Loss=2.1160, PPL=8.30, LR=1.70e-04

Step 2100: Loss=2.1271, PPL=8.39, LR=1.70e-04

Step 2200: Loss=1.9735, PPL=7.20, LR=1.70e-04

Step 2300: Loss=1.8991, PPL=6.68, LR=1.70e-04

Step 2400: Loss=2.0130, PPL=7.49, LR=1.69e-04

Step 2500: Loss=2.2164, PPL=9.17, LR=1.69e-04

Step 2600: Loss=2.1679, PPL=8.74, LR=1.69e-04

Step 2700: Loss=2.1205, PPL=8.34, LR=1.69e-04

Step 2800: Loss=2.1044, PPL=8.20, LR=1.69e-04

Step 2900: Loss=2.1409, PPL=8.51, LR=1.69e-04

Step 3000: Loss=2.0508, PPL=7.77, LR=1.69e-04

Step 3100: Loss=2.2515, PPL=9.50, LR=1.69e-04

Epoch 22 结果:
  训练损失: 2.0820, 困惑度: 8.02
  验证损失: 2.2827, 困惑度: 9.80
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.2827)

==================================================
Epoch 23/50
==================================================

Step 0: Loss=2.0750, PPL=7.96, LR=1.69e-04

Step 100: Loss=1.9232, PPL=6.84, LR=1.68e-04

Step 200: Loss=2.0639, PPL=7.88, LR=1.68e-04

Step 300: Loss=2.0027, PPL=7.41, LR=1.68e-04

Step 400: Loss=1.9611, PPL=7.11, LR=1.68e-04

Step 500: Loss=2.0471, PPL=7.75, LR=1.68e-04

Step 600: Loss=1.8909, PPL=6.63, LR=1.68e-04

Step 700: Loss=2.2400, PPL=9.39, LR=1.68e-04

Step 800: Loss=2.0818, PPL=8.02, LR=1.68e-04

Step 900: Loss=1.9847, PPL=7.28, LR=1.67e-04

Step 1000: Loss=2.1439, PPL=8.53, LR=1.67e-04

Step 1100: Loss=2.0876, PPL=8.07, LR=1.67e-04

Step 1200: Loss=2.0061, PPL=7.43, LR=1.67e-04

Step 1300: Loss=1.9333, PPL=6.91, LR=1.67e-04

Step 1400: Loss=1.9643, PPL=7.13, LR=1.67e-04

Step 1500: Loss=2.1415, PPL=8.51, LR=1.67e-04

Step 1600: Loss=2.0898, PPL=8.08, LR=1.67e-04

Step 1700: Loss=1.9368, PPL=6.94, LR=1.67e-04

Step 1800: Loss=1.9120, PPL=6.77, LR=1.66e-04

Step 1900: Loss=1.9670, PPL=7.15, LR=1.66e-04

Step 2000: Loss=2.0010, PPL=7.40, LR=1.66e-04

Step 2100: Loss=1.9811, PPL=7.25, LR=1.66e-04

Step 2200: Loss=2.1023, PPL=8.18, LR=1.66e-04

Step 2300: Loss=2.1006, PPL=8.17, LR=1.66e-04

Step 2400: Loss=2.3011, PPL=9.99, LR=1.66e-04

Step 2500: Loss=2.1418, PPL=8.51, LR=1.66e-04

Step 2600: Loss=2.1301, PPL=8.42, LR=1.65e-04

Step 2700: Loss=1.9907, PPL=7.32, LR=1.65e-04

Step 2800: Loss=2.1976, PPL=9.00, LR=1.65e-04

Step 2900: Loss=2.0206, PPL=7.54, LR=1.65e-04

Step 3000: Loss=2.1133, PPL=8.28, LR=1.65e-04

Step 3100: Loss=2.2285, PPL=9.29, LR=1.65e-04

Epoch 23 结果:
  训练损失: 2.0583, 困惑度: 7.83
  验证损失: 2.2771, 困惑度: 9.75
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.2771)

==================================================
Epoch 24/50
==================================================

Step 0: Loss=1.9652, PPL=7.14, LR=1.65e-04

Step 100: Loss=1.7779, PPL=5.92, LR=1.65e-04

Step 200: Loss=2.0251, PPL=7.58, LR=1.65e-04

Step 300: Loss=2.0052, PPL=7.43, LR=1.65e-04

Step 400: Loss=2.1148, PPL=8.29, LR=1.64e-04

Step 500: Loss=2.0214, PPL=7.55, LR=1.64e-04

Step 600: Loss=1.9916, PPL=7.33, LR=1.64e-04

Step 700: Loss=1.8472, PPL=6.34, LR=1.64e-04

Step 800: Loss=1.9044, PPL=6.72, LR=1.64e-04

Step 900: Loss=2.0767, PPL=7.98, LR=1.64e-04

Step 1000: Loss=2.1444, PPL=8.54, LR=1.64e-04

Step 1100: Loss=2.0202, PPL=7.54, LR=1.64e-04

Step 1200: Loss=1.8783, PPL=6.54, LR=1.63e-04

Step 1300: Loss=2.0664, PPL=7.90, LR=1.63e-04

Step 1400: Loss=2.1179, PPL=8.31, LR=1.63e-04

Step 1500: Loss=2.0437, PPL=7.72, LR=1.63e-04

Step 1600: Loss=2.0594, PPL=7.84, LR=1.63e-04

Step 1700: Loss=2.0173, PPL=7.52, LR=1.63e-04

Step 1800: Loss=1.9109, PPL=6.76, LR=1.63e-04

Step 1900: Loss=2.1751, PPL=8.80, LR=1.63e-04

Step 2000: Loss=1.9655, PPL=7.14, LR=1.63e-04

Step 2100: Loss=1.9049, PPL=6.72, LR=1.62e-04

Step 2200: Loss=1.9289, PPL=6.88, LR=1.62e-04

Step 2300: Loss=1.9105, PPL=6.76, LR=1.62e-04

Step 2400: Loss=2.2621, PPL=9.60, LR=1.62e-04

Step 2500: Loss=2.1059, PPL=8.21, LR=1.62e-04

Step 2600: Loss=2.0189, PPL=7.53, LR=1.62e-04

Step 2700: Loss=1.9593, PPL=7.09, LR=1.62e-04

Step 2800: Loss=2.0819, PPL=8.02, LR=1.62e-04

Step 2900: Loss=2.0555, PPL=7.81, LR=1.62e-04

Step 3000: Loss=2.2087, PPL=9.10, LR=1.62e-04

Step 3100: Loss=2.0670, PPL=7.90, LR=1.61e-04

Epoch 24 结果:
  训练损失: 2.0370, 困惑度: 7.67
  验证损失: 2.2869, 困惑度: 9.84
  验证BLEU: 0.0367 (3.67%)
  验证损失未改善 (patience: 1/5)
  当前: 2.2869, 最佳: 2.2771, 差距: 0.0098

==================================================
Epoch 25/50
==================================================

Step 0: Loss=2.0857, PPL=8.05, LR=1.61e-04

Step 100: Loss=1.8256, PPL=6.21, LR=1.61e-04

Step 200: Loss=1.8598, PPL=6.42, LR=1.61e-04

Step 300: Loss=2.1087, PPL=8.24, LR=1.61e-04

Step 400: Loss=1.8615, PPL=6.43, LR=1.61e-04

Step 500: Loss=2.0312, PPL=7.62, LR=1.61e-04

Step 600: Loss=2.0253, PPL=7.58, LR=1.61e-04

Step 700: Loss=1.9606, PPL=7.10, LR=1.61e-04

Step 800: Loss=2.0367, PPL=7.67, LR=1.61e-04

Step 900: Loss=2.1771, PPL=8.82, LR=1.60e-04

Step 1000: Loss=1.9780, PPL=7.23, LR=1.60e-04

Step 1100: Loss=1.9037, PPL=6.71, LR=1.60e-04

Step 1200: Loss=2.0260, PPL=7.58, LR=1.60e-04

Step 1300: Loss=2.0666, PPL=7.90, LR=1.60e-04

Step 1400: Loss=1.9486, PPL=7.02, LR=1.60e-04

Step 1500: Loss=1.9770, PPL=7.22, LR=1.60e-04

Step 1600: Loss=2.1171, PPL=8.31, LR=1.60e-04

Step 1700: Loss=1.9525, PPL=7.05, LR=1.60e-04

Step 1800: Loss=1.9743, PPL=7.20, LR=1.59e-04

Step 1900: Loss=2.0115, PPL=7.47, LR=1.59e-04

Step 2000: Loss=2.0564, PPL=7.82, LR=1.59e-04

Step 2100: Loss=2.0187, PPL=7.53, LR=1.59e-04

Step 2200: Loss=1.9960, PPL=7.36, LR=1.59e-04

Step 2300: Loss=1.9647, PPL=7.13, LR=1.59e-04

Step 2400: Loss=2.0075, PPL=7.44, LR=1.59e-04

Step 2500: Loss=2.0032, PPL=7.41, LR=1.59e-04

Step 2600: Loss=1.8656, PPL=6.46, LR=1.59e-04

Step 2700: Loss=1.8836, PPL=6.58, LR=1.59e-04

Step 2800: Loss=1.8013, PPL=6.06, LR=1.58e-04

Step 2900: Loss=2.0980, PPL=8.15, LR=1.58e-04

Step 3000: Loss=2.1950, PPL=8.98, LR=1.58e-04

Step 3100: Loss=1.9681, PPL=7.16, LR=1.58e-04

Epoch 25 结果:
  训练损失: 2.0186, 困惑度: 7.53
  验证损失: 2.2753, 困惑度: 9.73
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.2753)
检查点已保存: runs/20251108_174942/checkpoints/checkpoint_epoch_25.pt
训练曲线已保存: runs/20251108_174942/figures/training_curves.png

==================================================
Epoch 26/50
==================================================

Step 0: Loss=1.7682, PPL=5.86, LR=1.58e-04

Step 100: Loss=1.9312, PPL=6.90, LR=1.58e-04

Step 200: Loss=1.9658, PPL=7.14, LR=1.58e-04

Step 300: Loss=1.7825, PPL=5.94, LR=1.58e-04

Step 400: Loss=2.0849, PPL=8.04, LR=1.58e-04

Step 500: Loss=1.7197, PPL=5.58, LR=1.58e-04

Step 600: Loss=1.9508, PPL=7.03, LR=1.58e-04

Step 700: Loss=1.7958, PPL=6.02, LR=1.57e-04

Step 800: Loss=1.8908, PPL=6.62, LR=1.57e-04

Step 900: Loss=2.1288, PPL=8.41, LR=1.57e-04

Step 1000: Loss=2.0207, PPL=7.54, LR=1.57e-04

Step 1100: Loss=1.9035, PPL=6.71, LR=1.57e-04

Step 1200: Loss=2.0494, PPL=7.76, LR=1.57e-04

Step 1300: Loss=1.9516, PPL=7.04, LR=1.57e-04

Step 1400: Loss=2.0296, PPL=7.61, LR=1.57e-04

Step 1500: Loss=2.1733, PPL=8.79, LR=1.57e-04

Step 1600: Loss=1.9191, PPL=6.81, LR=1.57e-04

Step 1700: Loss=1.9758, PPL=7.21, LR=1.56e-04

Step 1800: Loss=2.1773, PPL=8.82, LR=1.56e-04

Step 1900: Loss=2.1446, PPL=8.54, LR=1.56e-04

Step 2000: Loss=1.8728, PPL=6.51, LR=1.56e-04

Step 2100: Loss=2.1151, PPL=8.29, LR=1.56e-04

Step 2200: Loss=2.1010, PPL=8.17, LR=1.56e-04

Step 2300: Loss=2.0465, PPL=7.74, LR=1.56e-04

Step 2400: Loss=2.0829, PPL=8.03, LR=1.56e-04

Step 2500: Loss=1.9710, PPL=7.18, LR=1.56e-04

Step 2600: Loss=1.8947, PPL=6.65, LR=1.56e-04

Step 2700: Loss=2.0252, PPL=7.58, LR=1.55e-04

Step 2800: Loss=2.2270, PPL=9.27, LR=1.55e-04

Step 2900: Loss=1.9439, PPL=6.99, LR=1.55e-04

Step 3000: Loss=2.1278, PPL=8.40, LR=1.55e-04

Step 3100: Loss=2.0973, PPL=8.14, LR=1.55e-04

Epoch 26 结果:
  训练损失: 2.0002, 困惑度: 7.39
  验证损失: 2.2736, 困惑度: 9.71
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.2736)

==================================================
Epoch 27/50
==================================================

Step 0: Loss=1.7254, PPL=5.61, LR=1.55e-04

Step 100: Loss=1.7871, PPL=5.97, LR=1.55e-04

Step 200: Loss=1.9521, PPL=7.04, LR=1.55e-04

Step 300: Loss=1.8940, PPL=6.65, LR=1.55e-04

Step 400: Loss=1.7576, PPL=5.80, LR=1.55e-04

Step 500: Loss=1.7715, PPL=5.88, LR=1.55e-04

Step 600: Loss=2.0637, PPL=7.88, LR=1.54e-04

Step 700: Loss=1.9340, PPL=6.92, LR=1.54e-04

Step 800: Loss=1.9223, PPL=6.84, LR=1.54e-04

Step 900: Loss=1.8161, PPL=6.15, LR=1.54e-04

Step 1000: Loss=1.9959, PPL=7.36, LR=1.54e-04

Step 1100: Loss=1.7312, PPL=5.65, LR=1.54e-04

Step 1200: Loss=1.8097, PPL=6.11, LR=1.54e-04

Step 1300: Loss=1.8626, PPL=6.44, LR=1.54e-04

Step 1400: Loss=2.0698, PPL=7.92, LR=1.54e-04

Step 1500: Loss=1.9568, PPL=7.08, LR=1.54e-04

Step 1600: Loss=1.9310, PPL=6.90, LR=1.54e-04

Step 1700: Loss=2.0435, PPL=7.72, LR=1.53e-04

Step 1800: Loss=2.1119, PPL=8.26, LR=1.53e-04

Step 1900: Loss=2.0098, PPL=7.46, LR=1.53e-04

Step 2000: Loss=2.1246, PPL=8.37, LR=1.53e-04

Step 2100: Loss=2.0890, PPL=8.08, LR=1.53e-04

Step 2200: Loss=2.0212, PPL=7.55, LR=1.53e-04

Step 2300: Loss=2.2039, PPL=9.06, LR=1.53e-04

Step 2400: Loss=1.9327, PPL=6.91, LR=1.53e-04

Step 2500: Loss=2.0857, PPL=8.05, LR=1.53e-04

Step 2600: Loss=1.9310, PPL=6.90, LR=1.53e-04

Step 2700: Loss=1.9571, PPL=7.08, LR=1.53e-04

Step 2800: Loss=1.8417, PPL=6.31, LR=1.52e-04

Step 2900: Loss=2.0418, PPL=7.70, LR=1.52e-04

Step 3000: Loss=2.0534, PPL=7.79, LR=1.52e-04

Step 3100: Loss=2.1588, PPL=8.66, LR=1.52e-04

Epoch 27 结果:
  训练损失: 1.9835, 困惑度: 7.27
  验证损失: 2.2795, 困惑度: 9.77
  验证BLEU: 0.0366 (3.66%)
  验证损失未改善 (patience: 1/5)
  当前: 2.2795, 最佳: 2.2736, 差距: 0.0059

==================================================
Epoch 28/50
==================================================

Step 0: Loss=1.9416, PPL=6.97, LR=1.52e-04

Step 100: Loss=1.8564, PPL=6.40, LR=1.52e-04

Step 200: Loss=2.0305, PPL=7.62, LR=1.52e-04

Step 300: Loss=1.7430, PPL=5.71, LR=1.52e-04

Step 400: Loss=1.9300, PPL=6.89, LR=1.52e-04

Step 500: Loss=1.8156, PPL=6.14, LR=1.52e-04

Step 600: Loss=1.8780, PPL=6.54, LR=1.52e-04

Step 700: Loss=1.9315, PPL=6.90, LR=1.52e-04

Step 800: Loss=1.9877, PPL=7.30, LR=1.51e-04

Step 900: Loss=1.8964, PPL=6.66, LR=1.51e-04

Step 1000: Loss=2.0137, PPL=7.49, LR=1.51e-04

Step 1100: Loss=1.8943, PPL=6.65, LR=1.51e-04

Step 1200: Loss=2.0511, PPL=7.78, LR=1.51e-04

Step 1300: Loss=1.9244, PPL=6.85, LR=1.51e-04

Step 1400: Loss=1.9172, PPL=6.80, LR=1.51e-04

Step 1500: Loss=2.0325, PPL=7.63, LR=1.51e-04

Step 1600: Loss=2.1312, PPL=8.43, LR=1.51e-04

Step 1700: Loss=1.8389, PPL=6.29, LR=1.51e-04

Step 1800: Loss=1.9706, PPL=7.17, LR=1.51e-04

Step 1900: Loss=2.0011, PPL=7.40, LR=1.50e-04

Step 2000: Loss=1.9411, PPL=6.97, LR=1.50e-04

Step 2100: Loss=1.9735, PPL=7.20, LR=1.50e-04

Step 2200: Loss=2.1784, PPL=8.83, LR=1.50e-04

Step 2300: Loss=2.0739, PPL=7.96, LR=1.50e-04

Step 2400: Loss=1.8980, PPL=6.67, LR=1.50e-04

Step 2500: Loss=1.9939, PPL=7.34, LR=1.50e-04

Step 2600: Loss=2.1346, PPL=8.45, LR=1.50e-04

Step 2700: Loss=2.1057, PPL=8.21, LR=1.50e-04

Step 2800: Loss=2.1120, PPL=8.26, LR=1.50e-04

Step 2900: Loss=2.0880, PPL=8.07, LR=1.50e-04

Step 3000: Loss=2.0810, PPL=8.01, LR=1.50e-04

Step 3100: Loss=2.2097, PPL=9.11, LR=1.49e-04

Epoch 28 结果:
  训练损失: 1.9647, 困惑度: 7.13
  验证损失: 2.2677, 困惑度: 9.66
检查点已保存: runs/20251108_174942/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.2677)

==================================================
Epoch 29/50
==================================================

Step 0: Loss=1.8098, PPL=6.11, LR=1.49e-04

Step 100: Loss=2.0316, PPL=7.63, LR=1.49e-04

Step 200: Loss=1.9161, PPL=6.79, LR=1.49e-04

Step 300: Loss=2.0092, PPL=7.46, LR=1.49e-04

Step 400: Loss=1.9489, PPL=7.02, LR=1.49e-04

Step 500: Loss=1.7670, PPL=5.85, LR=1.49e-04

Step 600: Loss=1.9717, PPL=7.18, LR=1.49e-04

Step 700: Loss=1.8872, PPL=6.60, LR=1.49e-04

Step 800: Loss=1.8106, PPL=6.11, LR=1.49e-04

Step 900: Loss=1.9599, PPL=7.10, LR=1.49e-04

Step 1000: Loss=2.0501, PPL=7.77, LR=1.49e-04

Step 1100: Loss=2.0051, PPL=7.43, LR=1.48e-04

Step 1200: Loss=1.9157, PPL=6.79, LR=1.48e-04

Step 1300: Loss=1.8774, PPL=6.54, LR=1.48e-04

Step 1400: Loss=1.9475, PPL=7.01, LR=1.48e-04

Step 1500: Loss=1.8213, PPL=6.18, LR=1.48e-04

Step 1600: Loss=1.7940, PPL=6.01, LR=1.48e-04

Step 1700: Loss=2.0325, PPL=7.63, LR=1.48e-04

Step 1800: Loss=1.8356, PPL=6.27, LR=1.48e-04

Step 1900: Loss=1.9155, PPL=6.79, LR=1.48e-04

Step 2000: Loss=1.9593, PPL=7.09, LR=1.48e-04

Step 2100: Loss=2.0527, PPL=7.79, LR=1.48e-04

Step 2200: Loss=1.9943, PPL=7.35, LR=1.48e-04

Step 2300: Loss=2.0188, PPL=7.53, LR=1.47e-04

Step 2400: Loss=1.9082, PPL=6.74, LR=1.47e-04

Step 2500: Loss=2.0806, PPL=8.01, LR=1.47e-04

Step 2600: Loss=2.0263, PPL=7.59, LR=1.47e-04

Step 2700: Loss=2.0851, PPL=8.05, LR=1.47e-04

Step 2800: Loss=1.8811, PPL=6.56, LR=1.47e-04

Step 2900: Loss=1.9877, PPL=7.30, LR=1.47e-04

Step 3000: Loss=2.1216, PPL=8.34, LR=1.47e-04

Step 3100: Loss=1.8437, PPL=6.32, LR=1.47e-04

Epoch 29 结果:
  训练损失: 1.9474, 困惑度: 7.01
  验证损失: 2.2788, 困惑度: 9.76
  验证损失未改善 (patience: 1/5)
  当前: 2.2788, 最佳: 2.2677, 差距: 0.0110

==================================================
Epoch 30/50
==================================================

Step 0: Loss=1.9497, PPL=7.03, LR=1.47e-04

Step 100: Loss=1.6661, PPL=5.29, LR=1.47e-04

Step 200: Loss=1.8779, PPL=6.54, LR=1.47e-04

Step 300: Loss=1.8071, PPL=6.09, LR=1.47e-04

Step 400: Loss=1.7166, PPL=5.57, LR=1.46e-04

Step 500: Loss=1.8304, PPL=6.24, LR=1.46e-04

Step 600: Loss=1.7878, PPL=5.98, LR=1.46e-04

Step 700: Loss=1.9376, PPL=6.94, LR=1.46e-04

Step 800: Loss=1.9449, PPL=6.99, LR=1.46e-04

Step 900: Loss=2.0814, PPL=8.02, LR=1.46e-04

Step 1000: Loss=1.9312, PPL=6.90, LR=1.46e-04

Step 1100: Loss=1.8580, PPL=6.41, LR=1.46e-04

Step 1200: Loss=1.9907, PPL=7.32, LR=1.46e-04

Step 1300: Loss=1.8395, PPL=6.29, LR=1.46e-04

Step 1400: Loss=2.0055, PPL=7.43, LR=1.46e-04

Step 1500: Loss=1.9066, PPL=6.73, LR=1.46e-04

Step 1600: Loss=2.0015, PPL=7.40, LR=1.46e-04

Step 1700: Loss=1.8911, PPL=6.63, LR=1.45e-04

Step 1800: Loss=1.9404, PPL=6.96, LR=1.45e-04

Step 1900: Loss=1.7792, PPL=5.93, LR=1.45e-04

Step 2000: Loss=1.8130, PPL=6.13, LR=1.45e-04

Step 2100: Loss=2.1729, PPL=8.78, LR=1.45e-04

Step 2200: Loss=1.8001, PPL=6.05, LR=1.45e-04

Step 2300: Loss=1.9444, PPL=6.99, LR=1.45e-04

Step 2400: Loss=1.8216, PPL=6.18, LR=1.45e-04

Step 2500: Loss=2.1358, PPL=8.46, LR=1.45e-04

Step 2600: Loss=2.1753, PPL=8.80, LR=1.45e-04

Step 2700: Loss=2.0053, PPL=7.43, LR=1.45e-04

Step 2800: Loss=2.2117, PPL=9.13, LR=1.45e-04

Step 2900: Loss=1.9000, PPL=6.69, LR=1.45e-04

Step 3000: Loss=1.9916, PPL=7.33, LR=1.44e-04

Step 3100: Loss=2.0750, PPL=7.96, LR=1.44e-04

Epoch 30 结果:
  训练损失: 1.9335, 困惑度: 6.91
  验证损失: 2.2864, 困惑度: 9.84
  验证BLEU: 0.0360 (3.60%)
  验证损失未改善 (patience: 2/5)
  当前: 2.2864, 最佳: 2.2677, 差距: 0.0187
检查点已保存: runs/20251108_174942/checkpoints/checkpoint_epoch_30.pt
训练曲线已保存: runs/20251108_174942/figures/training_curves.png

==================================================
Epoch 31/50
==================================================

Step 0: Loss=1.9506, PPL=7.03, LR=1.44e-04

Step 100: Loss=1.8972, PPL=6.67, LR=1.44e-04

Step 200: Loss=1.9586, PPL=7.09, LR=1.44e-04

Step 300: Loss=1.7917, PPL=6.00, LR=1.44e-04

Step 400: Loss=1.7221, PPL=5.60, LR=1.44e-04

Step 500: Loss=1.9485, PPL=7.02, LR=1.44e-04

Step 600: Loss=1.7184, PPL=5.58, LR=1.44e-04

Step 700: Loss=1.8468, PPL=6.34, LR=1.44e-04

Step 800: Loss=1.7171, PPL=5.57, LR=1.44e-04

Step 900: Loss=1.9084, PPL=6.74, LR=1.44e-04

Step 1000: Loss=1.9958, PPL=7.36, LR=1.44e-04

Step 1100: Loss=1.8751, PPL=6.52, LR=1.43e-04

Step 1200: Loss=1.6564, PPL=5.24, LR=1.43e-04

Step 1300: Loss=1.8643, PPL=6.45, LR=1.43e-04

Step 1400: Loss=2.0116, PPL=7.48, LR=1.43e-04

Step 1500: Loss=1.9987, PPL=7.38, LR=1.43e-04

Step 1600: Loss=1.9555, PPL=7.07, LR=1.43e-04

Step 1700: Loss=1.9074, PPL=6.74, LR=1.43e-04

Step 1800: Loss=1.8821, PPL=6.57, LR=1.43e-04

Step 1900: Loss=1.7776, PPL=5.92, LR=1.43e-04

Step 2000: Loss=1.9778, PPL=7.23, LR=1.43e-04

Step 2100: Loss=1.8714, PPL=6.50, LR=1.43e-04

Step 2200: Loss=1.7949, PPL=6.02, LR=1.43e-04

Step 2300: Loss=1.8582, PPL=6.41, LR=1.43e-04

Step 2400: Loss=1.9093, PPL=6.75, LR=1.43e-04

Step 2500: Loss=2.1688, PPL=8.75, LR=1.42e-04

Step 2600: Loss=2.0426, PPL=7.71, LR=1.42e-04

Step 2700: Loss=1.9306, PPL=6.89, LR=1.42e-04

Step 2800: Loss=2.0654, PPL=7.89, LR=1.42e-04

Step 2900: Loss=1.9069, PPL=6.73, LR=1.42e-04

Step 3000: Loss=1.9681, PPL=7.16, LR=1.42e-04

Step 3100: Loss=1.9179, PPL=6.81, LR=1.42e-04

Epoch 31 结果:
  训练损失: 1.9185, 困惑度: 6.81
  验证损失: 2.2942, 困惑度: 9.92
  验证损失未改善 (patience: 3/5)
  当前: 2.2942, 最佳: 2.2677, 差距: 0.0264

==================================================
Epoch 32/50
==================================================

Step 0: Loss=1.8655, PPL=6.46, LR=1.42e-04

Step 100: Loss=1.7525, PPL=5.77, LR=1.42e-04

Step 200: Loss=1.7444, PPL=5.72, LR=1.42e-04

Step 300: Loss=1.9229, PPL=6.84, LR=1.42e-04

Step 400: Loss=1.9297, PPL=6.89, LR=1.42e-04

Step 500: Loss=1.9962, PPL=7.36, LR=1.42e-04

Step 600: Loss=1.9460, PPL=7.00, LR=1.42e-04

Step 700: Loss=1.7426, PPL=5.71, LR=1.41e-04

Step 800: Loss=2.0360, PPL=7.66, LR=1.41e-04

Step 900: Loss=1.8939, PPL=6.64, LR=1.41e-04

Step 1000: Loss=1.6787, PPL=5.36, LR=1.41e-04

Step 1100: Loss=2.0376, PPL=7.67, LR=1.41e-04

Step 1200: Loss=1.9008, PPL=6.69, LR=1.41e-04

Step 1300: Loss=1.8858, PPL=6.59, LR=1.41e-04

Step 1400: Loss=1.9564, PPL=7.07, LR=1.41e-04

Step 1500: Loss=1.9771, PPL=7.22, LR=1.41e-04

Step 1600: Loss=1.8203, PPL=6.17, LR=1.41e-04

Step 1700: Loss=1.8778, PPL=6.54, LR=1.41e-04

Step 1800: Loss=2.0207, PPL=7.54, LR=1.41e-04

Step 1900: Loss=1.7684, PPL=5.86, LR=1.41e-04

Step 2000: Loss=1.9679, PPL=7.16, LR=1.41e-04

Step 2100: Loss=2.0024, PPL=7.41, LR=1.40e-04

Step 2200: Loss=1.9849, PPL=7.28, LR=1.40e-04

Step 2300: Loss=2.0692, PPL=7.92, LR=1.40e-04

Step 2400: Loss=1.9021, PPL=6.70, LR=1.40e-04

Step 2500: Loss=2.0675, PPL=7.91, LR=1.40e-04

Step 2600: Loss=1.8637, PPL=6.45, LR=1.40e-04

Step 2700: Loss=1.9399, PPL=6.96, LR=1.40e-04

Step 2800: Loss=1.9476, PPL=7.01, LR=1.40e-04

Step 2900: Loss=1.9530, PPL=7.05, LR=1.40e-04

Step 3000: Loss=1.9439, PPL=6.99, LR=1.40e-04

Step 3100: Loss=1.8920, PPL=6.63, LR=1.40e-04

Epoch 32 结果:
  训练损失: 1.9042, 困惑度: 6.71
  验证损失: 2.2905, 困惑度: 9.88
  验证损失未改善 (patience: 4/5)
  当前: 2.2905, 最佳: 2.2677, 差距: 0.0228

==================================================
Epoch 33/50
==================================================

Step 0: Loss=1.8118, PPL=6.12, LR=1.40e-04

Step 100: Loss=1.9616, PPL=7.11, LR=1.40e-04

Step 200: Loss=1.8596, PPL=6.42, LR=1.40e-04

Step 300: Loss=1.8144, PPL=6.14, LR=1.40e-04

Step 400: Loss=1.8512, PPL=6.37, LR=1.39e-04

Step 500: Loss=1.7949, PPL=6.02, LR=1.39e-04

Step 600: Loss=1.9074, PPL=6.74, LR=1.39e-04

Step 700: Loss=1.8199, PPL=6.17, LR=1.39e-04

Step 800: Loss=1.7941, PPL=6.01, LR=1.39e-04

Step 900: Loss=1.8284, PPL=6.22, LR=1.39e-04

Step 1000: Loss=1.7735, PPL=5.89, LR=1.39e-04

Step 1100: Loss=1.9447, PPL=6.99, LR=1.39e-04

Step 1200: Loss=1.9403, PPL=6.96, LR=1.39e-04

Step 1300: Loss=1.7747, PPL=5.90, LR=1.39e-04

Step 1400: Loss=1.9012, PPL=6.69, LR=1.39e-04

Step 1500: Loss=1.9035, PPL=6.71, LR=1.39e-04

Step 1600: Loss=1.8669, PPL=6.47, LR=1.39e-04

Step 1700: Loss=1.8022, PPL=6.06, LR=1.39e-04

Step 1800: Loss=2.0146, PPL=7.50, LR=1.39e-04

Step 1900: Loss=2.0815, PPL=8.02, LR=1.38e-04

Step 2000: Loss=2.0184, PPL=7.53, LR=1.38e-04

Step 2100: Loss=2.0106, PPL=7.47, LR=1.38e-04

Step 2200: Loss=1.9706, PPL=7.17, LR=1.38e-04

Step 2300: Loss=1.8985, PPL=6.68, LR=1.38e-04

Step 2400: Loss=1.8607, PPL=6.43, LR=1.38e-04

Step 2500: Loss=1.9613, PPL=7.11, LR=1.38e-04

Step 2600: Loss=1.7946, PPL=6.02, LR=1.38e-04

Step 2700: Loss=1.7965, PPL=6.03, LR=1.38e-04

Step 2800: Loss=1.7836, PPL=5.95, LR=1.38e-04

Step 2900: Loss=1.9469, PPL=7.01, LR=1.38e-04

Step 3000: Loss=2.1189, PPL=8.32, LR=1.38e-04

Step 3100: Loss=1.9487, PPL=7.02, LR=1.38e-04

Epoch 33 结果:
  训练损失: 1.8892, 困惑度: 6.61
  验证损失: 2.2864, 困惑度: 9.84
  验证BLEU: 0.0346 (3.46%)
  验证损失未改善 (patience: 5/5)
  当前: 2.2864, 最佳: 2.2677, 差距: 0.0187

==================================================
早停触发！验证损失在 5 个epoch内未改善
当前验证损失: 2.2864
最佳验证损失: 2.2677 (epoch 28)
最佳验证BLEU: 0.0379
==================================================
训练曲线已保存: runs/20251108_174942/figures/training_curves_final.png

============================================================
训练结束时间: 2025-11-08 23:14:12
============================================================
