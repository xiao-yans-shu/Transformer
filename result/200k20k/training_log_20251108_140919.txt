
============================================================
训练开始时间: 2025-11-08 14:09:19
============================================================

==================================================
运行名称: 20251108_140919
加载数据...
加载训练数据...
训练数据量: 206112，限制为: 200000
训练集大小: 200000
构建词汇表...
源语言词汇表大小: 20000
目标语言词汇表大小: 20000
加载验证数据...
验证集大小: 888
==================================================
创建模型...
模型参数统计:
  可训练参数: 74,880,544
  总参数: 74,880,544
  模型大小: 286.43 MB
==================================================
开始训练...

==================================================
Epoch 1/50
==================================================

Step 0: Loss=9.9300, PPL=20538.31, LR=6.18e-08

Step 100: Loss=9.3617, PPL=11634.15, LR=6.24e-06

Step 200: Loss=8.7514, PPL=6319.43, LR=1.24e-05

Step 300: Loss=7.9512, PPL=2838.90, LR=1.86e-05

Step 400: Loss=7.1025, PPL=1214.99, LR=2.48e-05

Step 500: Loss=6.6658, PPL=785.09, LR=3.09e-05

Step 600: Loss=6.2685, PPL=527.70, LR=3.71e-05

Step 700: Loss=6.2400, PPL=512.87, LR=4.33e-05

Step 800: Loss=6.1883, PPL=487.01, LR=4.95e-05

Step 900: Loss=6.1353, PPL=461.88, LR=5.56e-05

Step 1000: Loss=6.0065, PPL=406.05, LR=6.18e-05

Step 1100: Loss=5.9423, PPL=380.82, LR=6.80e-05

Step 1200: Loss=5.9037, PPL=366.39, LR=7.42e-05

Step 1300: Loss=5.7763, PPL=322.57, LR=8.04e-05

Step 1400: Loss=5.7327, PPL=308.80, LR=8.65e-05

Step 1500: Loss=5.6013, PPL=270.77, LR=9.27e-05

Step 1600: Loss=5.5519, PPL=257.72, LR=9.89e-05

Step 1700: Loss=5.4344, PPL=229.16, LR=1.05e-04

Step 1800: Loss=5.5353, PPL=253.48, LR=1.11e-04

Step 1900: Loss=5.4178, PPL=225.38, LR=1.17e-04

Step 2000: Loss=5.2179, PPL=184.56, LR=1.24e-04

Step 2100: Loss=5.3011, PPL=200.56, LR=1.30e-04

Step 2200: Loss=5.2266, PPL=186.16, LR=1.36e-04

Step 2300: Loss=5.0353, PPL=153.74, LR=1.42e-04

Step 2400: Loss=5.1303, PPL=169.08, LR=1.48e-04

Step 2500: Loss=4.9947, PPL=147.63, LR=1.54e-04

Step 2600: Loss=4.7463, PPL=115.15, LR=1.61e-04

Step 2700: Loss=4.8413, PPL=126.63, LR=1.67e-04

Step 2800: Loss=4.8052, PPL=122.14, LR=1.73e-04

Step 2900: Loss=4.7360, PPL=113.98, LR=1.79e-04

Step 3000: Loss=4.7923, PPL=120.58, LR=1.85e-04

Step 3100: Loss=4.5395, PPL=93.65, LR=1.92e-04

Epoch 1 结果:
  训练损失: 5.9054, 困惑度: 367.02
  验证损失: 4.5144, 困惑度: 91.32
检查点已保存: runs/20251108_140919/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 4.5144)

==================================================
Epoch 2/50
==================================================

Step 0: Loss=4.6451, PPL=104.07, LR=1.93e-04

Step 100: Loss=4.4383, PPL=84.63, LR=1.99e-04

Step 200: Loss=4.6335, PPL=102.87, LR=2.05e-04

Step 300: Loss=4.2687, PPL=71.43, LR=2.12e-04

Step 400: Loss=4.5137, PPL=91.26, LR=2.18e-04

Step 500: Loss=4.5710, PPL=96.64, LR=2.24e-04

Step 600: Loss=4.4343, PPL=84.29, LR=2.30e-04

Step 700: Loss=4.3238, PPL=75.47, LR=2.36e-04

Step 800: Loss=4.3110, PPL=74.51, LR=2.42e-04

Step 900: Loss=4.2754, PPL=71.91, LR=2.49e-04

Step 1000: Loss=4.4023, PPL=81.64, LR=2.55e-04

Step 1100: Loss=4.3085, PPL=74.33, LR=2.61e-04

Step 1200: Loss=4.2434, PPL=69.64, LR=2.67e-04

Step 1300: Loss=4.0038, PPL=54.81, LR=2.73e-04

Step 1400: Loss=4.2473, PPL=69.92, LR=2.80e-04

Step 1500: Loss=4.0423, PPL=56.96, LR=2.86e-04

Step 1600: Loss=3.9940, PPL=54.27, LR=2.92e-04

Step 1700: Loss=4.0149, PPL=55.42, LR=2.98e-04

Step 1800: Loss=3.9276, PPL=50.79, LR=3.04e-04

Step 1900: Loss=4.2228, PPL=68.22, LR=3.10e-04

Step 2000: Loss=3.9706, PPL=53.02, LR=3.17e-04

Step 2100: Loss=4.0502, PPL=57.41, LR=3.23e-04

Step 2200: Loss=3.8621, PPL=47.56, LR=3.29e-04

Step 2300: Loss=3.7735, PPL=43.53, LR=3.35e-04

Step 2400: Loss=4.0048, PPL=54.86, LR=3.41e-04

Step 2500: Loss=3.8757, PPL=48.22, LR=3.47e-04

Step 2600: Loss=3.7410, PPL=42.14, LR=3.54e-04

Step 2700: Loss=3.6722, PPL=39.34, LR=3.60e-04

Step 2800: Loss=3.7614, PPL=43.01, LR=3.66e-04

Step 2900: Loss=3.9268, PPL=50.74, LR=3.72e-04

Step 3000: Loss=3.8746, PPL=48.16, LR=3.78e-04

Step 3100: Loss=3.6635, PPL=39.00, LR=3.85e-04

Epoch 2 结果:
  训练损失: 4.0957, 困惑度: 60.08
  验证损失: 3.4367, 困惑度: 31.09
检查点已保存: runs/20251108_140919/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 3.4367)

==================================================
Epoch 3/50
==================================================

Step 0: Loss=3.4310, PPL=30.91, LR=3.86e-04

Step 100: Loss=3.7728, PPL=43.50, LR=3.92e-04

Step 200: Loss=3.3682, PPL=29.03, LR=3.98e-04

Step 300: Loss=3.6902, PPL=40.05, LR=4.05e-04

Step 400: Loss=3.7912, PPL=44.31, LR=4.11e-04

Step 500: Loss=3.4051, PPL=30.12, LR=4.17e-04

Step 600: Loss=3.4680, PPL=32.07, LR=4.23e-04

Step 700: Loss=3.6703, PPL=39.26, LR=4.29e-04

Step 800: Loss=3.6285, PPL=37.66, LR=4.35e-04

Step 900: Loss=3.5239, PPL=33.92, LR=4.42e-04

Step 1000: Loss=3.4695, PPL=32.12, LR=4.48e-04

Step 1100: Loss=3.3400, PPL=28.22, LR=4.54e-04

Step 1200: Loss=3.4193, PPL=30.55, LR=4.60e-04

Step 1300: Loss=3.3352, PPL=28.08, LR=4.66e-04

Step 1400: Loss=3.4374, PPL=31.11, LR=4.73e-04

Step 1500: Loss=3.2181, PPL=24.98, LR=4.79e-04

Step 1600: Loss=3.4253, PPL=30.73, LR=4.85e-04

Step 1700: Loss=3.4666, PPL=32.03, LR=4.91e-04

Step 1800: Loss=3.0595, PPL=21.32, LR=4.93e-04

Step 1900: Loss=3.3788, PPL=29.34, LR=4.90e-04

Step 2000: Loss=3.3696, PPL=29.07, LR=4.87e-04

Step 2100: Loss=3.4107, PPL=30.29, LR=4.84e-04

Step 2200: Loss=3.4211, PPL=30.60, LR=4.81e-04

Step 2300: Loss=3.2424, PPL=25.60, LR=4.78e-04

Step 2400: Loss=3.4063, PPL=30.15, LR=4.75e-04

Step 2500: Loss=3.0652, PPL=21.44, LR=4.72e-04

Step 2600: Loss=3.1119, PPL=22.46, LR=4.70e-04

Step 2700: Loss=3.4459, PPL=31.37, LR=4.67e-04

Step 2800: Loss=3.2687, PPL=26.28, LR=4.65e-04

Step 2900: Loss=3.2353, PPL=25.41, LR=4.62e-04

Step 3000: Loss=3.2337, PPL=25.37, LR=4.59e-04

Step 3100: Loss=3.1876, PPL=24.23, LR=4.57e-04

Epoch 3 结果:
  训练损失: 3.4185, 困惑度: 30.52
  验证损失: 2.9562, 困惑度: 19.23
  验证BLEU: 0.0184 (1.84%)
检查点已保存: runs/20251108_140919/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.9562)

==================================================
Epoch 4/50
==================================================

Step 0: Loss=3.0126, PPL=20.34, LR=4.56e-04

Step 100: Loss=2.9475, PPL=19.06, LR=4.54e-04

Step 200: Loss=3.1720, PPL=23.86, LR=4.52e-04

Step 300: Loss=3.3034, PPL=27.20, LR=4.49e-04

Step 400: Loss=3.1157, PPL=22.55, LR=4.47e-04

Step 500: Loss=3.0444, PPL=21.00, LR=4.45e-04

Step 600: Loss=3.1869, PPL=24.21, LR=4.42e-04

Step 700: Loss=2.9514, PPL=19.13, LR=4.40e-04

Step 800: Loss=3.2287, PPL=25.25, LR=4.38e-04

Step 900: Loss=3.2570, PPL=25.97, LR=4.36e-04

Step 1000: Loss=3.0798, PPL=21.75, LR=4.34e-04

Step 1100: Loss=2.9007, PPL=18.19, LR=4.32e-04

Step 1200: Loss=2.9648, PPL=19.39, LR=4.30e-04

Step 1300: Loss=2.9874, PPL=19.83, LR=4.28e-04

Step 1400: Loss=3.0652, PPL=21.44, LR=4.26e-04

Step 1500: Loss=3.0377, PPL=20.86, LR=4.24e-04

Step 1600: Loss=3.0574, PPL=21.27, LR=4.22e-04

Step 1700: Loss=2.9668, PPL=19.43, LR=4.20e-04

Step 1800: Loss=3.0361, PPL=20.82, LR=4.18e-04

Step 1900: Loss=2.9648, PPL=19.39, LR=4.16e-04

Step 2000: Loss=2.7977, PPL=16.41, LR=4.14e-04

Step 2100: Loss=3.1961, PPL=24.44, LR=4.13e-04

Step 2200: Loss=3.0462, PPL=21.04, LR=4.11e-04

Step 2300: Loss=2.9421, PPL=18.96, LR=4.09e-04

Step 2400: Loss=3.0433, PPL=20.97, LR=4.07e-04

Step 2500: Loss=3.1735, PPL=23.89, LR=4.06e-04

Step 2600: Loss=3.1406, PPL=23.12, LR=4.04e-04

Step 2700: Loss=2.9194, PPL=18.53, LR=4.02e-04

Step 2800: Loss=2.9692, PPL=19.48, LR=4.01e-04

Step 2900: Loss=2.9182, PPL=18.51, LR=3.99e-04

Step 3000: Loss=2.9452, PPL=19.01, LR=3.97e-04

Step 3100: Loss=2.7828, PPL=16.16, LR=3.96e-04

Epoch 4 结果:
  训练损失: 3.0041, 困惑度: 20.17
  验证损失: 2.6914, 困惑度: 14.75
检查点已保存: runs/20251108_140919/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.6914)

==================================================
Epoch 5/50
==================================================

Step 0: Loss=2.8739, PPL=17.71, LR=3.95e-04

Step 100: Loss=2.7333, PPL=15.38, LR=3.94e-04

Step 200: Loss=2.8000, PPL=16.44, LR=3.92e-04

Step 300: Loss=2.6215, PPL=13.76, LR=3.91e-04

Step 400: Loss=2.9158, PPL=18.46, LR=3.89e-04

Step 500: Loss=2.7466, PPL=15.59, LR=3.88e-04

Step 600: Loss=2.5603, PPL=12.94, LR=3.86e-04

Step 700: Loss=2.5164, PPL=12.38, LR=3.85e-04

Step 800: Loss=2.6872, PPL=14.69, LR=3.83e-04

Step 900: Loss=2.7742, PPL=16.03, LR=3.82e-04

Step 1000: Loss=2.8735, PPL=17.70, LR=3.80e-04

Step 1100: Loss=3.0239, PPL=20.57, LR=3.79e-04

Step 1200: Loss=2.5455, PPL=12.75, LR=3.78e-04

Step 1300: Loss=2.7487, PPL=15.62, LR=3.76e-04

Step 1400: Loss=2.8786, PPL=17.79, LR=3.75e-04

Step 1500: Loss=2.6638, PPL=14.35, LR=3.73e-04

Step 1600: Loss=2.9838, PPL=19.76, LR=3.72e-04

Step 1700: Loss=2.7207, PPL=15.19, LR=3.71e-04

Step 1800: Loss=2.6275, PPL=13.84, LR=3.70e-04

Step 1900: Loss=2.6311, PPL=13.89, LR=3.68e-04

Step 2000: Loss=2.9538, PPL=19.18, LR=3.67e-04

Step 2100: Loss=2.6025, PPL=13.50, LR=3.66e-04

Step 2200: Loss=2.7719, PPL=15.99, LR=3.64e-04

Step 2300: Loss=2.6968, PPL=14.83, LR=3.63e-04

Step 2400: Loss=2.6619, PPL=14.32, LR=3.62e-04

Step 2500: Loss=2.7608, PPL=15.81, LR=3.61e-04

Step 2600: Loss=2.8901, PPL=18.00, LR=3.60e-04

Step 2700: Loss=2.6343, PPL=13.93, LR=3.58e-04

Step 2800: Loss=2.7792, PPL=16.11, LR=3.57e-04

Step 2900: Loss=2.6855, PPL=14.67, LR=3.56e-04

Step 3000: Loss=2.7544, PPL=15.71, LR=3.55e-04

Step 3100: Loss=2.8544, PPL=17.36, LR=3.54e-04

Epoch 5 结果:
  训练损失: 2.7429, 困惑度: 15.53
  验证损失: 2.5170, 困惑度: 12.39
检查点已保存: runs/20251108_140919/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.5170)
检查点已保存: runs/20251108_140919/checkpoints/checkpoint_epoch_5.pt
训练曲线已保存: runs/20251108_140919/figures/training_curves.png

==================================================
Epoch 6/50
==================================================

Step 0: Loss=2.7052, PPL=14.96, LR=3.54e-04

Step 100: Loss=2.2310, PPL=9.31, LR=3.52e-04

Step 200: Loss=2.5513, PPL=12.82, LR=3.51e-04

Step 300: Loss=2.5112, PPL=12.32, LR=3.50e-04

Step 400: Loss=2.6547, PPL=14.22, LR=3.49e-04

Step 500: Loss=2.4758, PPL=11.89, LR=3.48e-04

Step 600: Loss=2.4128, PPL=11.17, LR=3.47e-04

Step 700: Loss=2.4884, PPL=12.04, LR=3.46e-04

Step 800: Loss=2.4757, PPL=11.89, LR=3.45e-04

Step 900: Loss=2.7023, PPL=14.91, LR=3.44e-04

Step 1000: Loss=2.6374, PPL=13.98, LR=3.43e-04

Step 1100: Loss=2.6140, PPL=13.65, LR=3.42e-04

Step 1200: Loss=2.4583, PPL=11.69, LR=3.41e-04

Step 1300: Loss=2.4755, PPL=11.89, LR=3.40e-04

Step 1400: Loss=2.6761, PPL=14.53, LR=3.39e-04

Step 1500: Loss=2.4569, PPL=11.67, LR=3.38e-04

Step 1600: Loss=2.5035, PPL=12.23, LR=3.37e-04

Step 1700: Loss=2.5074, PPL=12.27, LR=3.36e-04

Step 1800: Loss=2.7153, PPL=15.11, LR=3.35e-04

Step 1900: Loss=2.6381, PPL=13.99, LR=3.34e-04

Step 2000: Loss=2.5446, PPL=12.74, LR=3.33e-04

Step 2100: Loss=2.6997, PPL=14.87, LR=3.32e-04

Step 2200: Loss=2.3758, PPL=10.76, LR=3.31e-04

Step 2300: Loss=2.5856, PPL=13.27, LR=3.30e-04

Step 2400: Loss=2.5231, PPL=12.47, LR=3.29e-04

Step 2500: Loss=2.6348, PPL=13.94, LR=3.28e-04

Step 2600: Loss=2.5698, PPL=13.06, LR=3.27e-04

Step 2700: Loss=2.6273, PPL=13.84, LR=3.26e-04

Step 2800: Loss=2.5687, PPL=13.05, LR=3.26e-04

Step 2900: Loss=2.5897, PPL=13.33, LR=3.25e-04

Step 3000: Loss=2.6492, PPL=14.14, LR=3.24e-04

Step 3100: Loss=2.6562, PPL=14.24, LR=3.23e-04

Epoch 6 结果:
  训练损失: 2.5712, 困惑度: 13.08
  验证损失: 2.4127, 困惑度: 11.16
  验证BLEU: 0.0317 (3.17%)
检查点已保存: runs/20251108_140919/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.4127)

==================================================
Epoch 7/50
==================================================

Step 0: Loss=2.3103, PPL=10.08, LR=3.23e-04

Step 100: Loss=2.3457, PPL=10.44, LR=3.22e-04

Step 200: Loss=2.3043, PPL=10.02, LR=3.21e-04

Step 300: Loss=2.2996, PPL=9.97, LR=3.20e-04

Step 400: Loss=2.2943, PPL=9.92, LR=3.19e-04

Step 500: Loss=2.3076, PPL=10.05, LR=3.19e-04

Step 600: Loss=2.2498, PPL=9.49, LR=3.18e-04

Step 700: Loss=2.5173, PPL=12.39, LR=3.17e-04

Step 800: Loss=2.5826, PPL=13.23, LR=3.16e-04

Step 900: Loss=2.2217, PPL=9.22, LR=3.15e-04

Step 1000: Loss=2.5216, PPL=12.45, LR=3.14e-04

Step 1100: Loss=2.3645, PPL=10.64, LR=3.14e-04

Step 1200: Loss=2.3538, PPL=10.53, LR=3.13e-04

Step 1300: Loss=2.6090, PPL=13.59, LR=3.12e-04

Step 1400: Loss=2.2596, PPL=9.58, LR=3.11e-04

Step 1500: Loss=2.5327, PPL=12.59, LR=3.11e-04

Step 1600: Loss=2.4184, PPL=11.23, LR=3.10e-04

Step 1700: Loss=2.4894, PPL=12.05, LR=3.09e-04

Step 1800: Loss=2.3342, PPL=10.32, LR=3.08e-04

Step 1900: Loss=2.5867, PPL=13.29, LR=3.08e-04

Step 2000: Loss=2.6441, PPL=14.07, LR=3.07e-04

Step 2100: Loss=2.4424, PPL=11.50, LR=3.06e-04

Step 2200: Loss=2.5502, PPL=12.81, LR=3.05e-04

Step 2300: Loss=2.3392, PPL=10.37, LR=3.05e-04

Step 2400: Loss=2.3423, PPL=10.40, LR=3.04e-04

Step 2500: Loss=2.2370, PPL=9.37, LR=3.03e-04

Step 2600: Loss=2.5352, PPL=12.62, LR=3.02e-04

Step 2700: Loss=2.4429, PPL=11.51, LR=3.02e-04

Step 2800: Loss=2.3190, PPL=10.17, LR=3.01e-04

Step 2900: Loss=2.3443, PPL=10.43, LR=3.00e-04

Step 3000: Loss=2.6342, PPL=13.93, LR=3.00e-04

Step 3100: Loss=2.3901, PPL=10.92, LR=2.99e-04

Epoch 7 结果:
  训练损失: 2.4476, 困惑度: 11.56
  验证损失: 2.3735, 困惑度: 10.73
检查点已保存: runs/20251108_140919/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.3735)

==================================================
Epoch 8/50
==================================================

Step 0: Loss=2.3030, PPL=10.00, LR=2.99e-04

Step 100: Loss=2.4784, PPL=11.92, LR=2.98e-04

Step 200: Loss=2.2001, PPL=9.03, LR=2.97e-04

Step 300: Loss=2.1286, PPL=8.40, LR=2.97e-04

Step 400: Loss=2.3215, PPL=10.19, LR=2.96e-04

Step 500: Loss=2.2963, PPL=9.94, LR=2.95e-04

Step 600: Loss=2.2976, PPL=9.95, LR=2.95e-04

Step 700: Loss=2.4626, PPL=11.74, LR=2.94e-04

Step 800: Loss=2.2059, PPL=9.08, LR=2.93e-04

Step 900: Loss=2.2776, PPL=9.75, LR=2.93e-04

Step 1000: Loss=2.4190, PPL=11.23, LR=2.92e-04

Step 1100: Loss=2.4034, PPL=11.06, LR=2.92e-04

Step 1200: Loss=2.1425, PPL=8.52, LR=2.91e-04

Step 1300: Loss=2.2308, PPL=9.31, LR=2.90e-04

Step 1400: Loss=2.3776, PPL=10.78, LR=2.90e-04

Step 1500: Loss=2.6335, PPL=13.92, LR=2.89e-04

Step 1600: Loss=2.0720, PPL=7.94, LR=2.88e-04

Step 1700: Loss=2.5299, PPL=12.55, LR=2.88e-04

Step 1800: Loss=2.1987, PPL=9.01, LR=2.87e-04

Step 1900: Loss=2.3575, PPL=10.56, LR=2.87e-04

Step 2000: Loss=2.3916, PPL=10.93, LR=2.86e-04

Step 2100: Loss=2.4045, PPL=11.07, LR=2.85e-04

Step 2200: Loss=2.4248, PPL=11.30, LR=2.85e-04

Step 2300: Loss=2.3964, PPL=10.98, LR=2.84e-04

Step 2400: Loss=2.6517, PPL=14.18, LR=2.84e-04

Step 2500: Loss=2.5312, PPL=12.57, LR=2.83e-04

Step 2600: Loss=2.4845, PPL=12.00, LR=2.82e-04

Step 2700: Loss=2.3874, PPL=10.88, LR=2.82e-04

Step 2800: Loss=2.2738, PPL=9.72, LR=2.81e-04

Step 2900: Loss=2.3494, PPL=10.48, LR=2.81e-04

Step 3000: Loss=2.3872, PPL=10.88, LR=2.80e-04

Step 3100: Loss=2.5568, PPL=12.89, LR=2.80e-04

Epoch 8 结果:
  训练损失: 2.3483, 困惑度: 10.47
  验证损失: 2.3467, 困惑度: 10.45
检查点已保存: runs/20251108_140919/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.3467)

==================================================
Epoch 9/50
==================================================

Step 0: Loss=2.0612, PPL=7.86, LR=2.80e-04

Step 100: Loss=2.0620, PPL=7.86, LR=2.79e-04

Step 200: Loss=2.0823, PPL=8.02, LR=2.78e-04

Step 300: Loss=2.3261, PPL=10.24, LR=2.78e-04

Step 400: Loss=2.1342, PPL=8.45, LR=2.77e-04

Step 500: Loss=2.2603, PPL=9.59, LR=2.77e-04

Step 600: Loss=2.2281, PPL=9.28, LR=2.76e-04

Step 700: Loss=2.2650, PPL=9.63, LR=2.76e-04

Step 800: Loss=2.1642, PPL=8.71, LR=2.75e-04

Step 900: Loss=2.1079, PPL=8.23, LR=2.75e-04

Step 1000: Loss=2.2729, PPL=9.71, LR=2.74e-04

Step 1100: Loss=2.1856, PPL=8.90, LR=2.74e-04

Step 1200: Loss=2.1507, PPL=8.59, LR=2.73e-04

Step 1300: Loss=2.2265, PPL=9.27, LR=2.73e-04

Step 1400: Loss=2.2394, PPL=9.39, LR=2.72e-04

Step 1500: Loss=2.1331, PPL=8.44, LR=2.71e-04

Step 1600: Loss=2.2848, PPL=9.82, LR=2.71e-04

Step 1700: Loss=2.1824, PPL=8.87, LR=2.70e-04

Step 1800: Loss=2.1592, PPL=8.66, LR=2.70e-04

Step 1900: Loss=2.3369, PPL=10.35, LR=2.69e-04

Step 2000: Loss=2.1579, PPL=8.65, LR=2.69e-04

Step 2100: Loss=2.1461, PPL=8.55, LR=2.68e-04

Step 2200: Loss=2.1914, PPL=8.95, LR=2.68e-04

Step 2300: Loss=2.3941, PPL=10.96, LR=2.67e-04

Step 2400: Loss=2.4593, PPL=11.70, LR=2.67e-04

Step 2500: Loss=2.1756, PPL=8.81, LR=2.66e-04

Step 2600: Loss=2.2956, PPL=9.93, LR=2.66e-04

Step 2700: Loss=2.3645, PPL=10.64, LR=2.66e-04

Step 2800: Loss=2.2333, PPL=9.33, LR=2.65e-04

Step 2900: Loss=2.2573, PPL=9.56, LR=2.65e-04

Step 3000: Loss=2.1829, PPL=8.87, LR=2.64e-04

Step 3100: Loss=2.3628, PPL=10.62, LR=2.64e-04

Epoch 9 结果:
  训练损失: 2.2655, 困惑度: 9.64
  验证损失: 2.3225, 困惑度: 10.20
  验证BLEU: 0.0317 (3.17%)
检查点已保存: runs/20251108_140919/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.3225)

==================================================
Epoch 10/50
==================================================

Step 0: Loss=2.1860, PPL=8.90, LR=2.64e-04

Step 100: Loss=1.9623, PPL=7.12, LR=2.63e-04

Step 200: Loss=2.1241, PPL=8.37, LR=2.63e-04

Step 300: Loss=1.8959, PPL=6.66, LR=2.62e-04

Step 400: Loss=2.1769, PPL=8.82, LR=2.62e-04

Step 500: Loss=2.0408, PPL=7.70, LR=2.61e-04

Step 600: Loss=2.1342, PPL=8.45, LR=2.61e-04

Step 700: Loss=2.1657, PPL=8.72, LR=2.60e-04

Step 800: Loss=2.1398, PPL=8.50, LR=2.60e-04

Step 900: Loss=2.1533, PPL=8.61, LR=2.59e-04

Step 1000: Loss=2.1904, PPL=8.94, LR=2.59e-04

Step 1100: Loss=2.3171, PPL=10.15, LR=2.59e-04

Step 1200: Loss=2.0677, PPL=7.91, LR=2.58e-04

Step 1300: Loss=2.1996, PPL=9.02, LR=2.58e-04

Step 1400: Loss=2.1620, PPL=8.69, LR=2.57e-04

Step 1500: Loss=2.2307, PPL=9.31, LR=2.57e-04

Step 1600: Loss=2.1920, PPL=8.95, LR=2.56e-04

Step 1700: Loss=2.2611, PPL=9.59, LR=2.56e-04

Step 1800: Loss=2.0861, PPL=8.05, LR=2.55e-04

Step 1900: Loss=2.1243, PPL=8.37, LR=2.55e-04

Step 2000: Loss=2.5141, PPL=12.36, LR=2.55e-04

Step 2100: Loss=2.4399, PPL=11.47, LR=2.54e-04

Step 2200: Loss=2.2915, PPL=9.89, LR=2.54e-04

Step 2300: Loss=2.1087, PPL=8.24, LR=2.53e-04

Step 2400: Loss=2.2986, PPL=9.96, LR=2.53e-04

Step 2500: Loss=2.1899, PPL=8.93, LR=2.53e-04

Step 2600: Loss=2.0962, PPL=8.14, LR=2.52e-04

Step 2700: Loss=2.3882, PPL=10.89, LR=2.52e-04

Step 2800: Loss=1.9843, PPL=7.27, LR=2.51e-04

Step 2900: Loss=2.1881, PPL=8.92, LR=2.51e-04

Step 3000: Loss=2.2027, PPL=9.05, LR=2.50e-04

Step 3100: Loss=2.5028, PPL=12.22, LR=2.50e-04

Epoch 10 结果:
  训练损失: 2.1946, 困惑度: 8.98
  验证损失: 2.3176, 困惑度: 10.15
检查点已保存: runs/20251108_140919/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.3176)
检查点已保存: runs/20251108_140919/checkpoints/checkpoint_epoch_10.pt
训练曲线已保存: runs/20251108_140919/figures/training_curves.png

==================================================
Epoch 11/50
==================================================

Step 0: Loss=1.9868, PPL=7.29, LR=2.50e-04

Step 100: Loss=1.8777, PPL=6.54, LR=2.50e-04

Step 200: Loss=2.1549, PPL=8.63, LR=2.49e-04

Step 300: Loss=1.9499, PPL=7.03, LR=2.49e-04

Step 400: Loss=2.1224, PPL=8.35, LR=2.48e-04

Step 500: Loss=2.0735, PPL=7.95, LR=2.48e-04

Step 600: Loss=2.0891, PPL=8.08, LR=2.48e-04

Step 700: Loss=2.0587, PPL=7.84, LR=2.47e-04

Step 800: Loss=2.0484, PPL=7.76, LR=2.47e-04

Step 900: Loss=2.1511, PPL=8.59, LR=2.46e-04

Step 1000: Loss=2.1612, PPL=8.68, LR=2.46e-04

Step 1100: Loss=2.0709, PPL=7.93, LR=2.46e-04

Step 1200: Loss=2.3306, PPL=10.28, LR=2.45e-04

Step 1300: Loss=2.3006, PPL=9.98, LR=2.45e-04

Step 1400: Loss=1.9554, PPL=7.07, LR=2.45e-04

Step 1500: Loss=2.0463, PPL=7.74, LR=2.44e-04

Step 1600: Loss=2.1365, PPL=8.47, LR=2.44e-04

Step 1700: Loss=2.0684, PPL=7.91, LR=2.43e-04

Step 1800: Loss=2.2909, PPL=9.88, LR=2.43e-04

Step 1900: Loss=2.1801, PPL=8.85, LR=2.43e-04

Step 2000: Loss=2.2656, PPL=9.64, LR=2.42e-04

Step 2100: Loss=2.1925, PPL=8.96, LR=2.42e-04

Step 2200: Loss=2.2589, PPL=9.57, LR=2.42e-04

Step 2300: Loss=2.2106, PPL=9.12, LR=2.41e-04

Step 2400: Loss=2.1124, PPL=8.27, LR=2.41e-04

Step 2500: Loss=2.3681, PPL=10.68, LR=2.41e-04

Step 2600: Loss=2.0701, PPL=7.93, LR=2.40e-04

Step 2700: Loss=2.0235, PPL=7.57, LR=2.40e-04

Step 2800: Loss=2.1528, PPL=8.61, LR=2.39e-04

Step 2900: Loss=2.3279, PPL=10.26, LR=2.39e-04

Step 3000: Loss=2.0844, PPL=8.04, LR=2.39e-04

Step 3100: Loss=2.0411, PPL=7.70, LR=2.38e-04

Epoch 11 结果:
  训练损失: 2.1335, 困惑度: 8.44
  验证损失: 2.2952, 困惑度: 9.93
检查点已保存: runs/20251108_140919/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.2952)

==================================================
Epoch 12/50
==================================================

Step 0: Loss=1.9993, PPL=7.38, LR=2.38e-04

Step 100: Loss=1.7192, PPL=5.58, LR=2.38e-04

Step 200: Loss=2.0946, PPL=8.12, LR=2.38e-04

Step 300: Loss=1.9883, PPL=7.30, LR=2.37e-04

Step 400: Loss=1.8974, PPL=6.67, LR=2.37e-04

Step 500: Loss=1.9322, PPL=6.90, LR=2.37e-04

Step 600: Loss=2.0428, PPL=7.71, LR=2.36e-04

Step 700: Loss=2.0318, PPL=7.63, LR=2.36e-04

Step 800: Loss=2.0867, PPL=8.06, LR=2.36e-04

Step 900: Loss=1.9708, PPL=7.18, LR=2.35e-04

Step 1000: Loss=2.1181, PPL=8.32, LR=2.35e-04

Step 1100: Loss=2.1637, PPL=8.70, LR=2.35e-04

Step 1200: Loss=2.1592, PPL=8.66, LR=2.34e-04

Step 1300: Loss=1.9825, PPL=7.26, LR=2.34e-04

Step 1400: Loss=2.1204, PPL=8.33, LR=2.34e-04

Step 1500: Loss=2.2510, PPL=9.50, LR=2.33e-04

Step 1600: Loss=2.1411, PPL=8.51, LR=2.33e-04

Step 1700: Loss=2.0501, PPL=7.77, LR=2.33e-04

Step 1800: Loss=2.1129, PPL=8.27, LR=2.32e-04

Step 1900: Loss=2.1609, PPL=8.68, LR=2.32e-04

Step 2000: Loss=2.0727, PPL=7.95, LR=2.32e-04

Step 2100: Loss=2.1663, PPL=8.73, LR=2.31e-04

Step 2200: Loss=2.1003, PPL=8.17, LR=2.31e-04

Step 2300: Loss=1.9927, PPL=7.34, LR=2.31e-04

Step 2400: Loss=2.0075, PPL=7.44, LR=2.30e-04

Step 2500: Loss=2.1546, PPL=8.62, LR=2.30e-04

Step 2600: Loss=2.1893, PPL=8.93, LR=2.30e-04

Step 2700: Loss=2.2488, PPL=9.48, LR=2.30e-04

Step 2800: Loss=2.3525, PPL=10.51, LR=2.29e-04

Step 2900: Loss=2.0090, PPL=7.46, LR=2.29e-04

Step 3000: Loss=2.2202, PPL=9.21, LR=2.29e-04

Step 3100: Loss=2.1889, PPL=8.93, LR=2.28e-04

Epoch 12 结果:
  训练损失: 2.0787, 困惑度: 7.99
  验证损失: 2.2952, 困惑度: 9.93
  验证BLEU: 0.0338 (3.38%)
  验证损失未改善 (patience: 1/5)
  当前: 2.2952, 最佳: 2.2952, 差距: 0.0000
检查点已保存: runs/20251108_140919/checkpoints/best_model_bleu.pt
  ✓ 保存最佳BLEU模型 (BLEU: 0.0338)

==================================================
Epoch 13/50
==================================================

Step 0: Loss=1.9221, PPL=6.84, LR=2.28e-04

Step 100: Loss=1.9922, PPL=7.33, LR=2.28e-04

Step 200: Loss=1.8932, PPL=6.64, LR=2.28e-04

Step 300: Loss=1.8717, PPL=6.50, LR=2.27e-04

Step 400: Loss=1.9806, PPL=7.25, LR=2.27e-04

Step 500: Loss=1.7782, PPL=5.92, LR=2.27e-04

Step 600: Loss=1.8840, PPL=6.58, LR=2.26e-04

Step 700: Loss=1.9246, PPL=6.85, LR=2.26e-04

Step 800: Loss=1.8581, PPL=6.41, LR=2.26e-04

Step 900: Loss=2.0273, PPL=7.59, LR=2.26e-04

Step 1000: Loss=2.0336, PPL=7.64, LR=2.25e-04

Step 1100: Loss=2.0232, PPL=7.56, LR=2.25e-04

Step 1200: Loss=1.9895, PPL=7.31, LR=2.25e-04

Step 1300: Loss=1.9883, PPL=7.30, LR=2.24e-04

Step 1400: Loss=1.9983, PPL=7.38, LR=2.24e-04

Step 1500: Loss=2.0908, PPL=8.09, LR=2.24e-04

Step 1600: Loss=1.9940, PPL=7.34, LR=2.23e-04

Step 1700: Loss=2.0506, PPL=7.77, LR=2.23e-04

Step 1800: Loss=1.9296, PPL=6.89, LR=2.23e-04

Step 1900: Loss=1.9559, PPL=7.07, LR=2.23e-04

Step 2000: Loss=2.1854, PPL=8.89, LR=2.22e-04

Step 2100: Loss=2.0423, PPL=7.71, LR=2.22e-04

Step 2200: Loss=2.1676, PPL=8.74, LR=2.22e-04

Step 2300: Loss=1.9614, PPL=7.11, LR=2.22e-04

Step 2400: Loss=2.1406, PPL=8.50, LR=2.21e-04

Step 2500: Loss=2.2046, PPL=9.07, LR=2.21e-04

Step 2600: Loss=1.9747, PPL=7.20, LR=2.21e-04

Step 2700: Loss=2.2012, PPL=9.04, LR=2.20e-04

Step 2800: Loss=2.1360, PPL=8.47, LR=2.20e-04

Step 2900: Loss=2.0240, PPL=7.57, LR=2.20e-04

Step 3000: Loss=2.1770, PPL=8.82, LR=2.20e-04

Step 3100: Loss=2.3063, PPL=10.04, LR=2.19e-04

Epoch 13 结果:
  训练损失: 2.0289, 困惑度: 7.61
  验证损失: 2.3102, 困惑度: 10.08
  验证损失未改善 (patience: 2/5)
  当前: 2.3102, 最佳: 2.2952, 差距: 0.0150

==================================================
Epoch 14/50
==================================================

Step 0: Loss=1.9758, PPL=7.21, LR=2.19e-04

Step 100: Loss=1.7826, PPL=5.95, LR=2.19e-04

Step 200: Loss=1.6653, PPL=5.29, LR=2.19e-04

Step 300: Loss=1.7727, PPL=5.89, LR=2.18e-04

Step 400: Loss=1.9761, PPL=7.21, LR=2.18e-04

Step 500: Loss=1.8472, PPL=6.34, LR=2.18e-04

Step 600: Loss=1.8810, PPL=6.56, LR=2.18e-04

Step 700: Loss=1.8528, PPL=6.38, LR=2.17e-04

Step 800: Loss=1.9235, PPL=6.84, LR=2.17e-04

Step 900: Loss=1.9672, PPL=7.15, LR=2.17e-04

Step 1000: Loss=2.0579, PPL=7.83, LR=2.17e-04

Step 1100: Loss=1.9213, PPL=6.83, LR=2.16e-04

Step 1200: Loss=1.9284, PPL=6.88, LR=2.16e-04

Step 1300: Loss=2.0416, PPL=7.70, LR=2.16e-04

Step 1400: Loss=1.9682, PPL=7.16, LR=2.16e-04

Step 1500: Loss=1.9265, PPL=6.87, LR=2.15e-04

Step 1600: Loss=2.1438, PPL=8.53, LR=2.15e-04

Step 1700: Loss=2.0684, PPL=7.91, LR=2.15e-04

Step 1800: Loss=1.8491, PPL=6.35, LR=2.15e-04

Step 1900: Loss=1.8296, PPL=6.23, LR=2.14e-04

Step 2000: Loss=1.8912, PPL=6.63, LR=2.14e-04

Step 2100: Loss=1.8572, PPL=6.41, LR=2.14e-04

Step 2200: Loss=1.9404, PPL=6.96, LR=2.14e-04

Step 2300: Loss=1.9838, PPL=7.27, LR=2.13e-04

Step 2400: Loss=2.0635, PPL=7.87, LR=2.13e-04

Step 2500: Loss=1.9326, PPL=6.91, LR=2.13e-04

Step 2600: Loss=2.1321, PPL=8.43, LR=2.13e-04

Step 2700: Loss=2.0810, PPL=8.01, LR=2.12e-04

Step 2800: Loss=1.8832, PPL=6.57, LR=2.12e-04

Step 2900: Loss=1.8272, PPL=6.22, LR=2.12e-04

Step 3000: Loss=2.0573, PPL=7.82, LR=2.12e-04

Step 3100: Loss=2.0375, PPL=7.67, LR=2.11e-04

Epoch 14 结果:
  训练损失: 1.9823, 困惑度: 7.26
  验证损失: 2.3009, 困惑度: 9.98
  验证损失未改善 (patience: 3/5)
  当前: 2.3009, 最佳: 2.2952, 差距: 0.0057

==================================================
Epoch 15/50
==================================================

Step 0: Loss=1.8405, PPL=6.30, LR=2.11e-04

Step 100: Loss=1.9493, PPL=7.02, LR=2.11e-04

Step 200: Loss=1.9187, PPL=6.81, LR=2.11e-04

Step 300: Loss=1.9202, PPL=6.82, LR=2.11e-04

Step 400: Loss=1.8150, PPL=6.14, LR=2.10e-04

Step 500: Loss=1.7643, PPL=5.84, LR=2.10e-04

Step 600: Loss=1.7998, PPL=6.05, LR=2.10e-04

Step 700: Loss=1.9362, PPL=6.93, LR=2.10e-04

Step 800: Loss=1.9911, PPL=7.32, LR=2.09e-04

Step 900: Loss=1.8125, PPL=6.13, LR=2.09e-04

Step 1000: Loss=2.1123, PPL=8.27, LR=2.09e-04

Step 1100: Loss=1.6876, PPL=5.41, LR=2.09e-04

Step 1200: Loss=2.0526, PPL=7.79, LR=2.08e-04

Step 1300: Loss=1.8946, PPL=6.65, LR=2.08e-04

Step 1400: Loss=2.0282, PPL=7.60, LR=2.08e-04

Step 1500: Loss=1.9322, PPL=6.90, LR=2.08e-04

Step 1600: Loss=2.0698, PPL=7.92, LR=2.08e-04

Step 1700: Loss=1.9991, PPL=7.38, LR=2.07e-04

Step 1800: Loss=1.8237, PPL=6.19, LR=2.07e-04

Step 1900: Loss=2.0112, PPL=7.47, LR=2.07e-04

Step 2000: Loss=2.2063, PPL=9.08, LR=2.07e-04

Step 2100: Loss=1.8780, PPL=6.54, LR=2.06e-04

Step 2200: Loss=2.0442, PPL=7.72, LR=2.06e-04

Step 2300: Loss=1.9416, PPL=6.97, LR=2.06e-04

Step 2400: Loss=1.9555, PPL=7.07, LR=2.06e-04

Step 2500: Loss=2.0906, PPL=8.09, LR=2.05e-04

Step 2600: Loss=2.0913, PPL=8.10, LR=2.05e-04

Step 2700: Loss=1.7812, PPL=5.94, LR=2.05e-04

Step 2800: Loss=1.9928, PPL=7.34, LR=2.05e-04

Step 2900: Loss=2.0107, PPL=7.47, LR=2.05e-04

Step 3000: Loss=2.0213, PPL=7.55, LR=2.04e-04

Step 3100: Loss=2.0032, PPL=7.41, LR=2.04e-04

Epoch 15 结果:
  训练损失: 1.9416, 困惑度: 6.97
  验证损失: 2.2897, 困惑度: 9.87
  验证BLEU: 0.0373 (3.73%)
检查点已保存: runs/20251108_140919/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.2897)
检查点已保存: runs/20251108_140919/checkpoints/checkpoint_epoch_15.pt
训练曲线已保存: runs/20251108_140919/figures/training_curves.png

==================================================
Epoch 16/50
==================================================

Step 0: Loss=1.7419, PPL=5.71, LR=2.04e-04

Step 100: Loss=1.6193, PPL=5.05, LR=2.04e-04

Step 200: Loss=1.7632, PPL=5.83, LR=2.04e-04

Step 300: Loss=1.8955, PPL=6.66, LR=2.03e-04

Step 400: Loss=1.7695, PPL=5.87, LR=2.03e-04

Step 500: Loss=1.7528, PPL=5.77, LR=2.03e-04

Step 600: Loss=1.9450, PPL=6.99, LR=2.03e-04

Step 700: Loss=1.9426, PPL=6.98, LR=2.03e-04

Step 800: Loss=1.8319, PPL=6.25, LR=2.02e-04

Step 900: Loss=1.7950, PPL=6.02, LR=2.02e-04

Step 1000: Loss=1.9932, PPL=7.34, LR=2.02e-04

Step 1100: Loss=2.0411, PPL=7.70, LR=2.02e-04

Step 1200: Loss=1.6942, PPL=5.44, LR=2.02e-04

Step 1300: Loss=1.8763, PPL=6.53, LR=2.01e-04

Step 1400: Loss=1.8175, PPL=6.16, LR=2.01e-04

Step 1500: Loss=2.1307, PPL=8.42, LR=2.01e-04

Step 1600: Loss=1.9665, PPL=7.15, LR=2.01e-04

Step 1700: Loss=2.0813, PPL=8.02, LR=2.01e-04

Step 1800: Loss=1.9938, PPL=7.34, LR=2.00e-04

Step 1900: Loss=1.8245, PPL=6.20, LR=2.00e-04

Step 2000: Loss=1.9507, PPL=7.03, LR=2.00e-04

Step 2100: Loss=1.9330, PPL=6.91, LR=2.00e-04

Step 2200: Loss=1.7868, PPL=5.97, LR=1.99e-04

Step 2300: Loss=2.1157, PPL=8.30, LR=1.99e-04

Step 2400: Loss=1.7352, PPL=5.67, LR=1.99e-04

Step 2500: Loss=1.7694, PPL=5.87, LR=1.99e-04

Step 2600: Loss=2.0663, PPL=7.90, LR=1.99e-04

Step 2700: Loss=1.9807, PPL=7.25, LR=1.98e-04

Step 2800: Loss=1.9679, PPL=7.16, LR=1.98e-04

Step 2900: Loss=2.1594, PPL=8.67, LR=1.98e-04

Step 3000: Loss=2.0804, PPL=8.01, LR=1.98e-04

Step 3100: Loss=2.0258, PPL=7.58, LR=1.98e-04

Epoch 16 结果:
  训练损失: 1.9016, 困惑度: 6.70
  验证损失: 2.3019, 困惑度: 9.99
  验证损失未改善 (patience: 1/5)
  当前: 2.3019, 最佳: 2.2897, 差距: 0.0122

==================================================
Epoch 17/50
==================================================

Step 0: Loss=1.9793, PPL=7.24, LR=1.98e-04

Step 100: Loss=1.7865, PPL=5.97, LR=1.97e-04

Step 200: Loss=1.8143, PPL=6.14, LR=1.97e-04

Step 300: Loss=1.7307, PPL=5.64, LR=1.97e-04

Step 400: Loss=1.8733, PPL=6.51, LR=1.97e-04

Step 500: Loss=1.9056, PPL=6.72, LR=1.97e-04

Step 600: Loss=1.6113, PPL=5.01, LR=1.96e-04

Step 700: Loss=1.8500, PPL=6.36, LR=1.96e-04

Step 800: Loss=1.8970, PPL=6.67, LR=1.96e-04

Step 900: Loss=1.9791, PPL=7.24, LR=1.96e-04

Step 1000: Loss=1.8731, PPL=6.51, LR=1.96e-04

Step 1100: Loss=2.0225, PPL=7.56, LR=1.96e-04

Step 1200: Loss=1.7742, PPL=5.90, LR=1.95e-04

Step 1300: Loss=1.6705, PPL=5.31, LR=1.95e-04

Step 1400: Loss=2.0844, PPL=8.04, LR=1.95e-04

Step 1500: Loss=1.9148, PPL=6.79, LR=1.95e-04

Step 1600: Loss=1.7919, PPL=6.00, LR=1.95e-04

Step 1700: Loss=2.0269, PPL=7.59, LR=1.94e-04

Step 1800: Loss=1.9257, PPL=6.86, LR=1.94e-04

Step 1900: Loss=1.8905, PPL=6.62, LR=1.94e-04

Step 2000: Loss=1.8503, PPL=6.36, LR=1.94e-04

Step 2100: Loss=1.9051, PPL=6.72, LR=1.94e-04

Step 2200: Loss=2.1043, PPL=8.20, LR=1.93e-04

Step 2300: Loss=2.1012, PPL=8.18, LR=1.93e-04

Step 2400: Loss=1.8800, PPL=6.55, LR=1.93e-04

Step 2500: Loss=1.8832, PPL=6.57, LR=1.93e-04

Step 2600: Loss=1.9563, PPL=7.07, LR=1.93e-04

Step 2700: Loss=1.8699, PPL=6.49, LR=1.93e-04

Step 2800: Loss=1.8748, PPL=6.52, LR=1.92e-04

Step 2900: Loss=1.8859, PPL=6.59, LR=1.92e-04

Step 3000: Loss=2.0566, PPL=7.82, LR=1.92e-04

Step 3100: Loss=2.0316, PPL=7.63, LR=1.92e-04

Epoch 17 结果:
  训练损失: 1.8651, 困惑度: 6.46
  验证损失: 2.3117, 困惑度: 10.09
  验证损失未改善 (patience: 2/5)
  当前: 2.3117, 最佳: 2.2897, 差距: 0.0220

==================================================
Epoch 18/50
==================================================

Step 0: Loss=1.7234, PPL=5.60, LR=1.92e-04

Step 100: Loss=1.7025, PPL=5.49, LR=1.92e-04

Step 200: Loss=1.7785, PPL=5.92, LR=1.91e-04

Step 300: Loss=1.7916, PPL=6.00, LR=1.91e-04

Step 400: Loss=1.7377, PPL=5.68, LR=1.91e-04

Step 500: Loss=2.0268, PPL=7.59, LR=1.91e-04

Step 600: Loss=1.5589, PPL=4.75, LR=1.91e-04

Step 700: Loss=1.9517, PPL=7.04, LR=1.90e-04

Step 800: Loss=1.8327, PPL=6.25, LR=1.90e-04

Step 900: Loss=1.8098, PPL=6.11, LR=1.90e-04

Step 1000: Loss=1.7790, PPL=5.92, LR=1.90e-04

Step 1100: Loss=1.5711, PPL=4.81, LR=1.90e-04

Step 1200: Loss=1.8412, PPL=6.30, LR=1.90e-04

Step 1300: Loss=2.0679, PPL=7.91, LR=1.89e-04

Step 1400: Loss=1.7859, PPL=5.97, LR=1.89e-04

Step 1500: Loss=1.8485, PPL=6.35, LR=1.89e-04

Step 1600: Loss=2.0168, PPL=7.51, LR=1.89e-04

Step 1700: Loss=1.7752, PPL=5.90, LR=1.89e-04

Step 1800: Loss=1.8644, PPL=6.45, LR=1.89e-04

Step 1900: Loss=1.6585, PPL=5.25, LR=1.88e-04

Step 2000: Loss=1.9100, PPL=6.75, LR=1.88e-04

Step 2100: Loss=1.9620, PPL=7.11, LR=1.88e-04

Step 2200: Loss=1.7219, PPL=5.60, LR=1.88e-04

Step 2300: Loss=1.9852, PPL=7.28, LR=1.88e-04

Step 2400: Loss=2.0271, PPL=7.59, LR=1.88e-04

Step 2500: Loss=1.8131, PPL=6.13, LR=1.87e-04

Step 2600: Loss=1.8107, PPL=6.11, LR=1.87e-04

Step 2700: Loss=1.9367, PPL=6.94, LR=1.87e-04

Step 2800: Loss=1.8352, PPL=6.27, LR=1.87e-04

Step 2900: Loss=1.7018, PPL=5.48, LR=1.87e-04

Step 3000: Loss=2.0081, PPL=7.45, LR=1.87e-04

Step 3100: Loss=1.7984, PPL=6.04, LR=1.86e-04

Epoch 18 结果:
  训练损失: 1.8310, 困惑度: 6.24
  验证损失: 2.3110, 困惑度: 10.08
  验证BLEU: 0.0359 (3.59%)
  验证损失未改善 (patience: 3/5)
  当前: 2.3110, 最佳: 2.2897, 差距: 0.0213

==================================================
Epoch 19/50
==================================================

Step 0: Loss=1.7026, PPL=5.49, LR=1.86e-04

Step 100: Loss=1.7143, PPL=5.55, LR=1.86e-04

Step 200: Loss=1.7088, PPL=5.52, LR=1.86e-04

Step 300: Loss=1.7839, PPL=5.95, LR=1.86e-04

Step 400: Loss=1.7889, PPL=5.98, LR=1.86e-04

Step 500: Loss=1.7784, PPL=5.92, LR=1.86e-04

Step 600: Loss=1.7684, PPL=5.86, LR=1.85e-04

Step 700: Loss=1.7043, PPL=5.50, LR=1.85e-04

Step 800: Loss=1.6436, PPL=5.17, LR=1.85e-04

Step 900: Loss=1.8628, PPL=6.44, LR=1.85e-04

Step 1000: Loss=1.8658, PPL=6.46, LR=1.85e-04

Step 1100: Loss=1.8322, PPL=6.25, LR=1.85e-04

Step 1200: Loss=1.6798, PPL=5.36, LR=1.84e-04

Step 1300: Loss=1.6597, PPL=5.26, LR=1.84e-04

Step 1400: Loss=1.7851, PPL=5.96, LR=1.84e-04

Step 1500: Loss=1.8312, PPL=6.24, LR=1.84e-04

Step 1600: Loss=1.6899, PPL=5.42, LR=1.84e-04

Step 1700: Loss=1.7844, PPL=5.96, LR=1.84e-04

Step 1800: Loss=2.0087, PPL=7.45, LR=1.83e-04

Step 1900: Loss=1.8321, PPL=6.25, LR=1.83e-04

Step 2000: Loss=1.9225, PPL=6.84, LR=1.83e-04

Step 2100: Loss=1.8317, PPL=6.24, LR=1.83e-04

Step 2200: Loss=1.9447, PPL=6.99, LR=1.83e-04

Step 2300: Loss=1.8875, PPL=6.60, LR=1.83e-04

Step 2400: Loss=1.7466, PPL=5.74, LR=1.82e-04

Step 2500: Loss=1.9416, PPL=6.97, LR=1.82e-04

Step 2600: Loss=1.7755, PPL=5.90, LR=1.82e-04

Step 2700: Loss=2.0708, PPL=7.93, LR=1.82e-04

Step 2800: Loss=1.8172, PPL=6.15, LR=1.82e-04

Step 2900: Loss=1.8406, PPL=6.30, LR=1.82e-04

Step 3000: Loss=1.8962, PPL=6.66, LR=1.82e-04

Step 3100: Loss=1.9059, PPL=6.73, LR=1.81e-04

Epoch 19 结果:
  训练损失: 1.7985, 困惑度: 6.04
  验证损失: 2.3314, 困惑度: 10.29
  验证损失未改善 (patience: 4/5)
  当前: 2.3314, 最佳: 2.2897, 差距: 0.0417

==================================================
Epoch 20/50
==================================================

Step 0: Loss=1.5831, PPL=4.87, LR=1.81e-04

Step 100: Loss=1.7020, PPL=5.48, LR=1.81e-04

Step 200: Loss=1.6767, PPL=5.35, LR=1.81e-04

Step 300: Loss=1.7030, PPL=5.49, LR=1.81e-04

Step 400: Loss=1.4901, PPL=4.44, LR=1.81e-04

Step 500: Loss=1.7466, PPL=5.74, LR=1.81e-04

Step 600: Loss=1.8070, PPL=6.09, LR=1.80e-04

Step 700: Loss=1.7436, PPL=5.72, LR=1.80e-04

Step 800: Loss=1.6843, PPL=5.39, LR=1.80e-04

Step 900: Loss=1.8727, PPL=6.51, LR=1.80e-04

Step 1000: Loss=1.7415, PPL=5.71, LR=1.80e-04

Step 1100: Loss=1.7090, PPL=5.52, LR=1.80e-04

Step 1200: Loss=1.5610, PPL=4.76, LR=1.80e-04

Step 1300: Loss=1.7028, PPL=5.49, LR=1.79e-04

Step 1400: Loss=1.7658, PPL=5.85, LR=1.79e-04

Step 1500: Loss=1.7933, PPL=6.01, LR=1.79e-04

Step 1600: Loss=1.5639, PPL=4.78, LR=1.79e-04

Step 1700: Loss=1.7468, PPL=5.74, LR=1.79e-04

Step 1800: Loss=1.9098, PPL=6.75, LR=1.79e-04

Step 1900: Loss=1.7186, PPL=5.58, LR=1.79e-04

Step 2000: Loss=1.8001, PPL=6.05, LR=1.78e-04

Step 2100: Loss=1.7860, PPL=5.97, LR=1.78e-04

Step 2200: Loss=1.7144, PPL=5.55, LR=1.78e-04

Step 2300: Loss=1.8601, PPL=6.42, LR=1.78e-04

Step 2400: Loss=1.8742, PPL=6.52, LR=1.78e-04

Step 2500: Loss=2.0303, PPL=7.62, LR=1.78e-04

Step 2600: Loss=1.9091, PPL=6.75, LR=1.78e-04

Step 2700: Loss=1.8836, PPL=6.58, LR=1.77e-04

Step 2800: Loss=1.7681, PPL=5.86, LR=1.77e-04

Step 2900: Loss=1.9039, PPL=6.71, LR=1.77e-04

Step 3000: Loss=2.0015, PPL=7.40, LR=1.77e-04

Step 3100: Loss=1.6181, PPL=5.04, LR=1.77e-04

Epoch 20 结果:
  训练损失: 1.7683, 困惑度: 5.86
  验证损失: 2.3330, 困惑度: 10.31
  验证损失未改善 (patience: 5/5)
  当前: 2.3330, 最佳: 2.2897, 差距: 0.0433

==================================================
早停触发！验证损失在 5 个epoch内未改善
当前验证损失: 2.3330
最佳验证损失: 2.2897 (epoch 15)
最佳验证BLEU: 0.0373
==================================================
训练曲线已保存: runs/20251108_140919/figures/training_curves_final.png

============================================================
训练结束时间: 2025-11-08 17:22:33
============================================================
