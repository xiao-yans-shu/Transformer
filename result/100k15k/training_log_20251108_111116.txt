
============================================================
训练开始时间: 2025-11-08 11:11:16
============================================================

==================================================
运行名称: 20251108_111116
加载数据...
加载训练数据...
训练数据量: 206112，限制为: 100000
训练集大小: 100000
构建词汇表...
源语言词汇表大小: 15000
目标语言词汇表大小: 15000
加载验证数据...
验证集大小: 888
==================================================
创建模型...
模型参数统计:
  可训练参数: 67,195,544
  总参数: 67,195,544
  模型大小: 257.11 MB
==================================================
开始训练...

==================================================
Epoch 1/50
==================================================

Step 0: Loss=9.6830, PPL=16042.76, LR=6.18e-08

Step 100: Loss=8.9341, PPL=7586.61, LR=6.24e-06

Step 200: Loss=8.3484, PPL=4223.23, LR=1.24e-05

Step 300: Loss=7.5841, PPL=1966.58, LR=1.86e-05

Step 400: Loss=6.8429, PPL=937.24, LR=2.48e-05

Step 500: Loss=6.3404, PPL=567.03, LR=3.09e-05

Step 600: Loss=6.2656, PPL=526.15, LR=3.71e-05

Step 700: Loss=6.0826, PPL=438.18, LR=4.33e-05

Step 800: Loss=6.0583, PPL=427.63, LR=4.95e-05

Step 900: Loss=5.7765, PPL=322.62, LR=5.56e-05

Step 1000: Loss=5.9495, PPL=383.56, LR=6.18e-05

Step 1100: Loss=5.7886, PPL=326.57, LR=6.80e-05

Step 1200: Loss=5.6863, PPL=294.79, LR=7.42e-05

Step 1300: Loss=5.6785, PPL=292.52, LR=8.04e-05

Step 1400: Loss=5.3849, PPL=218.08, LR=8.65e-05

Step 1500: Loss=5.2363, PPL=187.97, LR=9.27e-05

Epoch 1 结果:
  训练损失: 6.4792, 困惑度: 651.42
  验证损失: 5.2360, 困惑度: 187.91
检查点已保存: runs/20251108_111116/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 5.2360)

==================================================
Epoch 2/50
==================================================

Step 0: Loss=5.3571, PPL=212.10, LR=9.66e-05

Step 100: Loss=5.1920, PPL=179.83, LR=1.03e-04

Step 200: Loss=4.9568, PPL=142.14, LR=1.09e-04

Step 300: Loss=5.1210, PPL=167.51, LR=1.15e-04

Step 400: Loss=4.9838, PPL=146.03, LR=1.21e-04

Step 500: Loss=5.0500, PPL=156.01, LR=1.27e-04

Step 600: Loss=4.9304, PPL=138.43, LR=1.34e-04

Step 700: Loss=4.5791, PPL=97.43, LR=1.40e-04

Step 800: Loss=4.7109, PPL=111.15, LR=1.46e-04

Step 900: Loss=4.8363, PPL=126.01, LR=1.52e-04

Step 1000: Loss=4.8376, PPL=126.16, LR=1.58e-04

Step 1100: Loss=4.6313, PPL=102.65, LR=1.65e-04

Step 1200: Loss=4.4508, PPL=85.69, LR=1.71e-04

Step 1300: Loss=4.5445, PPL=94.11, LR=1.77e-04

Step 1400: Loss=4.4425, PPL=84.99, LR=1.83e-04

Step 1500: Loss=4.2376, PPL=69.24, LR=1.89e-04

Epoch 2 结果:
  训练损失: 4.8192, 困惑度: 123.86
  验证损失: 4.2896, 困惑度: 72.94
检查点已保存: runs/20251108_111116/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 4.2896)

==================================================
Epoch 3/50
==================================================

Step 0: Loss=4.1988, PPL=66.61, LR=1.93e-04

Step 100: Loss=4.3151, PPL=74.82, LR=1.99e-04

Step 200: Loss=4.1888, PPL=65.94, LR=2.05e-04

Step 300: Loss=4.2001, PPL=66.69, LR=2.12e-04

Step 400: Loss=4.2470, PPL=69.90, LR=2.18e-04

Step 500: Loss=4.2078, PPL=67.21, LR=2.24e-04

Step 600: Loss=4.2802, PPL=72.26, LR=2.30e-04

Step 700: Loss=3.7305, PPL=41.70, LR=2.36e-04

Step 800: Loss=3.8913, PPL=48.97, LR=2.43e-04

Step 900: Loss=3.9318, PPL=51.00, LR=2.49e-04

Step 1000: Loss=4.0642, PPL=58.22, LR=2.55e-04

Step 1100: Loss=3.9578, PPL=52.34, LR=2.61e-04

Step 1200: Loss=3.7917, PPL=44.33, LR=2.67e-04

Step 1300: Loss=3.7175, PPL=41.16, LR=2.73e-04

Step 1400: Loss=3.9109, PPL=49.95, LR=2.80e-04

Step 1500: Loss=4.1219, PPL=61.68, LR=2.86e-04

Epoch 3 结果:
  训练损失: 4.0492, 困惑度: 57.35
  验证损失: 3.6378, 困惑度: 38.01
  验证BLEU: 0.0074 (0.74%)
检查点已保存: runs/20251108_111116/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 3.6378)

==================================================
Epoch 4/50
==================================================

Step 0: Loss=3.2903, PPL=26.85, LR=2.90e-04

Step 100: Loss=3.5739, PPL=35.66, LR=2.96e-04

Step 200: Loss=3.6246, PPL=37.51, LR=3.02e-04

Step 300: Loss=3.7788, PPL=43.76, LR=3.08e-04

Step 400: Loss=3.6429, PPL=38.20, LR=3.14e-04

Step 500: Loss=3.5598, PPL=35.16, LR=3.21e-04

Step 600: Loss=3.4730, PPL=32.23, LR=3.27e-04

Step 700: Loss=3.3323, PPL=28.00, LR=3.33e-04

Step 800: Loss=3.4582, PPL=31.76, LR=3.39e-04

Step 900: Loss=3.3649, PPL=28.93, LR=3.45e-04

Step 1000: Loss=3.3178, PPL=27.60, LR=3.51e-04

Step 1100: Loss=3.7243, PPL=41.44, LR=3.58e-04

Step 1200: Loss=3.3620, PPL=28.85, LR=3.64e-04

Step 1300: Loss=3.5234, PPL=33.90, LR=3.70e-04

Step 1400: Loss=3.2433, PPL=25.62, LR=3.76e-04

Step 1500: Loss=3.3508, PPL=28.52, LR=3.82e-04

Epoch 4 结果:
  训练损失: 3.5232, 困惑度: 33.89
  验证损失: 3.2104, 困惑度: 24.79
检查点已保存: runs/20251108_111116/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 3.2104)

==================================================
Epoch 5/50
==================================================

Step 0: Loss=3.3058, PPL=27.27, LR=3.86e-04

Step 100: Loss=3.3767, PPL=29.27, LR=3.92e-04

Step 200: Loss=3.2638, PPL=26.15, LR=3.99e-04

Step 300: Loss=3.0579, PPL=21.28, LR=4.05e-04

Step 400: Loss=3.1789, PPL=24.02, LR=4.11e-04

Step 500: Loss=3.0011, PPL=20.11, LR=4.17e-04

Step 600: Loss=3.3331, PPL=28.03, LR=4.23e-04

Step 700: Loss=3.1306, PPL=22.89, LR=4.29e-04

Step 800: Loss=3.1094, PPL=22.41, LR=4.36e-04

Step 900: Loss=3.3655, PPL=28.95, LR=4.42e-04

Step 1000: Loss=3.4565, PPL=31.70, LR=4.48e-04

Step 1100: Loss=3.1996, PPL=24.52, LR=4.54e-04

Step 1200: Loss=3.1155, PPL=22.54, LR=4.60e-04

Step 1300: Loss=2.9955, PPL=19.99, LR=4.66e-04

Step 1400: Loss=2.9088, PPL=18.33, LR=4.73e-04

Step 1500: Loss=3.1750, PPL=23.93, LR=4.79e-04

Epoch 5 结果:
  训练损失: 3.1897, 困惑度: 24.28
  验证损失: 2.9931, 困惑度: 19.95
检查点已保存: runs/20251108_111116/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.9931)
检查点已保存: runs/20251108_111116/checkpoints/checkpoint_epoch_5.pt
训练曲线已保存: runs/20251108_111116/figures/training_curves.png

==================================================
Epoch 6/50
==================================================

Step 0: Loss=3.0835, PPL=21.84, LR=4.83e-04

Step 100: Loss=3.1027, PPL=22.26, LR=4.89e-04

Step 200: Loss=2.8798, PPL=17.81, LR=4.94e-04

Step 300: Loss=2.8844, PPL=17.89, LR=4.91e-04

Step 400: Loss=3.1017, PPL=22.23, LR=4.88e-04

Step 500: Loss=3.1273, PPL=22.81, LR=4.85e-04

Step 600: Loss=2.9314, PPL=18.75, LR=4.82e-04

Step 700: Loss=2.9496, PPL=19.10, LR=4.79e-04

Step 800: Loss=2.8142, PPL=16.68, LR=4.76e-04

Step 900: Loss=2.9357, PPL=18.83, LR=4.73e-04

Step 1000: Loss=3.0999, PPL=22.20, LR=4.71e-04

Step 1100: Loss=3.1217, PPL=22.69, LR=4.68e-04

Step 1200: Loss=2.8970, PPL=18.12, LR=4.65e-04

Step 1300: Loss=2.7733, PPL=16.01, LR=4.63e-04

Step 1400: Loss=2.9727, PPL=19.54, LR=4.60e-04

Step 1500: Loss=3.0206, PPL=20.50, LR=4.58e-04

Epoch 6 结果:
  训练损失: 2.9416, 困惑度: 18.95
  验证损失: 2.7961, 困惑度: 16.38
  验证BLEU: 0.0169 (1.69%)
检查点已保存: runs/20251108_111116/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.7961)

==================================================
Epoch 7/50
==================================================

Step 0: Loss=2.7244, PPL=15.25, LR=4.56e-04

Step 100: Loss=2.5594, PPL=12.93, LR=4.54e-04

Step 200: Loss=2.6578, PPL=14.27, LR=4.52e-04

Step 300: Loss=2.5419, PPL=12.70, LR=4.49e-04

Step 400: Loss=2.3637, PPL=10.63, LR=4.47e-04

Step 500: Loss=2.5850, PPL=13.26, LR=4.45e-04

Step 600: Loss=2.6317, PPL=13.90, LR=4.42e-04

Step 700: Loss=2.7493, PPL=15.63, LR=4.40e-04

Step 800: Loss=2.6322, PPL=13.90, LR=4.38e-04

Step 900: Loss=2.6385, PPL=13.99, LR=4.36e-04

Step 1000: Loss=2.6764, PPL=14.53, LR=4.34e-04

Step 1100: Loss=2.7553, PPL=15.73, LR=4.32e-04

Step 1200: Loss=2.8408, PPL=17.13, LR=4.30e-04

Step 1300: Loss=2.5831, PPL=13.24, LR=4.28e-04

Step 1400: Loss=2.8231, PPL=16.83, LR=4.26e-04

Step 1500: Loss=2.7722, PPL=15.99, LR=4.24e-04

Epoch 7 结果:
  训练损失: 2.7027, 困惑度: 14.92
  验证损失: 2.6352, 困惑度: 13.95
检查点已保存: runs/20251108_111116/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.6352)

==================================================
Epoch 8/50
==================================================

Step 0: Loss=2.4100, PPL=11.13, LR=4.22e-04

Step 100: Loss=2.6024, PPL=13.50, LR=4.21e-04

Step 200: Loss=2.5715, PPL=13.09, LR=4.19e-04

Step 300: Loss=2.4837, PPL=11.98, LR=4.17e-04

Step 400: Loss=2.4631, PPL=11.74, LR=4.15e-04

Step 500: Loss=2.5291, PPL=12.54, LR=4.13e-04

Step 600: Loss=2.4628, PPL=11.74, LR=4.11e-04

Step 700: Loss=2.7020, PPL=14.91, LR=4.10e-04

Step 800: Loss=2.5273, PPL=12.52, LR=4.08e-04

Step 900: Loss=2.6039, PPL=13.52, LR=4.06e-04

Step 1000: Loss=2.3846, PPL=10.85, LR=4.04e-04

Step 1100: Loss=2.6911, PPL=14.75, LR=4.03e-04

Step 1200: Loss=2.6326, PPL=13.91, LR=4.01e-04

Step 1300: Loss=2.8856, PPL=17.91, LR=3.99e-04

Step 1400: Loss=2.5142, PPL=12.36, LR=3.98e-04

Step 1500: Loss=2.4268, PPL=11.32, LR=3.96e-04

Epoch 8 结果:
  训练损失: 2.5119, 困惑度: 12.33
  验证损失: 2.5621, 困惑度: 12.96
检查点已保存: runs/20251108_111116/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.5621)

==================================================
Epoch 9/50
==================================================

Step 0: Loss=2.2210, PPL=9.22, LR=3.95e-04

Step 100: Loss=2.2657, PPL=9.64, LR=3.94e-04

Step 200: Loss=2.2263, PPL=9.27, LR=3.92e-04

Step 300: Loss=2.4640, PPL=11.75, LR=3.91e-04

Step 400: Loss=2.2742, PPL=9.72, LR=3.89e-04

Step 500: Loss=2.1980, PPL=9.01, LR=3.88e-04

Step 600: Loss=2.4139, PPL=11.18, LR=3.86e-04

Step 700: Loss=2.3661, PPL=10.66, LR=3.85e-04

Step 800: Loss=2.2994, PPL=9.97, LR=3.83e-04

Step 900: Loss=2.4052, PPL=11.08, LR=3.82e-04

Step 1000: Loss=2.4927, PPL=12.09, LR=3.80e-04

Step 1100: Loss=2.3188, PPL=10.16, LR=3.79e-04

Step 1200: Loss=2.4689, PPL=11.81, LR=3.78e-04

Step 1300: Loss=2.3933, PPL=10.95, LR=3.76e-04

Step 1400: Loss=2.3952, PPL=10.97, LR=3.75e-04

Step 1500: Loss=2.6299, PPL=13.87, LR=3.73e-04

Epoch 9 结果:
  训练损失: 2.3573, 困惑度: 10.56
  验证损失: 2.4916, 困惑度: 12.08
  验证BLEU: 0.0247 (2.47%)
检查点已保存: runs/20251108_111116/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.4916)

==================================================
Epoch 10/50
==================================================

Step 0: Loss=1.9996, PPL=7.39, LR=3.73e-04

Step 100: Loss=2.0440, PPL=7.72, LR=3.71e-04

Step 200: Loss=2.1328, PPL=8.44, LR=3.70e-04

Step 300: Loss=2.1814, PPL=8.86, LR=3.69e-04

Step 400: Loss=2.2447, PPL=9.44, LR=3.67e-04

Step 500: Loss=2.1300, PPL=8.42, LR=3.66e-04

Step 600: Loss=2.1870, PPL=8.91, LR=3.65e-04

Step 700: Loss=2.2744, PPL=9.72, LR=3.64e-04

Step 800: Loss=2.1976, PPL=9.00, LR=3.62e-04

Step 900: Loss=2.2710, PPL=9.69, LR=3.61e-04

Step 1000: Loss=2.2163, PPL=9.17, LR=3.60e-04

Step 1100: Loss=2.1990, PPL=9.02, LR=3.59e-04

Step 1200: Loss=2.3744, PPL=10.74, LR=3.58e-04

Step 1300: Loss=2.1565, PPL=8.64, LR=3.56e-04

Step 1400: Loss=2.3870, PPL=10.88, LR=3.55e-04

Step 1500: Loss=2.3494, PPL=10.48, LR=3.54e-04

Epoch 10 结果:
  训练损失: 2.2262, 困惑度: 9.26
  验证损失: 2.4494, 困惑度: 11.58
检查点已保存: runs/20251108_111116/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.4494)
检查点已保存: runs/20251108_111116/checkpoints/checkpoint_epoch_10.pt
训练曲线已保存: runs/20251108_111116/figures/training_curves.png

==================================================
Epoch 11/50
==================================================

Step 0: Loss=1.9459, PPL=7.00, LR=3.53e-04

Step 100: Loss=2.1197, PPL=8.33, LR=3.52e-04

Step 200: Loss=2.0724, PPL=7.94, LR=3.51e-04

Step 300: Loss=2.0802, PPL=8.01, LR=3.50e-04

Step 400: Loss=2.0706, PPL=7.93, LR=3.49e-04

Step 500: Loss=2.0277, PPL=7.60, LR=3.48e-04

Step 600: Loss=2.1808, PPL=8.85, LR=3.47e-04

Step 700: Loss=2.0952, PPL=8.13, LR=3.46e-04

Step 800: Loss=2.1420, PPL=8.52, LR=3.45e-04

Step 900: Loss=1.9873, PPL=7.30, LR=3.44e-04

Step 1000: Loss=2.1815, PPL=8.86, LR=3.43e-04

Step 1100: Loss=2.1111, PPL=8.26, LR=3.42e-04

Step 1200: Loss=2.1639, PPL=8.71, LR=3.41e-04

Step 1300: Loss=2.0146, PPL=7.50, LR=3.40e-04

Step 1400: Loss=2.3633, PPL=10.63, LR=3.39e-04

Step 1500: Loss=2.2383, PPL=9.38, LR=3.38e-04

Epoch 11 结果:
  训练损失: 2.1123, 困惑度: 8.27
  验证损失: 2.4493, 困惑度: 11.58
  验证损失未改善 (patience: 1/5)
  当前: 2.4493, 最佳: 2.4494, 差距: -0.0000

==================================================
Epoch 12/50
==================================================

Step 0: Loss=1.7128, PPL=5.54, LR=3.37e-04

Step 100: Loss=1.9004, PPL=6.69, LR=3.36e-04

Step 200: Loss=1.7874, PPL=5.97, LR=3.35e-04

Step 300: Loss=1.8518, PPL=6.37, LR=3.34e-04

Step 400: Loss=1.9304, PPL=6.89, LR=3.33e-04

Step 500: Loss=2.1896, PPL=8.93, LR=3.32e-04

Step 600: Loss=2.2445, PPL=9.44, LR=3.31e-04

Step 700: Loss=2.1339, PPL=8.45, LR=3.30e-04

Step 800: Loss=2.0102, PPL=7.46, LR=3.29e-04

Step 900: Loss=2.2094, PPL=9.11, LR=3.29e-04

Step 1000: Loss=2.0007, PPL=7.39, LR=3.28e-04

Step 1100: Loss=2.0118, PPL=7.48, LR=3.27e-04

Step 1200: Loss=2.1799, PPL=8.85, LR=3.26e-04

Step 1300: Loss=2.2802, PPL=9.78, LR=3.25e-04

Step 1400: Loss=2.1656, PPL=8.72, LR=3.24e-04

Step 1500: Loss=2.0927, PPL=8.11, LR=3.23e-04

Epoch 12 结果:
  训练损失: 2.0118, 困惑度: 7.48
  验证损失: 2.4377, 困惑度: 11.45
  验证BLEU: 0.0249 (2.49%)
检查点已保存: runs/20251108_111116/checkpoints/best_model.pt
  ✓ 保存最佳模型 (验证损失: 2.4377)

==================================================
Epoch 13/50
==================================================

Step 0: Loss=1.5600, PPL=4.76, LR=3.23e-04

Step 100: Loss=1.8033, PPL=6.07, LR=3.22e-04

Step 200: Loss=1.9697, PPL=7.17, LR=3.21e-04

Step 300: Loss=1.7641, PPL=5.84, LR=3.20e-04

Step 400: Loss=1.8838, PPL=6.58, LR=3.19e-04

Step 500: Loss=1.8287, PPL=6.23, LR=3.18e-04

Step 600: Loss=1.8029, PPL=6.07, LR=3.18e-04

Step 700: Loss=1.9288, PPL=6.88, LR=3.17e-04

Step 800: Loss=2.1549, PPL=8.63, LR=3.16e-04

Step 900: Loss=1.8273, PPL=6.22, LR=3.15e-04

Step 1000: Loss=2.0335, PPL=7.64, LR=3.14e-04

Step 1100: Loss=1.8224, PPL=6.19, LR=3.14e-04

Step 1200: Loss=1.9673, PPL=7.15, LR=3.13e-04

Step 1300: Loss=1.8086, PPL=6.10, LR=3.12e-04

Step 1400: Loss=1.9051, PPL=6.72, LR=3.11e-04

Step 1500: Loss=1.7260, PPL=5.62, LR=3.11e-04

Epoch 13 结果:
  训练损失: 1.9185, 困惑度: 6.81
  验证损失: 2.4493, 困惑度: 11.58
  验证损失未改善 (patience: 1/5)
  当前: 2.4493, 最佳: 2.4377, 差距: 0.0115

==================================================
Epoch 14/50
==================================================

Step 0: Loss=1.6914, PPL=5.43, LR=3.10e-04

Step 100: Loss=1.7998, PPL=6.05, LR=3.09e-04

Step 200: Loss=1.7586, PPL=5.80, LR=3.09e-04

Step 300: Loss=1.7993, PPL=6.05, LR=3.08e-04

Step 400: Loss=1.7119, PPL=5.54, LR=3.07e-04

Step 500: Loss=1.9461, PPL=7.00, LR=3.06e-04

Step 600: Loss=1.8511, PPL=6.37, LR=3.06e-04

Step 700: Loss=2.0089, PPL=7.45, LR=3.05e-04

Step 800: Loss=1.7535, PPL=5.77, LR=3.04e-04

Step 900: Loss=1.7621, PPL=5.82, LR=3.03e-04

Step 1000: Loss=2.0198, PPL=7.54, LR=3.03e-04

Step 1100: Loss=1.7665, PPL=5.85, LR=3.02e-04

Step 1200: Loss=1.8185, PPL=6.16, LR=3.01e-04

Step 1300: Loss=2.0668, PPL=7.90, LR=3.01e-04

Step 1400: Loss=1.9721, PPL=7.19, LR=3.00e-04

Step 1500: Loss=1.9359, PPL=6.93, LR=2.99e-04

Epoch 14 结果:
  训练损失: 1.8371, 困惑度: 6.28
  验证损失: 2.4504, 困惑度: 11.59
  验证损失未改善 (patience: 2/5)
  当前: 2.4504, 最佳: 2.4377, 差距: 0.0127

==================================================
Epoch 15/50
==================================================

Step 0: Loss=1.4584, PPL=4.30, LR=2.99e-04

Step 100: Loss=1.6425, PPL=5.17, LR=2.98e-04

Step 200: Loss=1.6252, PPL=5.08, LR=2.97e-04

Step 300: Loss=1.8173, PPL=6.16, LR=2.97e-04

Step 400: Loss=1.7706, PPL=5.87, LR=2.96e-04

Step 500: Loss=1.8528, PPL=6.38, LR=2.95e-04

Step 600: Loss=1.7822, PPL=5.94, LR=2.95e-04

Step 700: Loss=1.8831, PPL=6.57, LR=2.94e-04

Step 800: Loss=1.6094, PPL=5.00, LR=2.93e-04

Step 900: Loss=1.7642, PPL=5.84, LR=2.93e-04

Step 1000: Loss=1.8173, PPL=6.16, LR=2.92e-04

Step 1100: Loss=1.8963, PPL=6.66, LR=2.92e-04

Step 1200: Loss=1.8907, PPL=6.62, LR=2.91e-04

Step 1300: Loss=1.9759, PPL=7.21, LR=2.90e-04

Step 1400: Loss=1.9129, PPL=6.77, LR=2.90e-04

Step 1500: Loss=1.7635, PPL=5.83, LR=2.89e-04

Epoch 15 结果:
  训练损失: 1.7588, 困惑度: 5.81
  验证损失: 2.4618, 困惑度: 11.73
  验证BLEU: 0.0318 (3.18%)
  验证损失未改善 (patience: 3/5)
  当前: 2.4618, 最佳: 2.4377, 差距: 0.0241
检查点已保存: runs/20251108_111116/checkpoints/best_model_bleu.pt
  ✓ 保存最佳BLEU模型 (BLEU: 0.0318)
检查点已保存: runs/20251108_111116/checkpoints/checkpoint_epoch_15.pt
训练曲线已保存: runs/20251108_111116/figures/training_curves.png

==================================================
Epoch 16/50
==================================================

Step 0: Loss=1.6730, PPL=5.33, LR=2.89e-04

Step 100: Loss=1.5129, PPL=4.54, LR=2.88e-04

Step 200: Loss=1.7448, PPL=5.72, LR=2.87e-04

Step 300: Loss=1.5840, PPL=4.87, LR=2.87e-04

Step 400: Loss=1.7118, PPL=5.54, LR=2.86e-04

Step 500: Loss=1.5587, PPL=4.75, LR=2.86e-04

Step 600: Loss=1.6022, PPL=4.96, LR=2.85e-04

Step 700: Loss=1.7520, PPL=5.77, LR=2.84e-04

Step 800: Loss=1.6595, PPL=5.26, LR=2.84e-04

Step 900: Loss=1.7147, PPL=5.56, LR=2.83e-04

Step 1000: Loss=1.6578, PPL=5.25, LR=2.83e-04

Step 1100: Loss=1.7862, PPL=5.97, LR=2.82e-04

Step 1200: Loss=1.7461, PPL=5.73, LR=2.82e-04

Step 1300: Loss=1.9715, PPL=7.18, LR=2.81e-04

Step 1400: Loss=1.6403, PPL=5.16, LR=2.80e-04

Step 1500: Loss=1.5677, PPL=4.80, LR=2.80e-04

Epoch 16 结果:
  训练损失: 1.6868, 困惑度: 5.40
  验证损失: 2.4795, 困惑度: 11.94
  验证损失未改善 (patience: 4/5)
  当前: 2.4795, 最佳: 2.4377, 差距: 0.0417

==================================================
Epoch 17/50
==================================================

Step 0: Loss=1.3772, PPL=3.96, LR=2.79e-04

Step 100: Loss=1.4542, PPL=4.28, LR=2.79e-04

Step 200: Loss=1.5599, PPL=4.76, LR=2.78e-04

Step 300: Loss=1.5384, PPL=4.66, LR=2.78e-04

Step 400: Loss=1.5653, PPL=4.78, LR=2.77e-04

Step 500: Loss=1.5398, PPL=4.66, LR=2.77e-04

Step 600: Loss=1.6476, PPL=5.19, LR=2.76e-04

Step 700: Loss=1.6349, PPL=5.13, LR=2.76e-04

Step 800: Loss=1.8490, PPL=6.35, LR=2.75e-04

Step 900: Loss=1.5344, PPL=4.64, LR=2.75e-04

Step 1000: Loss=1.7104, PPL=5.53, LR=2.74e-04

Step 1100: Loss=1.8189, PPL=6.17, LR=2.74e-04

Step 1200: Loss=1.5540, PPL=4.73, LR=2.73e-04

Step 1300: Loss=1.5906, PPL=4.91, LR=2.72e-04

Step 1400: Loss=1.6091, PPL=5.00, LR=2.72e-04

Step 1500: Loss=1.7461, PPL=5.73, LR=2.71e-04

Epoch 17 结果:
  训练损失: 1.6247, 困惑度: 5.08
  验证损失: 2.4832, 困惑度: 11.98
  验证损失未改善 (patience: 5/5)
  当前: 2.4832, 最佳: 2.4377, 差距: 0.0454

==================================================
早停触发！验证损失在 5 个epoch内未改善
当前验证损失: 2.4832
最佳验证损失: 2.4377 (epoch 12)
最佳验证BLEU: 0.0318
==================================================
训练曲线已保存: runs/20251108_111116/figures/training_curves_final.png

============================================================
训练结束时间: 2025-11-08 12:37:42
============================================================
